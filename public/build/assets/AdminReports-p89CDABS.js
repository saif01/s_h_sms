import{c as T}from"./commonMixin-LD1l2-5e.js";import{p as B,P as A}from"./PaginationControls-CGFLaHsK.js";import{D as O}from"./DatePicker-pwDn7i3L.js";import{_ as L,c as f,a as l,d as p,e as D,w as s,r as u,b as o,t as i,f as d,F as x,y as F,o as a,z as j}from"./app-CYStQJ0f.js";const q={name:"SalesReports",components:{PaginationControls:A,DatePicker:O},mixins:[T,B],data(){return{loading:!1,exporting:!1,filters:{date_from:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0],customer_id:null,status:null},reportData:[],topProducts:[],summary:null,customers:[],statusOptions:[{title:"Draft",value:"draft"},{title:"Pending",value:"pending"},{title:"Partial",value:"partial"},{title:"Paid",value:"paid"},{title:"Cancelled",value:"cancelled"}]}},mounted(){this.fetchCustomers(),this.generateReport()},methods:{async fetchCustomers(){try{const e=await this.$axios.get("/api/v1/customers",{headers:this.getAuthHeaders()});this.customers=e.data.data||e.data.customers||[]}catch(e){console.error("Failed to fetch customers",e)}},async generateReport(){try{this.loading=!0;const e=this.buildPaginationParams();this.perPage==="all"&&(e.per_page=999999),this.filters.date_from&&(e.date_from=this.filters.date_from),this.filters.date_to&&(e.date_to=this.filters.date_to),this.filters.customer_id&&(e.customer_id=this.filters.customer_id),this.filters.status&&(e.status=this.filters.status);const t=await this.$axios.get("/api/v1/reports/sales",{params:e,headers:this.getAuthHeaders()});this.reportData=t.data.data||t.data.sales||[],this.topProducts=t.data.top_products||[],this.summary=t.data.summary||null,this.updatePagination(t.data)}catch(e){this.handleApiError(e,"Failed to generate sales report")}finally{this.loading=!1}},async exportExcel(){var e,t;try{this.exporting=!0;const g=await this.$axios.get("/api/v1/reports/sales/export/excel",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),b=window.URL.createObjectURL(new Blob([g.data])),r=document.createElement("a");r.href=b,r.setAttribute("download",`sales_report_${Date.now()}.xlsx`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(b),(e=this.$toast)==null||e.success("Report exported successfully")}catch(g){console.error("Failed to export Excel",g),(t=this.$toast)==null||t.error("Failed to export report")}finally{this.exporting=!1}},async exportPDF(){var e,t;try{this.exporting=!0;const g=await this.$axios.get("/api/v1/reports/sales/export/pdf",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),b=window.URL.createObjectURL(new Blob([g.data])),r=document.createElement("a");r.href=b,r.setAttribute("download",`sales_report_${Date.now()}.pdf`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(b),(e=this.$toast)==null||e.success("Report exported successfully")}catch(g){console.error("Failed to export PDF",g),(t=this.$toast)==null||t.error("Failed to export report")}finally{this.exporting=!1}},formatCurrency(e){return e==null?"৳0.00":"৳"+new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},getStatusColor(e){return{draft:"grey",pending:"warning",partial:"info",paid:"success",cancelled:"error"}[e]||"grey"},onDateFromChange(e){this.filters.date_from=e||"",this.resetPagination(),this.generateReport()},onDateToChange(e){this.filters.date_to=e||"",this.resetPagination(),this.generateReport()},onFilterChange(){this.resetPagination(),this.generateReport()}}},Y={class:"text-h6 font-weight-bold"},$={class:"text-h6 font-weight-bold"},Q={class:"text-h6 font-weight-bold"},W={class:"text-h6 font-weight-bold"},G={class:"d-flex align-center gap-2"},K={class:"text-caption text-grey"},J={key:0},X={class:"sortable-header"},Z={class:"sortable-header"},tt={class:"sortable-header"},et={class:"sortable-header justify-end"},ot={class:"sortable-header justify-end"},st={class:"sortable-header justify-end"},lt={class:"sortable-header"},rt={class:"text-end"},nt={class:"text-end"},at={class:"text-end"},it={key:0},dt={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},ut={class:"text-caption text-grey"},pt={key:0},mt={key:0},ct={key:1},ft={key:1},gt={class:"text-end"},yt={class:"text-end font-weight-medium"};function _t(e,t,g,b,r,c){const k=u("DatePicker"),y=u("v-col"),S=u("v-select"),C=u("v-row"),h=u("v-card-text"),w=u("v-card"),P=u("v-btn"),z=u("v-card-title"),m=u("v-icon"),_=u("v-skeleton-loader"),R=u("v-chip"),U=u("v-table"),V=u("PaginationControls");return a(),f("div",null,[l(w,{class:"mb-4"},{default:s(()=>[l(h,null,{default:s(()=>[l(C,null,{default:s(()=>[l(y,{cols:"12",md:"3"},{default:s(()=>[l(k,{modelValue:r.filters.date_from,"onUpdate:modelValue":[t[0]||(t[0]=n=>r.filters.date_from=n),c.onDateFromChange],label:"From Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(k,{modelValue:r.filters.date_to,"onUpdate:modelValue":[t[1]||(t[1]=n=>r.filters.date_to=n),c.onDateToChange],label:"To Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(S,{modelValue:r.filters.customer_id,"onUpdate:modelValue":[t[2]||(t[2]=n=>r.filters.customer_id=n),c.onFilterChange],items:r.customers,"item-value":"id","item-title":"name",label:"Customer",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(S,{modelValue:r.filters.status,"onUpdate:modelValue":[t[3]||(t[3]=n=>r.filters.status=n),c.onFilterChange],items:r.statusOptions,label:"Status",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),r.summary?(a(),p(C,{key:0,class:"mb-4",dense:""},{default:s(()=>[l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"primary",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[12]||(t[12]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Sales",-1)),o("div",Y,i(c.formatCurrency(r.summary.total_sales)),1)]),_:1,__:[12]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"success",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[13]||(t[13]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Paid",-1)),o("div",$,i(c.formatCurrency(r.summary.total_paid)),1)]),_:1,__:[13]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"warning",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[14]||(t[14]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Due",-1)),o("div",Q,i(c.formatCurrency(r.summary.total_due)),1)]),_:1,__:[14]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"info",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[15]||(t[15]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Invoices",-1)),o("div",W,i(r.summary.total_count||0),1)]),_:1,__:[15]})]),_:1})]),_:1})]),_:1})):D("",!0),l(w,null,{default:s(()=>[l(z,{class:"d-flex justify-space-between align-center"},{default:s(()=>[t[19]||(t[19]=o("span",null,"Sales Report",-1)),o("div",G,[l(P,{color:"success",size:"small","prepend-icon":"mdi-file-excel",onClick:c.exportExcel,disabled:r.loading||!r.reportData.length,loading:r.exporting},{default:s(()=>t[16]||(t[16]=[d(" Export Excel ")])),_:1,__:[16]},8,["onClick","disabled","loading"]),l(P,{color:"error",size:"small","prepend-icon":"mdi-file-pdf-box",onClick:c.exportPDF,disabled:r.loading||!r.reportData.length,loading:r.exporting},{default:s(()=>t[17]||(t[17]=[d(" Export PDF ")])),_:1,__:[17]},8,["onClick","disabled","loading"]),o("span",K,[t[18]||(t[18]=d(" Total Records: ")),o("strong",null,i((e.pagination.total||0).toLocaleString()),1),r.reportData.length>0?(a(),f("span",J," | Showing "+i((e.currentPage-1)*e.perPage+1)+" to "+i(Math.min(e.currentPage*e.perPage,e.pagination.total).toLocaleString())+" of "+i(e.pagination.total.toLocaleString()),1)):D("",!0)])])]),_:1,__:[19]}),l(h,null,{default:s(()=>[l(U,null,{default:s(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:t[4]||(t[4]=n=>e.onSort("invoice_number"))},[o("div",X,[t[21]||(t[21]=o("span",null,"Invoice #",-1)),e.sortBy==="invoice_number"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[20]||(t[20]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[20]}))])]),o("th",{class:"sortable",onClick:t[5]||(t[5]=n=>e.onSort("invoice_date"))},[o("div",Z,[t[23]||(t[23]=o("span",null,"Date",-1)),e.sortBy==="invoice_date"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[22]||(t[22]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[22]}))])]),o("th",{class:"sortable",onClick:t[6]||(t[6]=n=>e.onSort("customer_name"))},[o("div",tt,[t[25]||(t[25]=o("span",null,"Customer",-1)),e.sortBy==="customer_name"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[24]||(t[24]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[24]}))])]),o("th",{class:"text-end sortable",onClick:t[7]||(t[7]=n=>e.onSort("total_amount"))},[o("div",et,[t[27]||(t[27]=o("span",null,"Total",-1)),e.sortBy==="total_amount"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[26]||(t[26]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[26]}))])]),o("th",{class:"text-end sortable",onClick:t[8]||(t[8]=n=>e.onSort("paid_amount"))},[o("div",ot,[t[29]||(t[29]=o("span",null,"Paid",-1)),e.sortBy==="paid_amount"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[28]||(t[28]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[28]}))])]),o("th",{class:"text-end sortable",onClick:t[9]||(t[9]=n=>e.onSort("balance_amount"))},[o("div",st,[t[31]||(t[31]=o("span",null,"Due",-1)),e.sortBy==="balance_amount"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[30]||(t[30]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[30]}))])]),o("th",{class:"sortable",onClick:t[10]||(t[10]=n=>e.onSort("status"))},[o("div",lt,[t[33]||(t[33]=o("span",null,"Status",-1)),e.sortBy==="status"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[32]||(t[32]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[32]}))])])])]),o("tbody",null,[r.loading?(a(),f(x,{key:0},F(5,n=>o("tr",{key:`skeleton-${n}`},[o("td",null,[l(_,{type:"text",width:"120"})]),o("td",null,[l(_,{type:"text",width:"100"})]),o("td",null,[l(_,{type:"text",width:"150"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"chip",width:"80",height:"24"})])])),64)):(a(),f(x,{key:1},[(a(!0),f(x,null,F(r.reportData,n=>(a(),f("tr",{key:n.id||n.invoice_number},[o("td",null,i(n.invoice_number),1),o("td",null,i(e.formatDateDDMMYYYY(n.invoice_date)),1),o("td",null,i(n.customer_name),1),o("td",rt,i(c.formatCurrency(n.total_amount)),1),o("td",nt,i(c.formatCurrency(n.paid_amount)),1),o("td",at,[o("span",{class:j(n.balance_amount>0?"text-error font-weight-medium":"text-success")},i(c.formatCurrency(n.balance_amount)),3)]),o("td",null,[l(R,{color:c.getStatusColor(n.status),size:"small",variant:"flat"},{default:s(()=>[d(i(n.status),1)]),_:2},1032,["color"])])]))),128)),r.reportData.length===0?(a(),f("tr",it,t[34]||(t[34]=[o("td",{colspan:"7",class:"text-center py-4"},"No sales data found",-1)]))):D("",!0)],64))])]),_:1}),o("div",dt,[o("div",ut,[r.reportData.length>0&&e.pagination.total>0?(a(),f("span",pt,[e.perPage==="all"?(a(),f("span",mt,[t[35]||(t[35]=d(" Showing ")),o("strong",null,"all "+i(e.pagination.total.toLocaleString()),1),t[36]||(t[36]=d(" records "))])):(a(),f("span",ct,[t[37]||(t[37]=d(" Showing ")),o("strong",null,i((e.currentPage-1)*e.perPage+1),1),t[38]||(t[38]=d(" to ")),o("strong",null,i(Math.min(e.currentPage*e.perPage,e.pagination.total).toLocaleString()),1),t[39]||(t[39]=d(" of ")),o("strong",null,i(e.pagination.total.toLocaleString()),1),t[40]||(t[40]=d(" records "))]))])):(a(),f("span",ft,"No records found"))]),l(V,{modelValue:e.currentPage,"onUpdate:modelValue":t[11]||(t[11]=n=>e.currentPage=n),pagination:e.pagination,"per-page-value":e.perPage,"per-page-options":e.perPageOptions,"onUpdate:perPage":e.onPerPageUpdate,onPageChange:e.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1}),r.topProducts.length?(a(),p(w,{key:1,class:"mt-4"},{default:s(()=>[l(z,null,{default:s(()=>t[41]||(t[41]=[d("Top Selling Products")])),_:1,__:[41]}),l(h,null,{default:s(()=>[l(U,{density:"compact"},{default:s(()=>[t[42]||(t[42]=o("thead",null,[o("tr",null,[o("th",null,"Product"),o("th",{class:"text-end"},"Quantity Sold"),o("th",{class:"text-end"},"Total Revenue")])],-1)),o("tbody",null,[(a(!0),f(x,null,F(r.topProducts,n=>(a(),f("tr",{key:n.product_id},[o("td",null,i(n.product_name),1),o("td",gt,i(n.total_quantity),1),o("td",yt,i(c.formatCurrency(n.total_revenue)),1)]))),128))])]),_:1,__:[42]})]),_:1})]),_:1})):D("",!0)])}const vt=L(q,[["render",_t],["__scopeId","data-v-57bc571b"]]),ht={name:"PurchaseReports",components:{PaginationControls:A,DatePicker:O},mixins:[T,B],data(){return{loading:!1,exporting:!1,filters:{date_from:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0],supplier_id:null,status:null},reportData:[],summary:null,suppliers:[],statusOptions:[{title:"Draft",value:"draft"},{title:"Pending",value:"pending"},{title:"Partial",value:"partial"},{title:"Paid",value:"paid"},{title:"Cancelled",value:"cancelled"}]}},mounted(){this.fetchSuppliers(),this.generateReport()},methods:{async fetchSuppliers(){try{const e=await this.$axios.get("/api/v1/suppliers",{headers:this.getAuthHeaders()});this.suppliers=e.data.data||e.data.suppliers||[]}catch(e){console.error("Failed to fetch suppliers",e)}},async generateReport(){try{this.loading=!0;const e=this.buildPaginationParams();this.perPage==="all"&&(e.per_page=999999),this.filters.date_from&&(e.date_from=this.filters.date_from),this.filters.date_to&&(e.date_to=this.filters.date_to),this.filters.supplier_id&&(e.supplier_id=this.filters.supplier_id),this.filters.status&&(e.status=this.filters.status);const t=await this.$axios.get("/api/v1/reports/purchases",{params:e,headers:this.getAuthHeaders()});this.reportData=t.data.data||t.data.purchases||[],this.summary=t.data.summary||null,this.updatePagination(t.data)}catch(e){this.handleApiError(e,"Failed to generate purchase report")}finally{this.loading=!1}},async exportExcel(){var e,t;try{this.exporting=!0;const g=await this.$axios.get("/api/v1/reports/purchases/export/excel",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),b=window.URL.createObjectURL(new Blob([g.data])),r=document.createElement("a");r.href=b,r.setAttribute("download",`purchase_report_${Date.now()}.xlsx`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(b),(e=this.$toast)==null||e.success("Report exported successfully")}catch(g){console.error("Failed to export Excel",g),(t=this.$toast)==null||t.error("Failed to export report")}finally{this.exporting=!1}},async exportPDF(){var e,t;try{this.exporting=!0;const g=await this.$axios.get("/api/v1/reports/purchases/export/pdf",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),b=window.URL.createObjectURL(new Blob([g.data])),r=document.createElement("a");r.href=b,r.setAttribute("download",`purchase_report_${Date.now()}.pdf`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(b),(e=this.$toast)==null||e.success("Report exported successfully")}catch(g){console.error("Failed to export PDF",g),(t=this.$toast)==null||t.error("Failed to export report")}finally{this.exporting=!1}},formatCurrency(e){return e==null?"৳0.00":"৳"+new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},getStatusColor(e){return{draft:"grey",pending:"warning",partial:"info",paid:"success",cancelled:"error"}[e]||"grey"},onDateFromChange(e){this.filters.date_from=e||"",this.resetPagination(),this.generateReport()},onDateToChange(e){this.filters.date_to=e||"",this.resetPagination(),this.generateReport()},onFilterChange(){this.resetPagination(),this.generateReport()}}},wt={class:"text-h6 font-weight-bold"},bt={class:"text-h6 font-weight-bold"},kt={class:"text-h6 font-weight-bold"},Pt={class:"text-h6 font-weight-bold"},Dt={class:"d-flex align-center gap-2"},Ct={class:"text-caption text-grey"},xt={key:0},St={class:"sortable-header"},zt={class:"sortable-header"},Vt={class:"sortable-header"},Rt={class:"sortable-header justify-end"},Ut={class:"sortable-header justify-end"},Ft={class:"sortable-header justify-end"},Lt={class:"sortable-header"},Tt={class:"text-end"},Bt={class:"text-end"},At={class:"text-end"},Ot={key:0},jt={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},Et={class:"text-caption text-grey"},It={key:0},Mt={key:0},Nt={key:1},Ht={key:1};function qt(e,t,g,b,r,c){const k=u("DatePicker"),y=u("v-col"),S=u("v-select"),C=u("v-row"),h=u("v-card-text"),w=u("v-card"),P=u("v-btn"),z=u("v-card-title"),m=u("v-icon"),_=u("v-skeleton-loader"),R=u("v-chip"),U=u("v-table"),V=u("PaginationControls");return a(),f("div",null,[l(w,{class:"mb-4"},{default:s(()=>[l(h,null,{default:s(()=>[l(C,null,{default:s(()=>[l(y,{cols:"12",md:"3"},{default:s(()=>[l(k,{modelValue:r.filters.date_from,"onUpdate:modelValue":[t[0]||(t[0]=n=>r.filters.date_from=n),c.onDateFromChange],label:"From Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(k,{modelValue:r.filters.date_to,"onUpdate:modelValue":[t[1]||(t[1]=n=>r.filters.date_to=n),c.onDateToChange],label:"To Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(S,{modelValue:r.filters.supplier_id,"onUpdate:modelValue":[t[2]||(t[2]=n=>r.filters.supplier_id=n),c.onFilterChange],items:r.suppliers,"item-value":"id","item-title":"name",label:"Supplier",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(S,{modelValue:r.filters.status,"onUpdate:modelValue":[t[3]||(t[3]=n=>r.filters.status=n),c.onFilterChange],items:r.statusOptions,label:"Status",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),r.summary?(a(),p(C,{key:0,class:"mb-4",dense:""},{default:s(()=>[l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"primary",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[12]||(t[12]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Purchases",-1)),o("div",wt,i(c.formatCurrency(r.summary.total_purchases)),1)]),_:1,__:[12]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"success",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[13]||(t[13]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Paid",-1)),o("div",bt,i(c.formatCurrency(r.summary.total_paid)),1)]),_:1,__:[13]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"warning",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[14]||(t[14]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Due",-1)),o("div",kt,i(c.formatCurrency(r.summary.total_due)),1)]),_:1,__:[14]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"info",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[15]||(t[15]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Orders",-1)),o("div",Pt,i(r.summary.total_count||0),1)]),_:1,__:[15]})]),_:1})]),_:1})]),_:1})):D("",!0),l(w,null,{default:s(()=>[l(z,{class:"d-flex justify-space-between align-center"},{default:s(()=>[t[19]||(t[19]=o("span",null,"Purchase Report",-1)),o("div",Dt,[l(P,{color:"success",size:"small","prepend-icon":"mdi-file-excel",onClick:c.exportExcel,disabled:r.loading||!r.reportData.length,loading:r.exporting},{default:s(()=>t[16]||(t[16]=[d(" Export Excel ")])),_:1,__:[16]},8,["onClick","disabled","loading"]),l(P,{color:"error",size:"small","prepend-icon":"mdi-file-pdf-box",onClick:c.exportPDF,disabled:r.loading||!r.reportData.length,loading:r.exporting},{default:s(()=>t[17]||(t[17]=[d(" Export PDF ")])),_:1,__:[17]},8,["onClick","disabled","loading"]),o("span",Ct,[t[18]||(t[18]=d(" Total Records: ")),o("strong",null,i((e.pagination.total||0).toLocaleString()),1),r.reportData.length>0?(a(),f("span",xt," | Showing "+i((e.currentPage-1)*e.perPage+1)+" to "+i(Math.min(e.currentPage*e.perPage,e.pagination.total).toLocaleString())+" of "+i(e.pagination.total.toLocaleString()),1)):D("",!0)])])]),_:1,__:[19]}),l(h,null,{default:s(()=>[l(U,null,{default:s(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:t[4]||(t[4]=n=>e.onSort("invoice_number"))},[o("div",St,[t[21]||(t[21]=o("span",null,"Invoice #",-1)),e.sortBy==="invoice_number"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[20]||(t[20]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[20]}))])]),o("th",{class:"sortable",onClick:t[5]||(t[5]=n=>e.onSort("invoice_date"))},[o("div",zt,[t[23]||(t[23]=o("span",null,"Date",-1)),e.sortBy==="invoice_date"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[22]||(t[22]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[22]}))])]),o("th",{class:"sortable",onClick:t[6]||(t[6]=n=>e.onSort("supplier_name"))},[o("div",Vt,[t[25]||(t[25]=o("span",null,"Supplier",-1)),e.sortBy==="supplier_name"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[24]||(t[24]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[24]}))])]),o("th",{class:"text-end sortable",onClick:t[7]||(t[7]=n=>e.onSort("total_amount"))},[o("div",Rt,[t[27]||(t[27]=o("span",null,"Total",-1)),e.sortBy==="total_amount"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[26]||(t[26]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[26]}))])]),o("th",{class:"text-end sortable",onClick:t[8]||(t[8]=n=>e.onSort("paid_amount"))},[o("div",Ut,[t[29]||(t[29]=o("span",null,"Paid",-1)),e.sortBy==="paid_amount"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[28]||(t[28]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[28]}))])]),o("th",{class:"text-end sortable",onClick:t[9]||(t[9]=n=>e.onSort("balance_amount"))},[o("div",Ft,[t[31]||(t[31]=o("span",null,"Due",-1)),e.sortBy==="balance_amount"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[30]||(t[30]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[30]}))])]),o("th",{class:"sortable",onClick:t[10]||(t[10]=n=>e.onSort("status"))},[o("div",Lt,[t[33]||(t[33]=o("span",null,"Status",-1)),e.sortBy==="status"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[32]||(t[32]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[32]}))])])])]),o("tbody",null,[r.loading?(a(),f(x,{key:0},F(5,n=>o("tr",{key:`skeleton-${n}`},[o("td",null,[l(_,{type:"text",width:"120"})]),o("td",null,[l(_,{type:"text",width:"100"})]),o("td",null,[l(_,{type:"text",width:"150"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"chip",width:"80",height:"24"})])])),64)):(a(),f(x,{key:1},[(a(!0),f(x,null,F(r.reportData,n=>(a(),f("tr",{key:n.id||n.invoice_number},[o("td",null,i(n.invoice_number),1),o("td",null,i(e.formatDateDDMMYYYY(n.invoice_date)),1),o("td",null,i(n.supplier_name),1),o("td",Tt,i(c.formatCurrency(n.total_amount)),1),o("td",Bt,i(c.formatCurrency(n.paid_amount)),1),o("td",At,[o("span",{class:j(n.balance_amount>0?"text-error font-weight-medium":"text-success")},i(c.formatCurrency(n.balance_amount)),3)]),o("td",null,[l(R,{color:c.getStatusColor(n.status),size:"small",variant:"flat"},{default:s(()=>[d(i(n.status),1)]),_:2},1032,["color"])])]))),128)),r.reportData.length===0?(a(),f("tr",Ot,t[34]||(t[34]=[o("td",{colspan:"7",class:"text-center py-4"},"No purchase data found",-1)]))):D("",!0)],64))])]),_:1}),o("div",jt,[o("div",Et,[r.reportData.length>0&&e.pagination.total>0?(a(),f("span",It,[e.perPage==="all"?(a(),f("span",Mt,[t[35]||(t[35]=d(" Showing ")),o("strong",null,"all "+i(e.pagination.total.toLocaleString()),1),t[36]||(t[36]=d(" records "))])):(a(),f("span",Nt,[t[37]||(t[37]=d(" Showing ")),o("strong",null,i((e.currentPage-1)*e.perPage+1),1),t[38]||(t[38]=d(" to ")),o("strong",null,i(Math.min(e.currentPage*e.perPage,e.pagination.total).toLocaleString()),1),t[39]||(t[39]=d(" of ")),o("strong",null,i(e.pagination.total.toLocaleString()),1),t[40]||(t[40]=d(" records "))]))])):(a(),f("span",Ht,"No records found"))]),l(V,{modelValue:e.currentPage,"onUpdate:modelValue":t[11]||(t[11]=n=>e.currentPage=n),pagination:e.pagination,"per-page-value":e.perPage,"per-page-options":e.perPageOptions,"onUpdate:perPage":e.onPerPageUpdate,onPageChange:e.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1})])}const Yt=L(ht,[["render",qt],["__scopeId","data-v-bba334db"]]),$t={name:"StockReports",components:{PaginationControls:A},mixins:[T,B],data(){return{loading:!1,exporting:!1,filters:{warehouse_id:null,category_id:null,report_type:"current",low_stock_only:!1},reportData:[],summary:null,warehouses:[],categories:[],reportTypes:[{title:"Current Stock",value:"current"},{title:"Stock Ledger",value:"ledger"},{title:"Low Stock",value:"low_stock"}]}},mounted(){this.fetchOptions(),this.generateReport()},methods:{async fetchOptions(){try{const[e,t]=await Promise.all([this.$axios.get("/api/v1/warehouses",{headers:this.getAuthHeaders()}),this.$axios.get("/api/v1/categories",{headers:this.getAuthHeaders()})]);this.warehouses=e.data.data||e.data.warehouses||[],this.categories=t.data.data||t.data.categories||[]}catch(e){console.error("Failed to fetch options",e)}},async generateReport(){try{this.loading=!0;const e=this.buildPaginationParams();this.perPage==="all"&&(e.per_page=999999),this.filters.warehouse_id&&(e.warehouse_id=this.filters.warehouse_id),this.filters.category_id&&(e.category_id=this.filters.category_id),this.filters.report_type&&(e.report_type=this.filters.report_type),this.filters.low_stock_only&&(e.low_stock_only=this.filters.low_stock_only);const t=await this.$axios.get("/api/v1/reports/stock",{params:e,headers:this.getAuthHeaders()});this.reportData=t.data.data||t.data.stock||[],this.summary=t.data.summary||null,this.updatePagination(t.data)}catch(e){this.handleApiError(e,"Failed to generate stock report")}finally{this.loading=!1}},async exportExcel(){var e,t;try{this.exporting=!0;const g=await this.$axios.get("/api/v1/reports/stock/export/excel",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),b=window.URL.createObjectURL(new Blob([g.data])),r=document.createElement("a");r.href=b,r.setAttribute("download",`stock_report_${Date.now()}.xlsx`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(b),(e=this.$toast)==null||e.success("Report exported successfully")}catch(g){console.error("Failed to export Excel",g),(t=this.$toast)==null||t.error("Failed to export report")}finally{this.exporting=!1}},async exportPDF(){var e,t;try{this.exporting=!0;const g={};this.filters.warehouse_id&&(g.warehouse_id=this.filters.warehouse_id),this.filters.category_id&&(g.category_id=this.filters.category_id),this.filters.low_stock_only&&(g.low_stock_only=this.filters.low_stock_only);const b=await this.$axios.get("/api/v1/reports/stock/export/pdf",{params:g,responseType:"blob",headers:this.getAuthHeaders()}),r=window.URL.createObjectURL(new Blob([b.data])),c=document.createElement("a");c.href=r,c.setAttribute("download",`stock_report_${Date.now()}.pdf`),document.body.appendChild(c),c.click(),c.remove(),window.URL.revokeObjectURL(r),(e=this.$toast)==null||e.success("Report exported successfully")}catch(g){console.error("Failed to export PDF",g),(t=this.$toast)==null||t.error("Failed to export report")}finally{this.exporting=!1}},formatCurrency(e){return e==null?"৳0.00":"৳"+new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},getStockColor(e){return!e.quantity||e.quantity===0?"error":e.quantity<=e.minimum_stock_level?"warning":"success"},getStockStatus(e){return!e.quantity||e.quantity===0?"Out of Stock":e.quantity<=e.minimum_stock_level?"Low Stock":"In Stock"},onFilterChange(){this.resetPagination(),this.generateReport()}}},Qt={class:"text-h6 font-weight-bold"},Wt={class:"text-h6 font-weight-bold"},Gt={class:"text-h6 font-weight-bold"},Kt={class:"text-h6 font-weight-bold"},Jt={class:"d-flex align-center gap-2"},Xt={class:"text-caption text-grey"},Zt={key:0},te={class:"sortable-header"},ee={class:"sortable-header"},oe={class:"sortable-header"},se={class:"sortable-header"},le={class:"sortable-header justify-center"},re={class:"sortable-header justify-center"},ne={class:"sortable-header justify-end"},ae={class:"sortable-header"},ie={class:"text-center"},de={class:"text-center"},ue={class:"text-end"},pe={key:0},me={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},ce={class:"text-caption text-grey"},fe={key:0},ge={key:0},ye={key:1},_e={key:1};function ve(e,t,g,b,r,c){const k=u("v-select"),y=u("v-col"),S=u("v-switch"),C=u("v-row"),h=u("v-card-text"),w=u("v-card"),P=u("v-btn"),z=u("v-card-title"),m=u("v-icon"),_=u("v-skeleton-loader"),R=u("v-chip"),U=u("v-table"),V=u("PaginationControls");return a(),f("div",null,[l(w,{class:"mb-4"},{default:s(()=>[l(h,null,{default:s(()=>[l(C,null,{default:s(()=>[l(y,{cols:"12",md:"3"},{default:s(()=>[l(k,{modelValue:r.filters.warehouse_id,"onUpdate:modelValue":[t[0]||(t[0]=n=>r.filters.warehouse_id=n),c.onFilterChange],items:r.warehouses,"item-value":"id","item-title":"name",label:"Warehouse",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(k,{modelValue:r.filters.category_id,"onUpdate:modelValue":[t[1]||(t[1]=n=>r.filters.category_id=n),c.onFilterChange],items:r.categories,"item-value":"id","item-title":"name",label:"Category",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(k,{modelValue:r.filters.report_type,"onUpdate:modelValue":[t[2]||(t[2]=n=>r.filters.report_type=n),c.onFilterChange],items:r.reportTypes,label:"Report Type",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(S,{modelValue:r.filters.low_stock_only,"onUpdate:modelValue":[t[3]||(t[3]=n=>r.filters.low_stock_only=n),c.onFilterChange],label:"Low Stock Only",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),r.summary?(a(),p(C,{key:0,class:"mb-4",dense:""},{default:s(()=>[l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"primary",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[13]||(t[13]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Products",-1)),o("div",Qt,i(r.summary.total_products||0),1)]),_:1,__:[13]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"success",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[14]||(t[14]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Stock Value",-1)),o("div",Wt,i(c.formatCurrency(r.summary.total_stock_value)),1)]),_:1,__:[14]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"warning",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[15]||(t[15]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Low Stock Items",-1)),o("div",Gt,i(r.summary.low_stock_count||0),1)]),_:1,__:[15]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"error",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[16]||(t[16]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Out of Stock",-1)),o("div",Kt,i(r.summary.out_of_stock_count||0),1)]),_:1,__:[16]})]),_:1})]),_:1})]),_:1})):D("",!0),l(w,null,{default:s(()=>[l(z,{class:"d-flex justify-space-between align-center"},{default:s(()=>[t[20]||(t[20]=o("span",null,"Stock Report",-1)),o("div",Jt,[l(P,{color:"success",size:"small","prepend-icon":"mdi-file-excel",onClick:c.exportExcel,disabled:r.loading||!r.reportData.length,loading:r.exporting},{default:s(()=>t[17]||(t[17]=[d(" Export Excel ")])),_:1,__:[17]},8,["onClick","disabled","loading"]),l(P,{color:"error",size:"small","prepend-icon":"mdi-file-pdf-box",onClick:c.exportPDF,disabled:r.loading||!r.reportData.length,loading:r.exporting},{default:s(()=>t[18]||(t[18]=[d(" Export PDF ")])),_:1,__:[18]},8,["onClick","disabled","loading"]),o("span",Xt,[t[19]||(t[19]=d(" Total Records: ")),o("strong",null,i((e.pagination.total||0).toLocaleString()),1),r.reportData.length>0?(a(),f("span",Zt," | Showing "+i((e.currentPage-1)*e.perPage+1)+" to "+i(Math.min(e.currentPage*e.perPage,e.pagination.total).toLocaleString())+" of "+i(e.pagination.total.toLocaleString()),1)):D("",!0)])])]),_:1,__:[20]}),l(h,null,{default:s(()=>[l(U,null,{default:s(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:t[4]||(t[4]=n=>e.onSort("product_name"))},[o("div",te,[t[22]||(t[22]=o("span",null,"Product",-1)),e.sortBy==="product_name"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[21]||(t[21]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[21]}))])]),o("th",{class:"sortable",onClick:t[5]||(t[5]=n=>e.onSort("sku"))},[o("div",ee,[t[24]||(t[24]=o("span",null,"SKU",-1)),e.sortBy==="sku"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[23]||(t[23]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[23]}))])]),o("th",{class:"sortable",onClick:t[6]||(t[6]=n=>e.onSort("category_name"))},[o("div",oe,[t[26]||(t[26]=o("span",null,"Category",-1)),e.sortBy==="category_name"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[25]||(t[25]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[25]}))])]),o("th",{class:"sortable",onClick:t[7]||(t[7]=n=>e.onSort("warehouse_name"))},[o("div",se,[t[28]||(t[28]=o("span",null,"Warehouse",-1)),e.sortBy==="warehouse_name"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[27]||(t[27]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[27]}))])]),o("th",{class:"text-center sortable",onClick:t[8]||(t[8]=n=>e.onSort("quantity"))},[o("div",le,[t[30]||(t[30]=o("span",null,"Quantity",-1)),e.sortBy==="quantity"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[29]||(t[29]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[29]}))])]),o("th",{class:"text-center sortable",onClick:t[9]||(t[9]=n=>e.onSort("minimum_stock_level"))},[o("div",re,[t[32]||(t[32]=o("span",null,"Min Level",-1)),e.sortBy==="minimum_stock_level"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[31]||(t[31]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[31]}))])]),o("th",{class:"text-end sortable",onClick:t[10]||(t[10]=n=>e.onSort("stock_value"))},[o("div",ne,[t[34]||(t[34]=o("span",null,"Stock Value",-1)),e.sortBy==="stock_value"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[33]||(t[33]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[33]}))])]),o("th",{class:"sortable",onClick:t[11]||(t[11]=n=>e.onSort("status"))},[o("div",ae,[t[36]||(t[36]=o("span",null,"Status",-1)),e.sortBy==="status"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[35]||(t[35]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[35]}))])])])]),o("tbody",null,[r.loading?(a(),f(x,{key:0},F(5,n=>o("tr",{key:`skeleton-${n}`},[o("td",null,[l(_,{type:"text",width:"150"})]),o("td",null,[l(_,{type:"text",width:"100"})]),o("td",null,[l(_,{type:"text",width:"120"})]),o("td",null,[l(_,{type:"text",width:"120"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"text",width:"100"})]),o("td",null,[l(_,{type:"chip",width:"80",height:"24"})])])),64)):(a(),f(x,{key:1},[(a(!0),f(x,null,F(r.reportData,n=>(a(),f("tr",{key:n.id||n.product_id||n.sku},[o("td",null,i(n.product_name),1),o("td",null,i(n.sku),1),o("td",null,i(n.category_name),1),o("td",null,i(n.warehouse_name),1),o("td",ie,[l(R,{color:c.getStockColor(n),size:"small",variant:"flat"},{default:s(()=>[d(i(n.quantity||0),1)]),_:2},1032,["color"])]),o("td",de,i(n.minimum_stock_level||0),1),o("td",ue,i(c.formatCurrency((n.quantity||0)*(n.purchase_price||0))),1),o("td",null,[l(R,{color:c.getStockColor(n),size:"small",variant:"flat"},{default:s(()=>[d(i(c.getStockStatus(n)),1)]),_:2},1032,["color"])])]))),128)),r.reportData.length===0?(a(),f("tr",pe,t[37]||(t[37]=[o("td",{colspan:"8",class:"text-center py-4"},"No stock data found",-1)]))):D("",!0)],64))])]),_:1}),o("div",me,[o("div",ce,[r.reportData.length>0&&e.pagination.total>0?(a(),f("span",fe,[e.perPage==="all"?(a(),f("span",ge,[t[38]||(t[38]=d(" Showing ")),o("strong",null,"all "+i(e.pagination.total.toLocaleString()),1),t[39]||(t[39]=d(" records "))])):(a(),f("span",ye,[t[40]||(t[40]=d(" Showing ")),o("strong",null,i((e.currentPage-1)*e.perPage+1),1),t[41]||(t[41]=d(" to ")),o("strong",null,i(Math.min(e.currentPage*e.perPage,e.pagination.total).toLocaleString()),1),t[42]||(t[42]=d(" of ")),o("strong",null,i(e.pagination.total.toLocaleString()),1),t[43]||(t[43]=d(" records "))]))])):(a(),f("span",_e,"No records found"))]),l(V,{modelValue:e.currentPage,"onUpdate:modelValue":t[12]||(t[12]=n=>e.currentPage=n),pagination:e.pagination,"per-page-value":e.perPage,"per-page-options":e.perPageOptions,"onUpdate:perPage":e.onPerPageUpdate,onPageChange:e.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1})])}const he=L($t,[["render",ve],["__scopeId","data-v-59d7ecbc"]]),we={name:"DueReports",components:{PaginationControls:A},mixins:[T,B],data(){return{loading:!1,saving:!1,exporting:!1,filters:{party_type:"customer",party_id:null,overdue_only:!1},reportData:[],summary:null,customers:[],suppliers:[],paymentDialog:!1,selectedItem:null,paymentAmount:0,paymentMethod:"cash",paymentDate:new Date().toISOString().split("T")[0],paymentNotes:"",partyTypes:[{title:"Customer Due",value:"customer"},{title:"Supplier Due",value:"supplier"}],paymentMethods:[{title:"Cash",value:"cash"},{title:"Card",value:"card"},{title:"Mobile Banking",value:"mobile_banking"},{title:"Bank Transfer",value:"bank_transfer"},{title:"Cheque",value:"cheque"}],rules:{required:e=>!!e||"Required",maxDue:e=>{var g,b;const t=parseFloat(((g=this.selectedItem)==null?void 0:g.due_amount)||((b=this.selectedItem)==null?void 0:b.balance_amount)||0);return e<=t||`Cannot exceed due amount (${this.formatCurrency(t)})`}}}},computed:{partyOptions(){return this.filters.party_type==="customer"?this.customers:this.suppliers}},watch:{"filters.party_type"(){this.filters.party_id=null,this.resetPagination(),this.generateReport()}},mounted(){this.fetchParties(),this.generateReport()},methods:{async fetchParties(){try{const[e,t]=await Promise.all([this.$axios.get("/api/v1/customers",{headers:this.getAuthHeaders()}),this.$axios.get("/api/v1/suppliers",{headers:this.getAuthHeaders()})]);this.customers=e.data.data||e.data.customers||[],this.suppliers=t.data.data||t.data.suppliers||[]}catch(e){console.error("Failed to fetch parties",e)}},async generateReport(){try{this.loading=!0;const e=this.buildPaginationParams();this.perPage==="all"&&(e.per_page=999999),this.filters.party_type&&(e.party_type=this.filters.party_type),this.filters.party_id&&(e.party_id=this.filters.party_id),this.filters.overdue_only&&(e.overdue_only=this.filters.overdue_only);const t=await this.$axios.get("/api/v1/reports/due",{params:e,headers:this.getAuthHeaders()});this.reportData=t.data.data||t.data.due||[],this.summary=t.data.summary||null,this.updatePagination(t.data)}catch(e){this.handleApiError(e,"Failed to generate due report")}finally{this.loading=!1}},async exportExcel(){var e,t;try{this.exporting=!0;const g=await this.$axios.get("/api/v1/reports/due/export/excel",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),b=window.URL.createObjectURL(new Blob([g.data])),r=document.createElement("a");r.href=b,r.setAttribute("download",`due_report_${Date.now()}.xlsx`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(b),(e=this.$toast)==null||e.success("Report exported successfully")}catch(g){console.error("Failed to export Excel",g),(t=this.$toast)==null||t.error("Failed to export report")}finally{this.exporting=!1}},async exportPDF(){var e,t;try{this.exporting=!0;const g=await this.$axios.get("/api/v1/reports/due/export/pdf",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),b=window.URL.createObjectURL(new Blob([g.data])),r=document.createElement("a");r.href=b,r.setAttribute("download",`due_report_${Date.now()}.pdf`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(b),(e=this.$toast)==null||e.success("Report exported successfully")}catch(g){console.error("Failed to export PDF",g),(t=this.$toast)==null||t.error("Failed to export report")}finally{this.exporting=!1}},collectPayment(e){this.selectedItem=e,this.paymentAmount=parseFloat(e.due_amount||e.balance_amount),this.paymentDialog=!0},async savePayment(){var t;if((await this.$refs.paymentForm.validate()).valid){this.saving=!0;try{await this.$axios.post("/api/v1/payments",{payment_type:this.filters.party_type==="customer"?"sale":"purchase",party_type:this.filters.party_type,party_id:this.selectedItem.party_id||this.selectedItem.customer_id||this.selectedItem.supplier_id,reference_type:this.filters.party_type==="customer"?"sale":"purchase",reference_id:this.selectedItem.id,reference_number:this.selectedItem.invoice_number,payment_date:this.paymentDate,amount:this.paymentAmount,payment_method:this.paymentMethod,notes:this.paymentNotes},{headers:this.getAuthHeaders()}),(t=this.$toast)==null||t.success("Payment recorded successfully"),this.paymentDialog=!1,this.generateReport()}catch(g){this.handleApiError(g,"Failed to record payment")}finally{this.saving=!1}}},formatCurrency(e){return e==null?"৳0.00":"৳"+new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},isOverdue(e){return e?new Date(e)<new Date:!1},onFilterChange(){this.resetPagination(),this.generateReport()}}},be={class:"text-h6 font-weight-bold"},ke={class:"text-h6 font-weight-bold"},Pe={class:"text-h6 font-weight-bold"},De={class:"d-flex align-center gap-2"},Ce={class:"text-caption text-grey"},xe={key:0},Se={class:"sortable-header"},ze={class:"sortable-header"},Ve={class:"sortable-header"},Re={class:"sortable-header"},Ue={class:"sortable-header justify-end"},Fe={class:"sortable-header justify-end"},Le={class:"sortable-header justify-end"},Te={class:"text-end"},Be={class:"text-end"},Ae={class:"text-end"},Oe={key:0},je={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},Ee={class:"text-caption text-grey"},Ie={key:0},Me={key:0},Ne={key:1},He={key:1};function qe(e,t,g,b,r,c){const k=u("v-select"),y=u("v-col"),S=u("v-switch"),C=u("v-row"),h=u("v-card-text"),w=u("v-card"),P=u("v-btn"),z=u("v-card-title"),m=u("v-icon"),_=u("v-skeleton-loader"),R=u("v-chip"),U=u("v-table"),V=u("PaginationControls"),n=u("v-text-field"),E=u("v-textarea"),I=u("v-form"),M=u("v-spacer"),N=u("v-card-actions"),H=u("v-dialog");return a(),f("div",null,[l(w,{class:"mb-4"},{default:s(()=>[l(h,null,{default:s(()=>[l(C,null,{default:s(()=>[l(y,{cols:"12",md:"4"},{default:s(()=>[l(k,{modelValue:r.filters.party_type,"onUpdate:modelValue":[t[0]||(t[0]=v=>r.filters.party_type=v),c.onFilterChange],items:r.partyTypes,label:"Party Type",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"4"},{default:s(()=>[l(k,{modelValue:r.filters.party_id,"onUpdate:modelValue":[t[1]||(t[1]=v=>r.filters.party_id=v),c.onFilterChange],items:c.partyOptions,"item-value":"id","item-title":"name",label:"Select Party",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"4"},{default:s(()=>[l(S,{modelValue:r.filters.overdue_only,"onUpdate:modelValue":[t[2]||(t[2]=v=>r.filters.overdue_only=v),c.onFilterChange],label:"Overdue Only",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),r.summary?(a(),p(C,{key:0,class:"mb-4",dense:""},{default:s(()=>[l(y,{cols:"12",sm:"4"},{default:s(()=>[l(w,{color:"error",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[19]||(t[19]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Due Amount",-1)),o("div",be,i(c.formatCurrency(r.summary.total_due)),1)]),_:1,__:[19]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"4"},{default:s(()=>[l(w,{color:"warning",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[20]||(t[20]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Overdue Amount",-1)),o("div",ke,i(c.formatCurrency(r.summary.overdue_amount)),1)]),_:1,__:[20]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"4"},{default:s(()=>[l(w,{color:"info",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[21]||(t[21]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Parties",-1)),o("div",Pe,i(r.summary.total_parties||0),1)]),_:1,__:[21]})]),_:1})]),_:1})]),_:1})):D("",!0),l(w,null,{default:s(()=>[l(z,{class:"d-flex justify-space-between align-center"},{default:s(()=>[t[25]||(t[25]=o("span",null,"Due Report",-1)),o("div",De,[l(P,{color:"success",size:"small","prepend-icon":"mdi-file-excel",onClick:c.exportExcel,disabled:r.loading||!r.reportData.length,loading:r.exporting},{default:s(()=>t[22]||(t[22]=[d(" Export Excel ")])),_:1,__:[22]},8,["onClick","disabled","loading"]),l(P,{color:"error",size:"small","prepend-icon":"mdi-file-pdf-box",onClick:c.exportPDF,disabled:r.loading||!r.reportData.length,loading:r.exporting},{default:s(()=>t[23]||(t[23]=[d(" Export PDF ")])),_:1,__:[23]},8,["onClick","disabled","loading"]),o("span",Ce,[t[24]||(t[24]=d(" Total Records: ")),o("strong",null,i((e.pagination.total||0).toLocaleString()),1),r.reportData.length>0?(a(),f("span",xe," | Showing "+i((e.currentPage-1)*e.perPage+1)+" to "+i(Math.min(e.currentPage*e.perPage,e.pagination.total).toLocaleString())+" of "+i(e.pagination.total.toLocaleString()),1)):D("",!0)])])]),_:1,__:[25]}),l(h,null,{default:s(()=>[l(U,null,{default:s(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:t[3]||(t[3]=v=>e.onSort("party_name"))},[o("div",Se,[o("span",null,i(r.filters.party_type==="customer"?"Customer":"Supplier"),1),e.sortBy==="party_name"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[26]||(t[26]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[26]}))])]),o("th",{class:"sortable",onClick:t[4]||(t[4]=v=>e.onSort("invoice_number"))},[o("div",ze,[t[28]||(t[28]=o("span",null,"Invoice #",-1)),e.sortBy==="invoice_number"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[27]||(t[27]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[27]}))])]),o("th",{class:"sortable",onClick:t[5]||(t[5]=v=>e.onSort("invoice_date"))},[o("div",Ve,[t[30]||(t[30]=o("span",null,"Date",-1)),e.sortBy==="invoice_date"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[29]||(t[29]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[29]}))])]),o("th",{class:"sortable",onClick:t[6]||(t[6]=v=>e.onSort("due_date"))},[o("div",Re,[t[32]||(t[32]=o("span",null,"Due Date",-1)),e.sortBy==="due_date"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[31]||(t[31]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[31]}))])]),o("th",{class:"text-end sortable",onClick:t[7]||(t[7]=v=>e.onSort("total_amount"))},[o("div",Ue,[t[34]||(t[34]=o("span",null,"Total",-1)),e.sortBy==="total_amount"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[33]||(t[33]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[33]}))])]),o("th",{class:"text-end sortable",onClick:t[8]||(t[8]=v=>e.onSort("paid_amount"))},[o("div",Fe,[t[36]||(t[36]=o("span",null,"Paid",-1)),e.sortBy==="paid_amount"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[35]||(t[35]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[35]}))])]),o("th",{class:"text-end sortable",onClick:t[9]||(t[9]=v=>e.onSort("due_amount"))},[o("div",Le,[t[38]||(t[38]=o("span",null,"Due",-1)),e.sortBy==="due_amount"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[37]||(t[37]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[37]}))])]),t[39]||(t[39]=o("th",null,"Actions",-1))])]),o("tbody",null,[r.loading?(a(),f(x,{key:0},F(5,v=>o("tr",{key:`skeleton-${v}`},[o("td",null,[l(_,{type:"text",width:"150"})]),o("td",null,[l(_,{type:"text",width:"120"})]),o("td",null,[l(_,{type:"text",width:"100"})]),o("td",null,[l(_,{type:"text",width:"100"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"button",width:"80",height:"32"})])])),64)):(a(),f(x,{key:1},[(a(!0),f(x,null,F(r.reportData,v=>(a(),f("tr",{key:v.id||v.invoice_number},[o("td",null,i(v.party_name),1),o("td",null,i(v.invoice_number),1),o("td",null,i(e.formatDateDDMMYYYY(v.invoice_date)),1),o("td",null,[o("span",{class:j(c.isOverdue(v.due_date)?"text-error font-weight-bold":"")},i(e.formatDateDDMMYYYY(v.due_date)),3)]),o("td",Te,i(c.formatCurrency(v.total_amount)),1),o("td",Be,i(c.formatCurrency(v.paid_amount)),1),o("td",Ae,[l(R,{color:"error",size:"small",variant:"flat"},{default:s(()=>[d(i(c.formatCurrency(v.due_amount||v.balance_amount)),1)]),_:2},1024)]),o("td",null,[l(P,{size:"small",color:"success","prepend-icon":"mdi-cash",onClick:Uo=>c.collectPayment(v)},{default:s(()=>t[40]||(t[40]=[d(" Collect ")])),_:2,__:[40]},1032,["onClick"])])]))),128)),r.reportData.length===0?(a(),f("tr",Oe,t[41]||(t[41]=[o("td",{colspan:"8",class:"text-center py-4"},"No due data found",-1)]))):D("",!0)],64))])]),_:1}),o("div",je,[o("div",Ee,[r.reportData.length>0&&e.pagination.total>0?(a(),f("span",Ie,[e.perPage==="all"?(a(),f("span",Me,[t[42]||(t[42]=d(" Showing ")),o("strong",null,"all "+i(e.pagination.total.toLocaleString()),1),t[43]||(t[43]=d(" records "))])):(a(),f("span",Ne,[t[44]||(t[44]=d(" Showing ")),o("strong",null,i((e.currentPage-1)*e.perPage+1),1),t[45]||(t[45]=d(" to ")),o("strong",null,i(Math.min(e.currentPage*e.perPage,e.pagination.total).toLocaleString()),1),t[46]||(t[46]=d(" of ")),o("strong",null,i(e.pagination.total.toLocaleString()),1),t[47]||(t[47]=d(" records "))]))])):(a(),f("span",He,"No records found"))]),l(V,{modelValue:e.currentPage,"onUpdate:modelValue":t[10]||(t[10]=v=>e.currentPage=v),pagination:e.pagination,"per-page-value":e.perPage,"per-page-options":e.perPageOptions,"onUpdate:perPage":e.onPerPageUpdate,onPageChange:e.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1}),l(H,{modelValue:r.paymentDialog,"onUpdate:modelValue":t[18]||(t[18]=v=>r.paymentDialog=v),"max-width":"500px"},{default:s(()=>[r.selectedItem?(a(),p(w,{key:0},{default:s(()=>[l(z,null,{default:s(()=>t[48]||(t[48]=[d("Collect Payment")])),_:1,__:[48]}),l(h,null,{default:s(()=>[l(I,{ref:"paymentForm"},{default:s(()=>[l(n,{modelValue:r.selectedItem.party_name,"onUpdate:modelValue":t[11]||(t[11]=v=>r.selectedItem.party_name=v),label:"Party",readonly:""},null,8,["modelValue"]),l(n,{modelValue:r.selectedItem.invoice_number,"onUpdate:modelValue":t[12]||(t[12]=v=>r.selectedItem.invoice_number=v),label:"Invoice",readonly:""},null,8,["modelValue"]),l(n,{"model-value":c.formatCurrency(parseFloat(r.selectedItem.due_amount||r.selectedItem.balance_amount)),label:"Due Amount",readonly:""},null,8,["model-value"]),l(n,{modelValue:r.paymentAmount,"onUpdate:modelValue":t[13]||(t[13]=v=>r.paymentAmount=v),modelModifiers:{number:!0},type:"number",label:"Payment Amount *",rules:[r.rules.required,r.rules.maxDue]},null,8,["modelValue","rules"]),l(k,{modelValue:r.paymentMethod,"onUpdate:modelValue":t[14]||(t[14]=v=>r.paymentMethod=v),items:r.paymentMethods,label:"Payment Method *",rules:[r.rules.required]},null,8,["modelValue","items","rules"]),l(n,{modelValue:r.paymentDate,"onUpdate:modelValue":t[15]||(t[15]=v=>r.paymentDate=v),type:"date",label:"Payment Date *",rules:[r.rules.required]},null,8,["modelValue","rules"]),l(E,{modelValue:r.paymentNotes,"onUpdate:modelValue":t[16]||(t[16]=v=>r.paymentNotes=v),label:"Notes",rows:"2"},null,8,["modelValue"])]),_:1},512)]),_:1}),l(N,null,{default:s(()=>[l(M),l(P,{onClick:t[17]||(t[17]=v=>r.paymentDialog=!1)},{default:s(()=>t[49]||(t[49]=[d("Cancel")])),_:1,__:[49]}),l(P,{color:"success",loading:r.saving,onClick:c.savePayment},{default:s(()=>t[50]||(t[50]=[d("Save Payment")])),_:1,__:[50]},8,["loading","onClick"])]),_:1})]),_:1})):D("",!0)]),_:1},8,["modelValue"])])}const Ye=L(we,[["render",qe],["__scopeId","data-v-87141ba9"]]),$e={name:"ProfitReports",components:{PaginationControls:A,DatePicker:O},mixins:[T,B],data(){return{loading:!1,exporting:!1,filters:{date_from:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0],category_id:null,group_by:"daily"},reportData:[],chartData:[],summary:null,categories:[],groupByOptions:[{title:"Daily",value:"daily"},{title:"Weekly",value:"weekly"},{title:"Monthly",value:"monthly"},{title:"By Product",value:"product"},{title:"By Category",value:"category"}]}},mounted(){this.fetchCategories(),this.generateReport()},methods:{async fetchCategories(){try{const e=await this.$axios.get("/api/v1/categories",{headers:this.getAuthHeaders()});this.categories=e.data.data||e.data.categories||[]}catch(e){console.error("Failed to fetch categories",e)}},async generateReport(){try{this.loading=!0;const e=this.buildPaginationParams();this.perPage==="all"&&(e.per_page=999999),this.filters.date_from&&(e.date_from=this.filters.date_from),this.filters.date_to&&(e.date_to=this.filters.date_to),this.filters.category_id&&(e.category_id=this.filters.category_id),this.filters.group_by&&(e.group_by=this.filters.group_by);const t=await this.$axios.get("/api/v1/reports/profit",{params:e,headers:this.getAuthHeaders()});this.reportData=t.data.data||t.data.profit||[],this.chartData=t.data.chart||[],this.summary=t.data.summary||null,this.updatePagination(t.data)}catch(e){this.handleApiError(e,"Failed to generate profit report")}finally{this.loading=!1}},async exportExcel(){var e,t;try{this.exporting=!0;const g=await this.$axios.get("/api/v1/reports/profit/export/excel",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),b=window.URL.createObjectURL(new Blob([g.data])),r=document.createElement("a");r.href=b,r.setAttribute("download",`profit_report_${Date.now()}.xlsx`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(b),(e=this.$toast)==null||e.success("Report exported successfully")}catch(g){console.error("Failed to export Excel",g),(t=this.$toast)==null||t.error("Failed to export report")}finally{this.exporting=!1}},async exportPDF(){var e,t;try{this.exporting=!0;const g=await this.$axios.get("/api/v1/reports/profit/export/pdf",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),b=window.URL.createObjectURL(new Blob([g.data])),r=document.createElement("a");r.href=b,r.setAttribute("download",`profit_report_${Date.now()}.pdf`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(b),(e=this.$toast)==null||e.success("Report exported successfully")}catch(g){console.error("Failed to export PDF",g),(t=this.$toast)==null||t.error("Failed to export report")}finally{this.exporting=!1}},formatCurrency(e){return e==null?"৳0.00":"৳"+new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},onDateFromChange(e){this.filters.date_from=e||"",this.resetPagination(),this.generateReport()},onDateToChange(e){this.filters.date_to=e||"",this.resetPagination(),this.generateReport()},onFilterChange(){this.resetPagination(),this.generateReport()}}},Qe={class:"text-h6 font-weight-bold"},We={class:"text-h6 font-weight-bold"},Ge={class:"text-h6 font-weight-bold"},Ke={class:"text-h6 font-weight-bold"},Je={class:"d-flex align-center gap-2"},Xe={class:"text-caption text-grey"},Ze={key:0},to={class:"sortable-header"},eo={class:"sortable-header"},oo={class:"sortable-header justify-center"},so={class:"sortable-header justify-end"},lo={class:"sortable-header justify-end"},ro={class:"sortable-header justify-end"},no={class:"sortable-header justify-end"},ao={class:"sortable-header justify-end"},io={class:"text-center"},uo={class:"text-end"},po={class:"text-end"},mo={class:"text-end"},co={class:"text-end"},fo={class:"text-end"},go={key:0},yo={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},_o={class:"text-caption text-grey"},vo={key:0},ho={key:0},wo={key:1},bo={key:1};function ko(e,t,g,b,r,c){const k=u("DatePicker"),y=u("v-col"),S=u("v-select"),C=u("v-row"),h=u("v-card-text"),w=u("v-card"),P=u("v-btn"),z=u("v-card-title"),m=u("v-icon"),_=u("v-skeleton-loader"),R=u("v-chip"),U=u("v-table"),V=u("PaginationControls");return a(),f("div",null,[l(w,{class:"mb-4"},{default:s(()=>[l(h,null,{default:s(()=>[l(C,null,{default:s(()=>[l(y,{cols:"12",md:"3"},{default:s(()=>[l(k,{modelValue:r.filters.date_from,"onUpdate:modelValue":[t[0]||(t[0]=n=>r.filters.date_from=n),c.onDateFromChange],label:"From Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(k,{modelValue:r.filters.date_to,"onUpdate:modelValue":[t[1]||(t[1]=n=>r.filters.date_to=n),c.onDateToChange],label:"To Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(S,{modelValue:r.filters.category_id,"onUpdate:modelValue":[t[2]||(t[2]=n=>r.filters.category_id=n),c.onFilterChange],items:r.categories,"item-value":"id","item-title":"name",label:"Category",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(y,{cols:"12",md:"3"},{default:s(()=>[l(S,{modelValue:r.filters.group_by,"onUpdate:modelValue":[t[3]||(t[3]=n=>r.filters.group_by=n),c.onFilterChange],items:r.groupByOptions,label:"Group By",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),r.summary?(a(),p(C,{key:0,class:"mb-4",dense:""},{default:s(()=>[l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"primary",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[13]||(t[13]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Revenue",-1)),o("div",Qe,i(c.formatCurrency(r.summary.total_revenue)),1)]),_:1,__:[13]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"warning",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[14]||(t[14]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Cost",-1)),o("div",We,i(c.formatCurrency(r.summary.total_cost)),1)]),_:1,__:[14]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"success",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>[t[15]||(t[15]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Gross Profit",-1)),o("div",Ge,i(c.formatCurrency(r.summary.gross_profit)),1)]),_:1,__:[15]})]),_:1})]),_:1}),l(y,{cols:"12",sm:"6",md:"3"},{default:s(()=>[l(w,{color:"info",variant:"tonal",class:"summary-card"},{default:s(()=>[l(h,{class:"py-3"},{default:s(()=>{var n;return[t[16]||(t[16]=o("div",{class:"text-caption text-grey-darken-1 mb-1"},"Profit Margin",-1)),o("div",Ke,i(((n=r.summary.profit_margin)==null?void 0:n.toFixed(2))||0)+"%",1)]}),_:1,__:[16]})]),_:1})]),_:1})]),_:1})):D("",!0),l(w,null,{default:s(()=>[l(z,{class:"d-flex justify-space-between align-center"},{default:s(()=>[t[20]||(t[20]=o("span",null,"Profit Report",-1)),o("div",Je,[l(P,{color:"success",size:"small","prepend-icon":"mdi-file-excel",onClick:c.exportExcel,disabled:r.loading||!r.reportData.length,loading:r.exporting},{default:s(()=>t[17]||(t[17]=[d(" Export Excel ")])),_:1,__:[17]},8,["onClick","disabled","loading"]),l(P,{color:"error",size:"small","prepend-icon":"mdi-file-pdf-box",onClick:c.exportPDF,disabled:r.loading||!r.reportData.length,loading:r.exporting},{default:s(()=>t[18]||(t[18]=[d(" Export PDF ")])),_:1,__:[18]},8,["onClick","disabled","loading"]),o("span",Xe,[t[19]||(t[19]=d(" Total Records: ")),o("strong",null,i((e.pagination.total||0).toLocaleString()),1),r.reportData.length>0?(a(),f("span",Ze," | Showing "+i((e.currentPage-1)*e.perPage+1)+" to "+i(Math.min(e.currentPage*e.perPage,e.pagination.total).toLocaleString())+" of "+i(e.pagination.total.toLocaleString()),1)):D("",!0)])])]),_:1,__:[20]}),l(h,null,{default:s(()=>[l(U,null,{default:s(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:t[4]||(t[4]=n=>e.onSort("period"))},[o("div",to,[t[22]||(t[22]=o("span",null,"Period",-1)),e.sortBy==="period"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[21]||(t[21]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[21]}))])]),o("th",{class:"sortable",onClick:t[5]||(t[5]=n=>e.onSort("name"))},[o("div",eo,[t[24]||(t[24]=o("span",null,"Product/Category",-1)),e.sortBy==="name"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[23]||(t[23]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[23]}))])]),o("th",{class:"text-center sortable",onClick:t[6]||(t[6]=n=>e.onSort("quantity_sold"))},[o("div",oo,[t[26]||(t[26]=o("span",null,"Qty Sold",-1)),e.sortBy==="quantity_sold"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[25]||(t[25]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[25]}))])]),o("th",{class:"text-end sortable",onClick:t[7]||(t[7]=n=>e.onSort("revenue"))},[o("div",so,[t[28]||(t[28]=o("span",null,"Revenue",-1)),e.sortBy==="revenue"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[27]||(t[27]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[27]}))])]),o("th",{class:"text-end sortable",onClick:t[8]||(t[8]=n=>e.onSort("cost"))},[o("div",lo,[t[30]||(t[30]=o("span",null,"Cost",-1)),e.sortBy==="cost"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[29]||(t[29]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[29]}))])]),o("th",{class:"text-end sortable",onClick:t[9]||(t[9]=n=>e.onSort("discount"))},[o("div",ro,[t[32]||(t[32]=o("span",null,"Discount",-1)),e.sortBy==="discount"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[31]||(t[31]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[31]}))])]),o("th",{class:"text-end sortable",onClick:t[10]||(t[10]=n=>e.onSort("profit"))},[o("div",no,[t[34]||(t[34]=o("span",null,"Profit",-1)),e.sortBy==="profit"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[33]||(t[33]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[33]}))])]),o("th",{class:"text-end sortable",onClick:t[11]||(t[11]=n=>e.onSort("profit_margin"))},[o("div",ao,[t[36]||(t[36]=o("span",null,"Margin %",-1)),e.sortBy==="profit_margin"?(a(),p(m,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[d(i(e.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),p(m,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>t[35]||(t[35]=[d(" mdi-unfold-more-horizontal ")])),_:1,__:[35]}))])])])]),o("tbody",null,[r.loading?(a(),f(x,{key:0},F(5,n=>o("tr",{key:`skeleton-${n}`},[o("td",null,[l(_,{type:"text",width:"100"})]),o("td",null,[l(_,{type:"text",width:"150"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"text",width:"100"})]),o("td",null,[l(_,{type:"text",width:"100"})]),o("td",null,[l(_,{type:"text",width:"80"})]),o("td",null,[l(_,{type:"text",width:"100"})]),o("td",null,[l(_,{type:"text",width:"80"})])])),64)):(a(),f(x,{key:1},[(a(!0),f(x,null,F(r.reportData,n=>(a(),f("tr",{key:n.id||n.period||n.name},[o("td",null,i(n.period),1),o("td",null,i(n.name),1),o("td",io,i(n.quantity_sold||0),1),o("td",uo,i(c.formatCurrency(n.revenue)),1),o("td",po,i(c.formatCurrency(n.cost)),1),o("td",mo,i(c.formatCurrency(n.discount)),1),o("td",co,[l(R,{color:n.profit>=0?"success":"error",size:"small",variant:"flat"},{default:s(()=>[d(i(c.formatCurrency(n.profit)),1)]),_:2},1032,["color"])]),o("td",fo,i(parseFloat(n.profit_margin||0).toFixed(2))+"%",1)]))),128)),r.reportData.length===0?(a(),f("tr",go,t[37]||(t[37]=[o("td",{colspan:"8",class:"text-center py-4"},"No profit data found",-1)]))):D("",!0)],64))])]),_:1}),o("div",yo,[o("div",_o,[r.reportData.length>0&&e.pagination.total>0?(a(),f("span",vo,[e.perPage==="all"?(a(),f("span",ho,[t[38]||(t[38]=d(" Showing ")),o("strong",null,"all "+i(e.pagination.total.toLocaleString()),1),t[39]||(t[39]=d(" records "))])):(a(),f("span",wo,[t[40]||(t[40]=d(" Showing ")),o("strong",null,i((e.currentPage-1)*e.perPage+1),1),t[41]||(t[41]=d(" to ")),o("strong",null,i(Math.min(e.currentPage*e.perPage,e.pagination.total).toLocaleString()),1),t[42]||(t[42]=d(" of ")),o("strong",null,i(e.pagination.total.toLocaleString()),1),t[43]||(t[43]=d(" records "))]))])):(a(),f("span",bo,"No records found"))]),l(V,{modelValue:e.currentPage,"onUpdate:modelValue":t[12]||(t[12]=n=>e.currentPage=n),pagination:e.pagination,"per-page-value":e.perPage,"per-page-options":e.perPageOptions,"onUpdate:perPage":e.onPerPageUpdate,onPageChange:e.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1}),r.chartData.length?(a(),p(w,{key:1,class:"mt-4"},{default:s(()=>[l(z,null,{default:s(()=>t[44]||(t[44]=[d("Profit Trend")])),_:1,__:[44]}),l(h,null,{default:s(()=>t[45]||(t[45]=[o("div",{class:"text-center text-caption"}," Chart visualization would go here (integrate with Chart.js or similar) ",-1)])),_:1,__:[45]})]),_:1})):D("",!0)])}const Po=L($e,[["render",ko],["__scopeId","data-v-eed2fa52"]]),Do={name:"AdminReports",components:{SalesReports:vt,PurchaseReports:Yt,StockReports:he,DueReports:Ye,ProfitReports:Po},data(){return{activeTab:"sales"}}},Co={class:"pa-4"},xo={class:"pa-4"},So={class:"pa-4"},zo={class:"pa-4"},Vo={class:"pa-4"};function Ro(e,t,g,b,r,c){const k=u("v-icon"),y=u("v-tab"),S=u("v-tabs"),C=u("SalesReports"),h=u("v-window-item"),w=u("PurchaseReports"),P=u("StockReports"),z=u("DueReports"),m=u("ProfitReports"),_=u("v-window"),R=u("v-card-text"),U=u("v-card");return a(),f("div",null,[t[12]||(t[12]=o("div",{class:"page-header"},[o("h1",{class:"text-h4 page-title"},"Reports & Analytics")],-1)),l(U,null,{default:s(()=>[l(R,{class:"pa-0"},{default:s(()=>[l(S,{modelValue:r.activeTab,"onUpdate:modelValue":t[0]||(t[0]=V=>r.activeTab=V),"bg-color":"grey-lighten-5",color:"primary","slider-color":"primary",class:"reports-tabs"},{default:s(()=>[l(y,{value:"sales"},{default:s(()=>[l(k,{start:"",size:"small"},{default:s(()=>t[2]||(t[2]=[d("mdi-cash-register")])),_:1,__:[2]}),t[3]||(t[3]=o("span",null,"Sales Reports",-1))]),_:1,__:[3]}),l(y,{value:"purchase"},{default:s(()=>[l(k,{start:"",size:"small"},{default:s(()=>t[4]||(t[4]=[d("mdi-cart-arrow-down")])),_:1,__:[4]}),t[5]||(t[5]=o("span",null,"Purchase Reports",-1))]),_:1,__:[5]}),l(y,{value:"stock"},{default:s(()=>[l(k,{start:"",size:"small"},{default:s(()=>t[6]||(t[6]=[d("mdi-package-variant")])),_:1,__:[6]}),t[7]||(t[7]=o("span",null,"Stock Reports",-1))]),_:1,__:[7]}),l(y,{value:"due"},{default:s(()=>[l(k,{start:"",size:"small"},{default:s(()=>t[8]||(t[8]=[d("mdi-account-alert")])),_:1,__:[8]}),t[9]||(t[9]=o("span",null,"Due Reports",-1))]),_:1,__:[9]}),l(y,{value:"profit"},{default:s(()=>[l(k,{start:"",size:"small"},{default:s(()=>t[10]||(t[10]=[d("mdi-chart-line")])),_:1,__:[10]}),t[11]||(t[11]=o("span",null,"Profit Reports",-1))]),_:1,__:[11]})]),_:1},8,["modelValue"]),l(_,{modelValue:r.activeTab,"onUpdate:modelValue":t[1]||(t[1]=V=>r.activeTab=V),class:"reports-window"},{default:s(()=>[l(h,{value:"sales"},{default:s(()=>[o("div",Co,[l(C)])]),_:1}),l(h,{value:"purchase"},{default:s(()=>[o("div",xo,[l(w)])]),_:1}),l(h,{value:"stock"},{default:s(()=>[o("div",So,[l(P)])]),_:1}),l(h,{value:"due"},{default:s(()=>[o("div",zo,[l(z)])]),_:1}),l(h,{value:"profit"},{default:s(()=>[o("div",Vo,[l(m)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])}const Ao=L(Do,[["render",Ro],["__scopeId","data-v-6dfef3b9"]]);export{Ao as default};
