import{c as R}from"./commonMixin-BwIVv23E.js";import{_ as M,i as U,d as k,w as o,a as s,r,b as e,t as n,f as c,c as v,F as O,h as E,o as u,e as C}from"./app-CHfYI-xI.js";import{f as N}from"./formatters-DzU97YYy.js";import{P as K,p as T,d as W}from"./PaginationControls-6l2F_IVt.js";const L={name:"ProductDialog",props:{modelValue:{type:Boolean,required:!0},product:{type:Object,default:null}},emits:["update:modelValue","saved"],data(){return{form:this.getEmptyForm(),formValid:!1,saving:!1,categoryOptions:[],unitOptions:[],stockByWarehouse:[],rules:{required:a=>!!a||"Required"}}},computed:{isEdit(){return!!this.form.id}},watch:{product:{immediate:!0,async handler(a){this.form=a?{...this.getEmptyForm(),...a}:this.getEmptyForm(),a&&a.id?await this.loadProductStock(a.id):this.stockByWarehouse=[]}}},created(){this.fetchOptions()},methods:{getEmptyForm(){return{id:null,name:"",sku:"",barcode:"",brand:"",category_id:null,unit_id:null,order:0,description:"",image:"",purchase_price:0,sale_price:0,tax_rate:0,minimum_stock_level:0,is_active:!0}},async fetchOptions(){try{const[a,t]=await Promise.all([U.get("/api/v1/products/categories"),U.get("/api/v1/products/units")]);this.categoryOptions=a.data.categories||[],this.unitOptions=t.data.units||[]}catch(a){console.error("Failed to load options",a)}},async loadProductStock(a){try{const t=await U.get(`/api/v1/products/${a}`);t.data&&t.data.stock_by_warehouse?this.stockByWarehouse=t.data.stock_by_warehouse:this.stockByWarehouse=[]}catch(t){console.error("Failed to load product stock",t),this.stockByWarehouse=[]}},generateSKU(){let a="";if(this.form.name&&this.form.name.trim()){const _=this.form.name.trim().toUpperCase().split(/\s+/).map(l=>l.substring(0,2)).join("").substring(0,4),h=Date.now().toString().slice(-6);a=`${_}-${h}`}else{const t="PROD",_=Math.random().toString(36).substring(2,8).toUpperCase();a=`${t}-${_}`}this.form.sku=a},generateBarcode(){let a="";for(let h=0;h<12;h++)a+=Math.floor(Math.random()*10).toString();let t=0;for(let h=0;h<12;h++){const l=parseInt(a[h]);t+=h%2===0?l:l*3}const _=(10-t%10)%10;a+=_.toString(),this.form.barcode=a},close(){this.$emit("update:modelValue",!1)},async save(){var t;if(await this.$refs.formRef.validate()){this.saving=!0;try{const _={...this.form};if(delete _.stock_by_warehouse,this.isEdit){const h=await U.put(`/api/v1/products/${this.form.id}`,_);h.data&&h.data.stock_by_warehouse&&(this.stockByWarehouse=h.data.stock_by_warehouse)}else await U.post("/api/v1/products",_);this.$emit("saved"),this.close()}catch(_){console.error("Failed to save product",_),(t=this.$toast)==null||t.error("Failed to save product")}finally{this.saving=!1}}},getStockStatusColor(a){return this.form.minimum_stock_level?a<=0?"error":a<=this.form.minimum_stock_level?"warning":"success":"default"}}},Q={class:"text-h6 font-weight-medium"},G={key:0},H={class:"font-weight-medium"},Y={key:0,class:"text-caption text-grey ml-1"},J={class:"text-end"},X={class:"text-end"},Z={class:"text-end"},$={key:1,class:"text-center text-grey py-2"};function tt(a,t,_,h,l,i){const b=r("v-btn"),S=r("v-card-title"),w=r("v-divider"),P=r("v-text-field"),x=r("v-col"),j=r("v-select"),f=r("v-textarea"),F=r("v-switch"),y=r("v-row"),g=r("v-form"),V=r("v-chip"),A=r("v-table"),D=r("v-card-text"),z=r("v-card"),d=r("v-card-actions"),q=r("v-dialog");return u(),k(q,{"model-value":_.modelValue,"onUpdate:modelValue":t[15]||(t[15]=p=>a.$emit("update:modelValue",p)),"max-width":"700px",persistent:"",scrollable:""},{default:o(()=>[s(z,{class:"product-dialog"},{default:o(()=>[s(S,{class:"dialog-header d-flex justify-space-between align-center pa-3"},{default:o(()=>[e("span",Q,n(i.isEdit?"Edit Product":"Add Product"),1),s(b,{icon:"mdi-close",variant:"text",size:"small",onClick:i.close},null,8,["onClick"])]),_:1}),s(w),s(D,{class:"pa-3"},{default:o(()=>[s(g,{ref:"formRef",modelValue:l.formValid,"onUpdate:modelValue":t[14]||(t[14]=p=>l.formValid=p),"lazy-validation":""},{default:o(()=>[s(y,{dense:"",class:"ma-0"},{default:o(()=>[s(x,{cols:"12",class:"pa-2"},{default:o(()=>[s(P,{modelValue:l.form.name,"onUpdate:modelValue":t[0]||(t[0]=p=>l.form.name=p),placeholder:"Enter product name (e.g., Samsung Galaxy S21)",rules:[l.rules.required],density:"compact",variant:"outlined","hide-details":"auto",hint:"Enter the full product name as it should appear in the system","persistent-hint":""},{label:o(()=>t[16]||(t[16]=[c(" Product Name "),e("span",{class:"text-error",style:{"font-size":"1.2em","font-weight":"bold"}},"*",-1)])),_:1},8,["modelValue","rules"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(P,{modelValue:l.form.sku,"onUpdate:modelValue":t[1]||(t[1]=p=>l.form.sku=p),label:"SKU",placeholder:"Enter SKU or click generate to auto-generate",density:"compact",variant:"outlined","hide-details":"auto",hint:"Stock Keeping Unit - unique identifier for the product","persistent-hint":""},{"append-inner":o(()=>[s(b,{icon:"mdi-refresh",size:"x-small",variant:"text",onClick:i.generateSKU,title:"Generate SKU"},null,8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(P,{modelValue:l.form.barcode,"onUpdate:modelValue":t[2]||(t[2]=p=>l.form.barcode=p),label:"Barcode",placeholder:"Enter barcode (e.g., 1234567890123)",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: Product barcode for scanning","persistent-hint":""},{"append-inner":o(()=>[s(b,{icon:"mdi-refresh",size:"x-small",variant:"text",onClick:i.generateBarcode,title:"Generate Barcode"},null,8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(P,{modelValue:l.form.brand,"onUpdate:modelValue":t[3]||(t[3]=p=>l.form.brand=p),label:"Brand",placeholder:"Enter brand name (e.g., Samsung, Apple)",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: Product brand or manufacturer name","persistent-hint":""},null,8,["modelValue"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(P,{modelValue:l.form.image,"onUpdate:modelValue":t[4]||(t[4]=p=>l.form.image=p),label:"Image URL",placeholder:"Enter image URL or leave empty",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: Direct URL to product image","persistent-hint":""},null,8,["modelValue"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(j,{modelValue:l.form.category_id,"onUpdate:modelValue":t[5]||(t[5]=p=>l.form.category_id=p),items:l.categoryOptions,"item-value":"value","item-title":"label",label:"Category",placeholder:"Select a category",clearable:"",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: Product category for organization","persistent-hint":""},null,8,["modelValue","items"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(j,{modelValue:l.form.unit_id,"onUpdate:modelValue":t[6]||(t[6]=p=>l.form.unit_id=p),items:l.unitOptions,"item-value":"value","item-title":"label",label:"Unit",placeholder:"Select a unit",clearable:"",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: Measurement unit (e.g., KG, PCS, LTR)","persistent-hint":""},null,8,["modelValue","items"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(P,{modelValue:l.form.order,"onUpdate:modelValue":t[7]||(t[7]=p=>l.form.order=p),modelModifiers:{number:!0},label:"Display Order",type:"number",min:"0",placeholder:"Enter display order (e.g., 0, 1, 2)",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: Lower numbers appear first in the product list","persistent-hint":""},null,8,["modelValue"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(P,{modelValue:l.form.purchase_price,"onUpdate:modelValue":t[8]||(t[8]=p=>l.form.purchase_price=p),modelModifiers:{number:!0},type:"number",min:"0",step:"0.01",placeholder:"Enter purchase price (e.g., 1000.00)",rules:[l.rules.required],density:"compact",variant:"outlined","hide-details":"auto",hint:"Cost price at which the product was purchased","persistent-hint":""},{label:o(()=>t[17]||(t[17]=[c(" Purchase Price "),e("span",{class:"text-error",style:{"font-size":"1.2em","font-weight":"bold"}},"*",-1)])),_:1},8,["modelValue","rules"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(P,{modelValue:l.form.sale_price,"onUpdate:modelValue":t[9]||(t[9]=p=>l.form.sale_price=p),modelModifiers:{number:!0},type:"number",min:"0",step:"0.01",placeholder:"Enter sale price (e.g., 1500.00)",rules:[l.rules.required],density:"compact",variant:"outlined","hide-details":"auto",hint:"Selling price of the product to customers","persistent-hint":""},{label:o(()=>t[18]||(t[18]=[c(" Sale Price "),e("span",{class:"text-error",style:{"font-size":"1.2em","font-weight":"bold"}},"*",-1)])),_:1},8,["modelValue","rules"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(P,{modelValue:l.form.tax_rate,"onUpdate:modelValue":t[10]||(t[10]=p=>l.form.tax_rate=p),modelModifiers:{number:!0},label:"VAT/Tax (%)",type:"number",min:"0",step:"0.01",placeholder:"Enter tax rate (e.g., 15.00)",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: VAT or tax percentage applied to the product","persistent-hint":""},null,8,["modelValue"])]),_:1}),s(x,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(P,{modelValue:l.form.minimum_stock_level,"onUpdate:modelValue":t[11]||(t[11]=p=>l.form.minimum_stock_level=p),modelModifiers:{number:!0},label:"Minimum Stock Alert",type:"number",min:"0",placeholder:"Enter minimum stock level (e.g., 10)",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: Alert when stock falls below this quantity","persistent-hint":""},null,8,["modelValue"])]),_:1}),s(x,{cols:"12",class:"pa-2"},{default:o(()=>[s(f,{modelValue:l.form.description,"onUpdate:modelValue":t[12]||(t[12]=p=>l.form.description=p),label:"Description",rows:"2",placeholder:"Enter product description (optional)",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: Detailed description of the product","persistent-hint":""},null,8,["modelValue"])]),_:1}),s(x,{cols:"12",class:"pa-2 d-flex align-center"},{default:o(()=>[s(F,{modelValue:l.form.is_active,"onUpdate:modelValue":t[13]||(t[13]=p=>l.form.is_active=p),color:l.form.is_active?"success":"error",label:"Active Status",density:"compact","hide-details":"",inset:"",class:"active-switch"},null,8,["modelValue","color"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(w,{class:"my-3"}),t[21]||(t[21]=e("div",{class:"text-subtitle-2 font-weight-medium mb-2"},"Stock by Warehouse",-1)),s(z,{variant:"outlined",class:"mb-2"},{default:o(()=>[s(D,{class:"pa-2"},{default:o(()=>[l.stockByWarehouse&&l.stockByWarehouse.length>0?(u(),v("div",G,[s(A,{density:"compact"},{default:o(()=>[t[19]||(t[19]=e("thead",null,[e("tr",null,[e("th",null,"Warehouse"),e("th",{class:"text-end"},"Quantity"),e("th",{class:"text-end"},"Avg Cost"),e("th",{class:"text-end"},"Total Value")])],-1)),e("tbody",null,[(u(!0),v(O,null,E(l.stockByWarehouse,p=>(u(),v("tr",{key:p.warehouse_id},[e("td",null,[e("span",H,n(p.warehouse_name),1),p.warehouse_code?(u(),v("span",Y," ("+n(p.warehouse_code)+") ",1)):C("",!0)]),e("td",J,[s(V,{size:"small",color:i.getStockStatusColor(p.quantity),variant:"tonal"},{default:o(()=>[c(n(p.quantity||0),1)]),_:2},1032,["color"])]),e("td",X,"৳"+n(parseFloat(p.average_cost||0).toFixed(2)),1),e("td",Z,"৳"+n(parseFloat(p.total_value||0).toFixed(2)),1)]))),128))])]),_:1,__:[19]})])):(u(),v("div",$,t[20]||(t[20]=[e("span",{class:"text-caption"},"No stock information available",-1)])))]),_:1})]),_:1})]),_:1,__:[21]}),s(w),s(d,{class:"pa-2 justify-end"},{default:o(()=>[s(b,{variant:"text",size:"small",onClick:i.close},{default:o(()=>t[22]||(t[22]=[c("Cancel")])),_:1,__:[22]},8,["onClick"]),s(b,{color:"primary",size:"small",loading:l.saving,onClick:i.save},{default:o(()=>[c(n(i.isEdit?"Update":"Save"),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["model-value"])}const et=M(L,[["render",tt],["__scopeId","data-v-722c2ce6"]]),st={name:"ProductViewDialog",props:{modelValue:{type:Boolean,required:!0},product:{type:Object,default:null}},emits:["update:modelValue"],data(){return{loading:!1,productData:null}},computed:{displayProduct(){return this.productData||this.product},totalStock(){var a;return!((a=this.displayProduct)!=null&&a.stock_by_warehouse)||this.displayProduct.stock_by_warehouse.length===0?0:this.displayProduct.stock_by_warehouse.reduce((t,_)=>t+(parseFloat(_.quantity)||0),0)},profitPerUnit(){var _,h;const a=parseFloat(((_=this.displayProduct)==null?void 0:_.purchase_price)||0);return parseFloat(((h=this.displayProduct)==null?void 0:h.sale_price)||0)-a},profitMargin(){var _,h;const a=parseFloat(((_=this.displayProduct)==null?void 0:_.purchase_price)||0),t=parseFloat(((h=this.displayProduct)==null?void 0:h.sale_price)||0);return t===0?0:(t-a)/t*100}},watch:{modelValue(a){a&&this.product&&this.product.id?this.loadProductDetails():this.productData=null},product:{immediate:!0,handler(a){a&&a.id?this.loadProductDetails():this.productData=null}}},methods:{async loadProductDetails(){var a,t;if((a=this.product)!=null&&a.id){this.loading=!0;try{const _=await U.get(`/api/v1/products/${this.product.id}`);this.productData=_.data}catch(_){console.error("Failed to load product details",_),(t=this.$toast)==null||t.error("Failed to load product details")}finally{this.loading=!1}}},getStockStatusColor(a){var t;return(t=this.displayProduct)!=null&&t.minimum_stock_level?a<=0?"error":a<=this.displayProduct.minimum_stock_level?"warning":"success":"default"},formatDateShort:N,close(){this.$emit("update:modelValue",!1)}}},ot={key:0,class:"text-center py-8"},lt={key:1,class:"text-center py-8"},at={key:2},it={class:"text-center"},nt={class:"info-item-compact"},rt={class:"text-body-2 font-weight-medium ml-1"},dt={class:"info-item-compact"},ut={class:"info-item-compact"},ct={class:"text-body-2 ml-1"},mt={class:"info-item-compact"},pt={class:"text-body-2 ml-1"},_t={class:"info-item-compact"},ft={class:"text-body-2 ml-1"},vt={class:"info-item-compact"},yt={class:"text-body-2 ml-1"},ht={class:"info-item-compact"},gt={class:"text-body-2 ml-1"},xt={class:"info-item-compact"},kt={class:"text-body-2 font-weight-medium ml-1"},bt={class:"info-item-compact"},wt={class:"text-body-2 ml-1"},Pt={class:"info-item-compact"},Vt={class:"text-body-2 font-weight-medium ml-1"},St={class:"info-item-compact"},Ct={class:"text-body-2 font-weight-medium ml-1"},Ft={class:"info-item-compact"},jt={class:"text-body-2 ml-1"},Ut={class:"info-item-compact"},Dt={class:"text-body-2 font-weight-medium text-success ml-1"},zt={class:"info-item-compact"},At={class:"text-body-2 font-weight-medium text-success ml-1"},Bt={class:"info-item-compact"},Ot={class:"info-item-compact"},qt={class:"text-body-2 ml-1"},Et={class:"info-item-compact"},Wt={class:"text-body-2 ml-1"},Mt={class:"info-item-compact"},Tt={class:"text-body-2 ml-1"},It={class:"info-item-compact"},Rt={class:"text-body-2 ml-1"},Nt={class:"info-item-compact"},Kt={class:"text-body-2 ml-1"},Lt={key:1,class:"text-subtitle-2 font-weight-medium mb-2"},Qt={class:"font-weight-medium"},Gt={key:0,class:"text-caption text-grey ml-1"},Ht={class:"text-end"},Yt={class:"text-end"},Jt={class:"text-end"};function Xt(a,t,_,h,l,i){const b=r("v-btn"),S=r("v-card-title"),w=r("v-divider"),P=r("v-progress-circular"),x=r("v-alert"),j=r("v-img"),f=r("v-col"),F=r("v-chip"),y=r("v-row"),g=r("v-card-text"),V=r("v-card"),A=r("v-table"),D=r("v-card-actions"),z=r("v-dialog");return u(),k(z,{"model-value":_.modelValue,"onUpdate:modelValue":t[0]||(t[0]=d=>a.$emit("update:modelValue",d)),"max-width":"800px",persistent:"",scrollable:""},{default:o(()=>[s(V,{class:"product-view-dialog"},{default:o(()=>[s(S,{class:"dialog-header d-flex justify-space-between align-center pa-3"},{default:o(()=>[t[1]||(t[1]=e("span",{class:"text-h6 font-weight-medium"},"Product Details",-1)),s(b,{icon:"mdi-close",variant:"text",size:"small",onClick:i.close},null,8,["onClick"])]),_:1,__:[1]}),s(w),s(g,{class:"pa-3"},{default:o(()=>[l.loading?(u(),v("div",ot,[s(P,{indeterminate:"",color:"primary",size:"48"}),t[2]||(t[2]=e("div",{class:"mt-3 text-body-2"},"Loading product details...",-1))])):i.displayProduct?(u(),v("div",at,[t[25]||(t[25]=e("div",{class:"text-subtitle-2 font-weight-medium mb-2"},"Product Information",-1)),s(V,{variant:"outlined",class:"mb-2"},{default:o(()=>[s(g,{class:"pa-2"},{default:o(()=>[s(y,{dense:"",class:"ma-0"},{default:o(()=>[i.displayProduct.image?(u(),k(f,{key:0,cols:"12",sm:"3",class:"pa-2"},{default:o(()=>[e("div",it,[s(j,{src:i.displayProduct.image,"max-width":"120","max-height":"120",class:"mx-auto",style:{"border-radius":"8px"},cover:""},null,8,["src"])])]),_:1})):C("",!0),s(f,{cols:(i.displayProduct.image,12),sm:i.displayProduct.image?9:12,class:"pa-2"},{default:o(()=>[s(y,{dense:"",class:"ma-0"},{default:o(()=>[s(f,{cols:"12",sm:"6",md:"4",class:"pa-2"},{default:o(()=>[e("div",nt,[t[4]||(t[4]=e("span",{class:"text-caption text-grey"},"ID:",-1)),e("span",rt,n(i.displayProduct.id||"-"),1)])]),_:1}),s(f,{cols:"12",sm:"6",md:"4",class:"pa-2"},{default:o(()=>[e("div",dt,[t[5]||(t[5]=e("span",{class:"text-caption text-grey"},"Status:",-1)),s(F,{size:"x-small",color:i.displayProduct.is_active?"success":"error",variant:"tonal",class:"ml-1"},{default:o(()=>[c(n(i.displayProduct.is_active?"Active":"Inactive"),1)]),_:1},8,["color"])])]),_:1}),s(f,{cols:"12",sm:"6",md:"4",class:"pa-2"},{default:o(()=>[e("div",ut,[t[6]||(t[6]=e("span",{class:"text-caption text-grey"},"SKU:",-1)),e("span",ct,n(i.displayProduct.sku||"-"),1)])]),_:1}),s(f,{cols:"12",sm:"6",md:"4",class:"pa-2"},{default:o(()=>[e("div",mt,[t[7]||(t[7]=e("span",{class:"text-caption text-grey"},"Barcode:",-1)),e("span",pt,n(i.displayProduct.barcode||"-"),1)])]),_:1}),s(f,{cols:"12",sm:"6",md:"4",class:"pa-2"},{default:o(()=>[e("div",_t,[t[8]||(t[8]=e("span",{class:"text-caption text-grey"},"Brand:",-1)),e("span",ft,n(i.displayProduct.brand||"-"),1)])]),_:1}),s(f,{cols:"12",sm:"6",md:"4",class:"pa-2"},{default:o(()=>{var d;return[e("div",vt,[t[9]||(t[9]=e("span",{class:"text-caption text-grey"},"Category:",-1)),e("span",yt,n(((d=i.displayProduct.category)==null?void 0:d.name)||"-"),1)])]}),_:1}),s(f,{cols:"12",sm:"6",md:"4",class:"pa-2"},{default:o(()=>{var d;return[e("div",ht,[t[10]||(t[10]=e("span",{class:"text-caption text-grey"},"Unit:",-1)),e("span",gt,n(((d=i.displayProduct.unit)==null?void 0:d.name)||"-"),1)])]}),_:1}),s(f,{cols:"12",class:"pa-2"},{default:o(()=>[e("div",xt,[t[11]||(t[11]=e("span",{class:"text-caption text-grey"},"Name:",-1)),e("span",kt,n(i.displayProduct.name||"-"),1)])]),_:1}),i.displayProduct.description?(u(),k(f,{key:0,cols:"12",class:"pa-2"},{default:o(()=>[e("div",bt,[t[12]||(t[12]=e("span",{class:"text-caption text-grey"},"Description:",-1)),e("span",wt,n(i.displayProduct.description),1)])]),_:1})):C("",!0)]),_:1})]),_:1},8,["cols","sm"])]),_:1})]),_:1})]),_:1}),s(w,{class:"my-2"}),t[26]||(t[26]=e("div",{class:"text-subtitle-2 font-weight-medium mb-2"},"Pricing & Stock",-1)),s(V,{variant:"outlined",class:"mb-2"},{default:o(()=>[s(g,{class:"pa-2"},{default:o(()=>[s(y,{dense:"",class:"ma-0"},{default:o(()=>[s(f,{cols:"6",sm:"3",class:"pa-2"},{default:o(()=>[e("div",Pt,[t[13]||(t[13]=e("span",{class:"text-caption text-grey"},"Purchase:",-1)),e("span",Vt,"৳"+n(parseFloat(i.displayProduct.purchase_price||0).toFixed(2)),1)])]),_:1}),s(f,{cols:"6",sm:"3",class:"pa-2"},{default:o(()=>[e("div",St,[t[14]||(t[14]=e("span",{class:"text-caption text-grey"},"Sale:",-1)),e("span",Ct,"৳"+n(parseFloat(i.displayProduct.sale_price||0).toFixed(2)),1)])]),_:1}),s(f,{cols:"6",sm:"2",class:"pa-2"},{default:o(()=>[e("div",Ft,[t[15]||(t[15]=e("span",{class:"text-caption text-grey"},"Tax:",-1)),e("span",jt,n(parseFloat(i.displayProduct.tax_rate||0).toFixed(1))+"%",1)])]),_:1}),s(f,{cols:"6",sm:"2",class:"pa-2"},{default:o(()=>[e("div",Ut,[t[16]||(t[16]=e("span",{class:"text-caption text-grey"},"Profit:",-1)),e("span",Dt,"৳"+n(i.profitPerUnit.toFixed(2)),1)])]),_:1}),s(f,{cols:"6",sm:"2",class:"pa-2"},{default:o(()=>[e("div",zt,[t[17]||(t[17]=e("span",{class:"text-caption text-grey"},"Margin:",-1)),e("span",At,n(i.profitMargin.toFixed(1))+"%",1)])]),_:1}),s(f,{cols:"6",sm:"4",class:"pa-2"},{default:o(()=>[e("div",Bt,[t[18]||(t[18]=e("span",{class:"text-caption text-grey"},"Total Stock:",-1)),s(F,{size:"x-small",color:i.getStockStatusColor(i.totalStock),variant:"tonal",class:"ml-1 font-weight-medium"},{default:o(()=>[c(n(i.totalStock),1)]),_:1},8,["color"])])]),_:1}),s(f,{cols:"6",sm:"4",class:"pa-2"},{default:o(()=>[e("div",Ot,[t[19]||(t[19]=e("span",{class:"text-caption text-grey"},"Min Stock:",-1)),e("span",qt,n(i.displayProduct.minimum_stock_level||0),1)])]),_:1})]),_:1})]),_:1})]),_:1}),s(w,{class:"my-2"}),t[27]||(t[27]=e("div",{class:"text-subtitle-2 font-weight-medium mb-2"},"Audit Information",-1)),s(V,{variant:"outlined",class:"mb-2"},{default:o(()=>[s(g,{class:"pa-2"},{default:o(()=>[s(y,{dense:"",class:"ma-0"},{default:o(()=>[s(f,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>{var d;return[e("div",Et,[t[20]||(t[20]=e("span",{class:"text-caption text-grey"},"Created By:",-1)),e("span",Wt,n(((d=i.displayProduct.created_by)==null?void 0:d.name)||"-"),1)])]}),_:1}),s(f,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[e("div",Mt,[t[21]||(t[21]=e("span",{class:"text-caption text-grey"},"Created At:",-1)),e("span",Tt,n(i.formatDateShort(i.displayProduct.created_at)||"-"),1)])]),_:1}),s(f,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>{var d;return[e("div",It,[t[22]||(t[22]=e("span",{class:"text-caption text-grey"},"Updated By:",-1)),e("span",Rt,n(((d=i.displayProduct.updated_by)==null?void 0:d.name)||"-"),1)])]}),_:1}),s(f,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[e("div",Nt,[t[23]||(t[23]=e("span",{class:"text-caption text-grey"},"Updated At:",-1)),e("span",Kt,n(i.formatDateShort(i.displayProduct.updated_at)||"-"),1)])]),_:1})]),_:1})]),_:1})]),_:1}),i.displayProduct.stock_by_warehouse&&i.displayProduct.stock_by_warehouse.length>0?(u(),k(w,{key:0,class:"my-2"})):C("",!0),i.displayProduct.stock_by_warehouse&&i.displayProduct.stock_by_warehouse.length>0?(u(),v("div",Lt,"Stock by Warehouse")):C("",!0),i.displayProduct.stock_by_warehouse&&i.displayProduct.stock_by_warehouse.length>0?(u(),k(V,{key:2,variant:"outlined",class:"mb-2"},{default:o(()=>[s(g,{class:"pa-2"},{default:o(()=>[s(A,{density:"compact"},{default:o(()=>[t[24]||(t[24]=e("thead",null,[e("tr",null,[e("th",null,"Warehouse"),e("th",{class:"text-end"},"Qty"),e("th",{class:"text-end"},"Avg Cost"),e("th",{class:"text-end"},"Value")])],-1)),e("tbody",null,[(u(!0),v(O,null,E(i.displayProduct.stock_by_warehouse,d=>(u(),v("tr",{key:d.warehouse_id},[e("td",null,[e("span",Qt,n(d.warehouse_name),1),d.warehouse_code?(u(),v("span",Gt," ("+n(d.warehouse_code)+") ",1)):C("",!0)]),e("td",Ht,[s(F,{size:"x-small",color:i.getStockStatusColor(d.quantity),variant:"tonal"},{default:o(()=>[c(n(d.quantity||0),1)]),_:2},1032,["color"])]),e("td",Yt,"৳"+n(parseFloat(d.average_cost||0).toFixed(2)),1),e("td",Jt,"৳"+n(parseFloat(d.total_value||0).toFixed(2)),1)]))),128))])]),_:1,__:[24]})]),_:1})]),_:1})):C("",!0)])):(u(),v("div",lt,[s(x,{type:"error",variant:"tonal",class:"ma-3",density:"compact"},{default:o(()=>t[3]||(t[3]=[c(" Failed to load product details ")])),_:1,__:[3]})]))]),_:1}),s(w),s(D,{class:"pa-2 justify-end"},{default:o(()=>[s(b,{variant:"text",size:"small",onClick:i.close},{default:o(()=>t[28]||(t[28]=[c("Close")])),_:1,__:[28]},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model-value"])}const Zt=M(st,[["render",Xt],["__scopeId","data-v-46777e51"]]),$t={name:"StockAdjustmentDialog",props:{modelValue:{type:Boolean,required:!0},product:{type:Object,default:null}},emits:["update:modelValue","saved"],data(){return{stockFormValid:!1,adjustingStock:!1,warehouseOptions:[],stockByWarehouse:[],stockAdjustment:{warehouse_id:null,quantity:0,unit_cost:null,adjustment_type:"set",notes:""},adjustmentTypeOptions:[{value:"set",label:"Set Quantity"},{value:"add",label:"Add Stock"},{value:"subtract",label:"Subtract Stock"}],rules:{required:a=>!!a||"Required",positiveNumber:a=>a!=null&&a>=0||"Must be 0 or greater"}}},watch:{product:{immediate:!0,async handler(a){a&&a.id?(await this.loadProductStock(a.id),this.resetForm()):(this.stockByWarehouse=[],this.resetForm())}},modelValue(a){a&&this.product&&this.product.id&&this.loadProductStock(this.product.id)}},created(){this.fetchWarehouses()},methods:{async fetchWarehouses(){try{const a=await U.get("/api/v1/products/warehouses");this.warehouseOptions=a.data.warehouses||[]}catch(a){console.error("Failed to load warehouses",a)}},async loadProductStock(a){try{const t=await U.get(`/api/v1/products/${a}`);t.data&&t.data.stock_by_warehouse?this.stockByWarehouse=t.data.stock_by_warehouse:this.stockByWarehouse=[]}catch(t){console.error("Failed to load product stock",t),this.stockByWarehouse=[]}},getStockStatusColor(a){var t;return(t=this.product)!=null&&t.minimum_stock_level?a<=0?"error":a<=this.product.minimum_stock_level?"warning":"success":"default"},resetForm(){var a;this.stockAdjustment={warehouse_id:null,quantity:0,unit_cost:null,adjustment_type:"set",notes:""},(a=this.$refs.stockFormRef)==null||a.resetValidation()},close(){this.resetForm(),this.$emit("update:modelValue",!1)},async adjustStock(){var t,_,h,l,i,b,S;if(await((t=this.$refs.stockFormRef)==null?void 0:t.validate())){if(!this.product||!this.product.id){(_=this.$toast)==null||_.error("Product is required");return}if(!this.stockAdjustment.warehouse_id){(h=this.$toast)==null||h.error("Please select a warehouse");return}this.adjustingStock=!0;try{const w={product_id:this.product.id,warehouse_id:this.stockAdjustment.warehouse_id,quantity:this.stockAdjustment.quantity,adjustment_type:this.stockAdjustment.adjustment_type,unit_cost:this.stockAdjustment.unit_cost||null,notes:this.stockAdjustment.notes||"Manual stock adjustment"};await U.post("/api/v1/stocks",w),await this.loadProductStock(this.product.id),this.resetForm(),(l=this.$toast)==null||l.success("Stock adjusted successfully"),this.$emit("saved"),this.close()}catch(w){console.error("Failed to adjust stock",w);const P=((b=(i=w.response)==null?void 0:i.data)==null?void 0:b.message)||"Failed to adjust stock";(S=this.$toast)==null||S.error(P)}finally{this.adjustingStock=!1}}}}},te={class:"text-body-2"},ee={key:0,class:"mb-3"},se={class:"font-weight-medium"},oe={key:0,class:"text-caption text-grey ml-1"},le={class:"text-end"},ae={class:"text-end"},ie={class:"text-end"};function ne(a,t,_,h,l,i){const b=r("v-btn"),S=r("v-card-title"),w=r("v-divider"),P=r("v-card-text"),x=r("v-card"),j=r("v-chip"),f=r("v-table"),F=r("v-select"),y=r("v-col"),g=r("v-text-field"),V=r("v-row"),A=r("v-form"),D=r("v-card-actions"),z=r("v-dialog");return u(),k(z,{"model-value":_.modelValue,"onUpdate:modelValue":t[6]||(t[6]=d=>a.$emit("update:modelValue",d)),"max-width":"600px",persistent:"",scrollable:""},{default:o(()=>[s(x,{class:"stock-adjustment-dialog"},{default:o(()=>[s(S,{class:"dialog-header d-flex justify-space-between align-center pa-3"},{default:o(()=>[t[7]||(t[7]=e("span",{class:"text-h6 font-weight-medium"},"Adjust Stock",-1)),s(b,{icon:"mdi-close",variant:"text",size:"small",onClick:i.close},null,8,["onClick"])]),_:1,__:[7]}),s(w),s(P,{class:"pa-3"},{default:o(()=>[s(x,{variant:"outlined",class:"mb-3"},{default:o(()=>[s(P,{class:"pa-2"},{default:o(()=>{var d,q;return[t[10]||(t[10]=e("div",{class:"text-subtitle-2 font-weight-medium mb-1"},"Product Information",-1)),e("div",te,[e("div",null,[t[8]||(t[8]=e("strong",null,"Name:",-1)),c(" "+n(((d=_.product)==null?void 0:d.name)||"-"),1)]),e("div",null,[t[9]||(t[9]=e("strong",null,"SKU:",-1)),c(" "+n(((q=_.product)==null?void 0:q.sku)||"-"),1)])])]}),_:1,__:[10]})]),_:1}),l.stockByWarehouse&&l.stockByWarehouse.length>0?(u(),v("div",ee,[t[12]||(t[12]=e("div",{class:"text-subtitle-2 font-weight-medium mb-2"},"Current Stock by Warehouse",-1)),s(x,{variant:"outlined",class:"mb-3"},{default:o(()=>[s(P,{class:"pa-2"},{default:o(()=>[s(f,{density:"compact"},{default:o(()=>[t[11]||(t[11]=e("thead",null,[e("tr",null,[e("th",null,"Warehouse"),e("th",{class:"text-end"},"Quantity"),e("th",{class:"text-end"},"Avg Cost"),e("th",{class:"text-end"},"Total Value")])],-1)),e("tbody",null,[(u(!0),v(O,null,E(l.stockByWarehouse,d=>(u(),v("tr",{key:d.warehouse_id},[e("td",null,[e("span",se,n(d.warehouse_name),1),d.warehouse_code?(u(),v("span",oe," ("+n(d.warehouse_code)+") ",1)):C("",!0)]),e("td",le,[s(j,{size:"small",color:i.getStockStatusColor(d.quantity),variant:"tonal"},{default:o(()=>[c(n(d.quantity||0),1)]),_:2},1032,["color"])]),e("td",ae,"৳"+n(parseFloat(d.average_cost||0).toFixed(2)),1),e("td",ie,"৳"+n(parseFloat(d.total_value||0).toFixed(2)),1)]))),128))])]),_:1,__:[11]})]),_:1})]),_:1})])):C("",!0),t[16]||(t[16]=e("div",{class:"text-subtitle-2 font-weight-medium mb-2"},"Stock Adjustment",-1)),s(A,{ref:"stockFormRef",modelValue:l.stockFormValid,"onUpdate:modelValue":t[5]||(t[5]=d=>l.stockFormValid=d),"lazy-validation":""},{default:o(()=>[s(V,{dense:"",class:"ma-0"},{default:o(()=>[s(y,{cols:"12",class:"pa-2"},{default:o(()=>[s(F,{modelValue:l.stockAdjustment.warehouse_id,"onUpdate:modelValue":t[0]||(t[0]=d=>l.stockAdjustment.warehouse_id=d),items:l.warehouseOptions,"item-value":"value","item-title":"label",placeholder:"Select warehouse",clearable:"",density:"compact",variant:"outlined","hide-details":"auto",rules:[l.rules.required],hint:"Select the warehouse for stock adjustment","persistent-hint":""},{label:o(()=>t[13]||(t[13]=[c(" Warehouse "),e("span",{class:"text-error",style:{"font-size":"1.2em","font-weight":"bold"}},"*",-1)])),_:1},8,["modelValue","items","rules"])]),_:1}),s(y,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(F,{modelValue:l.stockAdjustment.adjustment_type,"onUpdate:modelValue":t[1]||(t[1]=d=>l.stockAdjustment.adjustment_type=d),items:l.adjustmentTypeOptions,"item-value":"value","item-title":"label",placeholder:"Select adjustment type",density:"compact",variant:"outlined","hide-details":"auto",rules:[l.rules.required],hint:"Set quantity, add stock, or subtract stock","persistent-hint":""},{label:o(()=>t[14]||(t[14]=[c(" Type "),e("span",{class:"text-error",style:{"font-size":"1.2em","font-weight":"bold"}},"*",-1)])),_:1},8,["modelValue","items","rules"])]),_:1}),s(y,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(g,{modelValue:l.stockAdjustment.quantity,"onUpdate:modelValue":t[2]||(t[2]=d=>l.stockAdjustment.quantity=d),modelModifiers:{number:!0},type:"number",min:"0",placeholder:"Enter quantity (e.g., 100)",density:"compact",variant:"outlined","hide-details":"auto",rules:[l.rules.required,l.rules.positiveNumber],hint:"Enter the quantity to adjust","persistent-hint":""},{label:o(()=>t[15]||(t[15]=[c(" Quantity "),e("span",{class:"text-error",style:{"font-size":"1.2em","font-weight":"bold"}},"*",-1)])),_:1},8,["modelValue","rules"])]),_:1}),s(y,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(g,{modelValue:l.stockAdjustment.unit_cost,"onUpdate:modelValue":t[3]||(t[3]=d=>l.stockAdjustment.unit_cost=d),modelModifiers:{number:!0},label:"Unit Cost (Optional)",type:"number",min:"0",step:"0.01",placeholder:"Enter unit cost (e.g., 50.00)",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: Cost per unit for this stock adjustment","persistent-hint":""},null,8,["modelValue"])]),_:1}),s(y,{cols:"12",sm:"6",class:"pa-2"},{default:o(()=>[s(g,{modelValue:l.stockAdjustment.notes,"onUpdate:modelValue":t[4]||(t[4]=d=>l.stockAdjustment.notes=d),label:"Notes (Optional)",placeholder:"Enter notes about this adjustment (optional)",density:"compact",variant:"outlined","hide-details":"auto",hint:"Optional: Additional notes or reason for stock adjustment","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1,__:[16]}),s(w),s(D,{class:"pa-2 justify-end"},{default:o(()=>[s(b,{variant:"text",size:"small",onClick:i.close},{default:o(()=>t[17]||(t[17]=[c("Cancel")])),_:1,__:[17]},8,["onClick"]),s(b,{color:"primary",size:"small",loading:l.adjustingStock,onClick:i.adjustStock},{default:o(()=>t[18]||(t[18]=[c(" Adjust Stock ")])),_:1,__:[18]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["model-value"])}const re=M($t,[["render",ne],["__scopeId","data-v-69ab1f92"]]),de={name:"AdminProducts",components:{ProductDialog:et,ProductViewDialog:Zt,StockAdjustmentDialog:re,PaginationControls:K},mixins:[R],data(){return{products:[],categoryOptions:[],categoryFilter:null,activeOptions:[{title:"Active",value:!0},{title:"Inactive",value:!1}],activeFilter:null,dialog:!1,editingProduct:null,viewDialog:!1,viewingProduct:null,stockDialog:!1,selectedProduct:null,sortBy:"order",sortDirection:"asc",currentPage:W.currentPage,perPage:W.perPage,perPageOptions:W.perPageOptions,pagination:{...W.pagination}}},async mounted(){await this.loadOptions(),await this.loadProducts()},methods:{async loadOptions(){try{const a=await this.$axios.get("/api/v1/products/categories",{headers:this.getAuthHeaders()});this.categoryOptions=a.data.categories||[]}catch(a){console.error("Failed to load categories",a)}},async loadProducts(){try{this.loading=!0;const a=this.buildPaginationParams();this.perPage==="all"&&(a.per_page=999999),this.search&&(a.search=this.search),this.categoryFilter&&(a.category_id=this.categoryFilter),this.activeFilter!==null&&(a.is_active=this.activeFilter);const t=await this.$axios.get("/api/v1/products",{params:a,headers:this.getAuthHeaders()});this.products=t.data.data||[],this.updatePagination(t.data)}catch(a){this.handleApiError(a,"Failed to load products")}finally{this.loading=!1}},onSort(a){this.handleSort(a),this.loadProducts()},openDialog(a){this.editingProduct=a,this.dialog=!0},openViewDialog(a){this.viewingProduct=a,this.viewDialog=!0},openStockDialog(a){this.selectedProduct=a,this.stockDialog=!0},async deleteProduct(a){if((await window.Swal.fire({title:"Are you sure?",text:`Do you want to delete "${a.name}"? This action cannot be undone.`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await this.$axios.delete(`/api/v1/products/${a.id}`,{headers:this.getAuthHeaders()}),await window.Swal.fire({icon:"success",title:"Deleted!",text:"Product has been deleted successfully.",timer:2e3,showConfirmButton:!1}),await this.loadProducts()}catch(_){this.handleApiError(_,"Error deleting product")}},onPerPageUpdate(a){this.perPage=a,this.onPerPageChange()},onPageChange(a){this.currentPage=a,this.loadProducts()},getStockStatusColor(a){const t=a.stock_quantity||0,_=a.minimum_stock_level||0;return t<=0?"error":_>0&&t<=_?"warning":"success"},buildPaginationParams(a={}){return T.buildPaginationParams(this.currentPage,this.perPage,a,this.sortBy,this.sortDirection)},updatePagination(a){T.updatePagination(this,a)},resetPagination(){T.resetPagination(this)},onPerPageChange(){this.resetPagination(),this.loadProducts()}}},ue={class:"page-header"},ce={class:"text-caption text-grey"},me={class:"sortable-header"},pe={class:"sortable-header"},_e={class:"sortable-header justify-end"},fe={class:"sortable-header justify-end"},ve={class:"sortable-header justify-end"},ye={class:"sortable-header justify-end"},he={class:"sortable-header"},ge={class:"d-flex"},xe={class:"font-weight-medium"},ke={class:"text-end"},be={class:"text-end"},we={class:"text-end"},Pe={class:"text-end"},Ve={class:"text-caption"},Se={class:"text-end"},Ce={key:0},Fe={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},je={class:"text-caption text-grey"},Ue={key:0},De={key:0},ze={key:1},Ae={key:1};function Be(a,t,_,h,l,i){const b=r("v-btn"),S=r("v-select"),w=r("v-col"),P=r("v-text-field"),x=r("v-row"),j=r("v-card-text"),f=r("v-card"),F=r("v-card-title"),y=r("v-icon"),g=r("v-skeleton-loader"),V=r("v-chip"),A=r("v-tooltip"),D=r("v-table"),z=r("PaginationControls"),d=r("product-dialog"),q=r("product-view-dialog"),p=r("stock-adjustment-dialog");return u(),v("div",null,[e("div",ue,[t[16]||(t[16]=e("h1",{class:"text-h4 page-title"},"Products",-1)),s(b,{color:"primary","prepend-icon":"mdi-plus",onClick:t[0]||(t[0]=m=>i.openDialog(null)),class:"add-button"},{default:o(()=>t[15]||(t[15]=[c(" Add Product ")])),_:1,__:[15]})]),s(f,{class:"mb-4"},{default:o(()=>[s(j,null,{default:o(()=>[s(x,null,{default:o(()=>[s(w,{cols:"12",md:"3"},{default:o(()=>[s(S,{modelValue:l.categoryFilter,"onUpdate:modelValue":[t[1]||(t[1]=m=>l.categoryFilter=m),i.loadProducts],items:l.categoryOptions,"item-value":"value","item-title":"label",label:"Category",clearable:"",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),s(w,{cols:"12",md:"3"},{default:o(()=>[s(S,{modelValue:l.activeFilter,"onUpdate:modelValue":[t[2]||(t[2]=m=>l.activeFilter=m),i.loadProducts],items:l.activeOptions,label:"Filter by Status",clearable:"",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),s(w,{cols:"12",md:"6"},{default:o(()=>[s(P,{modelValue:a.search,"onUpdate:modelValue":t[3]||(t[3]=m=>a.search=m),label:"Search by name, SKU, barcode","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:i.loadProducts},null,8,["modelValue","onInput"])]),_:1})]),_:1})]),_:1})]),_:1}),s(f,null,{default:o(()=>[s(F,{class:"d-flex justify-space-between align-center"},{default:o(()=>[t[18]||(t[18]=e("span",null,"Products",-1)),e("span",ce,[t[17]||(t[17]=c(" Total Records: ")),e("strong",null,n(l.pagination.total||0),1)])]),_:1,__:[18]}),s(j,null,{default:o(()=>[s(D,null,{default:o(()=>[e("thead",null,[e("tr",null,[e("th",{class:"sortable",onClick:t[4]||(t[4]=m=>i.onSort("name"))},[e("div",me,[t[20]||(t[20]=e("span",null,"Name",-1)),l.sortBy==="name"?(u(),k(y,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[c(n(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(u(),k(y,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>t[19]||(t[19]=[c(" mdi-unfold-more-horizontal ")])),_:1,__:[19]}))])]),e("th",{class:"sortable",onClick:t[5]||(t[5]=m=>i.onSort("sku"))},[e("div",pe,[t[22]||(t[22]=e("span",null,"SKU",-1)),l.sortBy==="sku"?(u(),k(y,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[c(n(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(u(),k(y,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>t[21]||(t[21]=[c(" mdi-unfold-more-horizontal ")])),_:1,__:[21]}))])]),t[33]||(t[33]=e("th",null,"Category",-1)),e("th",{class:"text-end sortable",onClick:t[6]||(t[6]=m=>i.onSort("order"))},[e("div",_e,[t[24]||(t[24]=e("span",null,"Order",-1)),l.sortBy==="order"?(u(),k(y,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[c(n(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(u(),k(y,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>t[23]||(t[23]=[c(" mdi-unfold-more-horizontal ")])),_:1,__:[23]}))])]),e("th",{class:"text-end sortable",onClick:t[7]||(t[7]=m=>i.onSort("purchase_price"))},[e("div",fe,[t[26]||(t[26]=e("span",null,"Purchase",-1)),l.sortBy==="purchase_price"?(u(),k(y,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[c(n(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(u(),k(y,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>t[25]||(t[25]=[c(" mdi-unfold-more-horizontal ")])),_:1,__:[25]}))])]),e("th",{class:"text-end sortable",onClick:t[8]||(t[8]=m=>i.onSort("sale_price"))},[e("div",ve,[t[28]||(t[28]=e("span",null,"Sale",-1)),l.sortBy==="sale_price"?(u(),k(y,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[c(n(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(u(),k(y,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>t[27]||(t[27]=[c(" mdi-unfold-more-horizontal ")])),_:1,__:[27]}))])]),t[34]||(t[34]=e("th",{class:"text-end"},"Total Stock",-1)),e("th",{class:"text-end sortable",onClick:t[9]||(t[9]=m=>i.onSort("minimum_stock_level"))},[e("div",ye,[t[30]||(t[30]=e("span",null,"Min Stock",-1)),l.sortBy==="minimum_stock_level"?(u(),k(y,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[c(n(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(u(),k(y,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>t[29]||(t[29]=[c(" mdi-unfold-more-horizontal ")])),_:1,__:[29]}))])]),e("th",{class:"sortable",onClick:t[10]||(t[10]=m=>i.onSort("is_active"))},[e("div",he,[t[32]||(t[32]=e("span",null,"Status",-1)),l.sortBy==="is_active"?(u(),k(y,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[c(n(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(u(),k(y,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>t[31]||(t[31]=[c(" mdi-unfold-more-horizontal ")])),_:1,__:[31]}))])]),t[35]||(t[35]=e("th",null,"Actions",-1))])]),e("tbody",null,[a.loading?(u(),v(O,{key:0},E(5,m=>e("tr",{key:`skeleton-${m}`},[e("td",null,[s(g,{type:"text",width:"150"})]),e("td",null,[s(g,{type:"text",width:"100"})]),e("td",null,[s(g,{type:"text",width:"120"})]),e("td",null,[s(g,{type:"text",width:"60"})]),e("td",null,[s(g,{type:"text",width:"80"})]),e("td",null,[s(g,{type:"text",width:"80"})]),e("td",null,[s(g,{type:"chip",width:"60",height:"24"})]),e("td",null,[s(g,{type:"text",width:"50"})]),e("td",null,[s(g,{type:"chip",width:"80",height:"24"})]),e("td",null,[e("div",ge,[s(g,{type:"button",width:"32",height:"32",class:"mr-1"}),s(g,{type:"button",width:"32",height:"32"})])])])),64)):(u(),v(O,{key:1},[(u(!0),v(O,null,E(l.products,m=>{var I;return u(),v("tr",{key:m.id},[e("td",null,[e("span",xe,n(m.name),1)]),e("td",null,n(m.sku||"-"),1),e("td",null,n(((I=m.category)==null?void 0:I.name)||"-"),1),e("td",ke,n(m.order||0),1),e("td",be,"৳"+n(parseFloat(m.purchase_price||0).toFixed(2)),1),e("td",we,"৳"+n(parseFloat(m.sale_price||0).toFixed(2)),1),e("td",Pe,[s(V,{size:"small",color:i.getStockStatusColor(m),variant:"tonal"},{default:o(()=>[c(n(m.stock_quantity||0),1)]),_:2},1032,["color"]),m.stock_by_warehouse&&m.stock_by_warehouse.length>0?(u(),k(A,{key:0,activator:"parent",location:"top"},{default:o(()=>[e("div",Ve,[(u(!0),v(O,null,E(m.stock_by_warehouse,B=>(u(),v("div",{key:B.warehouse_id,class:"py-1"},[e("strong",null,n(B.warehouse_name)+":",1),c(" "+n(B.quantity||0),1)]))),128))])]),_:2},1024)):C("",!0)]),e("td",Se,n(m.minimum_stock_level||0),1),e("td",null,[s(V,{size:"small",color:m.is_active?"success":"error",variant:"tonal"},{default:o(()=>[c(n(m.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),e("td",null,[s(b,{icon:"mdi-eye",variant:"text",size:"small",color:"info",onClick:B=>i.openViewDialog(m),title:"View Product"},null,8,["onClick"]),s(b,{icon:"mdi-pencil",variant:"text",size:"small",onClick:B=>i.openDialog(m)},null,8,["onClick"]),s(b,{icon:"mdi-package-variant",variant:"text",size:"small",color:"primary",onClick:B=>i.openStockDialog(m),title:"Adjust Stock"},null,8,["onClick"]),s(b,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:B=>i.deleteProduct(m)},null,8,["onClick"])])])}),128)),l.products.length===0?(u(),v("tr",Ce,t[36]||(t[36]=[e("td",{colspan:"10",class:"text-center py-4"},"No products found",-1)]))):C("",!0)],64))])]),_:1}),e("div",Fe,[e("div",je,[l.products.length>0&&l.pagination.total>0?(u(),v("span",Ue,[l.perPage==="all"?(u(),v("span",De,[t[37]||(t[37]=c(" Showing ")),e("strong",null,"all "+n(l.pagination.total.toLocaleString()),1),t[38]||(t[38]=c(" records "))])):(u(),v("span",ze,[t[39]||(t[39]=c(" Showing ")),e("strong",null,n((l.currentPage-1)*l.perPage+1),1),t[40]||(t[40]=c(" to ")),e("strong",null,n(Math.min(l.currentPage*l.perPage,l.pagination.total)),1),t[41]||(t[41]=c(" of ")),e("strong",null,n(l.pagination.total.toLocaleString()),1),t[42]||(t[42]=c(" records "))]))])):(u(),v("span",Ae,"No records found"))]),s(z,{modelValue:l.currentPage,"onUpdate:modelValue":t[11]||(t[11]=m=>l.currentPage=m),pagination:l.pagination,"per-page-value":l.perPage,"per-page-options":l.perPageOptions,"onUpdate:perPage":i.onPerPageUpdate,onPageChange:i.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1}),s(d,{modelValue:l.dialog,"onUpdate:modelValue":t[12]||(t[12]=m=>l.dialog=m),product:l.editingProduct,onSaved:i.loadProducts},null,8,["modelValue","product","onSaved"]),s(q,{modelValue:l.viewDialog,"onUpdate:modelValue":t[13]||(t[13]=m=>l.viewDialog=m),product:l.viewingProduct},null,8,["modelValue","product"]),s(p,{modelValue:l.stockDialog,"onUpdate:modelValue":t[14]||(t[14]=m=>l.stockDialog=m),product:l.selectedProduct,onSaved:i.loadProducts},null,8,["modelValue","product","onSaved"])])}const Me=M(de,[["render",Be],["__scopeId","data-v-ebcd1973"]]);export{Me as default};
