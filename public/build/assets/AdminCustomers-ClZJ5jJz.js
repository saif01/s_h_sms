import{c as T}from"./commonMixin-LD1l2-5e.js";import{p as O,P as M}from"./PaginationControls-CGFLaHsK.js";import{c as L}from"./validationRules-D8HGgtlI.js";import{_ as B,d as p,w as s,a as l,r as a,f as u,t as m,g as j,b as t,o as f,e as N,c as k,F as A,y as I}from"./app-CYStQJ0f.js";import{f as X,b as q}from"./formatters-DzU97YYy.js";const G={name:"CustomerDialog",props:{modelValue:{type:Boolean,default:!1},customer:{type:Object,default:null}},emits:["update:modelValue","save","cancel"],data(){return{activeTab:"basic",saving:!1,backendErrors:{},form:{name:"",code:"",company_name:"",email:"",phone:"",mobile:"",address:"",city:"",state:"",country:"",postal_code:"",tax_id:"",opening_balance:0,notes:"",is_active:!0}}},computed:{rules(){return L(this,"name")},dialogModel:{get(){return this.modelValue},set(o){this.$emit("update:modelValue",o)}},editingCustomer(){return this.customer!==null}},watch:{customer:{handler(o){this.activeTab="basic",o?this.form={name:o.name||"",code:o.code||"",company_name:o.company_name||"",email:o.email||"",phone:o.phone||"",mobile:o.mobile||"",address:o.address||"",city:o.city||"",state:o.state||"",country:o.country||"",postal_code:o.postal_code||"",tax_id:o.tax_id||"",opening_balance:o.opening_balance||0,notes:o.notes||"",is_active:o.is_active!==void 0?o.is_active:!0}:this.resetForm()},immediate:!0},dialogModel(o){o&&!this.editingCustomer&&this.$nextTick(()=>{!this.form.code&&this.form.name&&this.generateCodeFromName()})},"form.name"(o,e){o&&o.trim().length>3&&(!this.form.code||!this.form.code.trim())&&this.$nextTick(()=>{this.generateCodeFromName()})},"form.code"(o){!o&&this.form.name&&this.form.name.trim().length>3&&this.$nextTick(()=>{this.generateCodeFromName()})}},methods:{handleNameInput(){this.form.name&&this.form.name.trim().length>3&&(!this.form.code||!this.form.code.trim())&&this.$nextTick(()=>{this.generateCodeFromName()})},generateCodeFromName(o=!1){if(!this.form.name||!this.form.name.trim()||!o&&this.form.code&&this.form.code.trim())return;const e=this.form.name.replace(/[^A-Za-z]/g,"");if(!e||e.length===0){this.form.code="CUS-XXX";return}let c="";if(e.length>=3)c=e.substring(0,3).toUpperCase();else{c=e.toUpperCase();const w=c[0]||"X";for(;c.length<3;)c+=w}this.form.code=`CUS-${c}`},async generateCode(){this.generateCodeFromName()},manualGenerateCode(){this.form.name&&this.form.name.trim().length>3&&this.generateCodeFromName(!0)},resetForm(){this.form={name:"",code:"",company_name:"",email:"",phone:"",mobile:"",address:"",city:"",state:"",country:"",postal_code:"",tax_id:"",opening_balance:0,notes:"",is_active:!0},this.backendErrors={},this.$refs.form&&this.$refs.form.resetValidation()},async onSave(){var o,e,c,w;if(this.$refs.form.validate()){this.backendErrors={},this.saving=!0;try{const r=localStorage.getItem("admin_token"),n=(o=this.customer)==null?void 0:o.id;if(this.editingCustomer&&!n)throw new Error("Customer ID is missing. Cannot update customer.");const V=n?`/api/v1/customers/${n}`:"/api/v1/customers",g=n?"put":"post";await this.$axios[g](V,this.form,{headers:{Authorization:`Bearer ${r}`}}),this.$emit("save",{data:this.form,isEditing:!!n})}catch(r){if(((e=r.response)==null?void 0:e.status)===422&&((w=(c=r.response)==null?void 0:c.data)!=null&&w.errors)){this.backendErrors=r.response.data.errors;const n=[];Object.keys(this.backendErrors).forEach(g=>{(Array.isArray(this.backendErrors[g])?this.backendErrors[g]:[this.backendErrors[g]]).forEach(v=>{n.push(`${this.formatFieldName(g)}: ${v}`)})});const V=n.length>0?n.join("<br>"):"Please fix the validation errors in the form";this.showError(V),this.$nextTick(()=>{this.$refs.form&&this.$refs.form.validate()})}else this.$emit("error",r)}finally{this.saving=!1}}},formatFieldName(o){return o.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},showError(o){window.Toast?window.Toast.fire({icon:"error",title:"Validation Error",html:o}):window.Swal?window.Swal.fire({icon:"error",title:"Validation Error",html:o}):alert(o)},getFieldError(o){return this.backendErrors[o]?Array.isArray(this.backendErrors[o])?this.backendErrors[o][0]:this.backendErrors[o]:null},clearFieldError(o){this.backendErrors[o]&&(delete this.backendErrors[o],this.$forceUpdate())},onCancel(){this.resetForm(),this.$emit("cancel")}}},R={class:"pa-4"},H={class:"pa-4"},Z={class:"pa-4"};function J(o,e,c,w,r,n){const V=a("v-card-title"),g=a("v-tab"),E=a("v-tabs"),v=a("v-text-field"),h=a("v-btn"),x=a("v-switch"),C=a("v-window-item"),S=a("v-textarea"),_=a("v-col"),y=a("v-row"),F=a("v-window"),D=a("v-form"),U=a("v-card-text"),z=a("v-spacer"),b=a("v-card-actions"),i=a("v-card"),P=a("v-dialog");return f(),p(P,{modelValue:n.dialogModel,"onUpdate:modelValue":e[25]||(e[25]=d=>n.dialogModel=d),"max-width":"800",scrollable:"",persistent:""},{default:s(()=>[l(i,null,{default:s(()=>[l(V,null,{default:s(()=>[u(m(n.editingCustomer?"Edit Customer":"New Customer"),1)]),_:1}),l(U,null,{default:s(()=>[l(D,{ref:"form",onSubmit:j(n.onSave,["prevent"])},{default:s(()=>[l(E,{modelValue:r.activeTab,"onUpdate:modelValue":e[0]||(e[0]=d=>r.activeTab=d),"bg-color":"grey-lighten-4"},{default:s(()=>[l(g,{value:"basic"},{default:s(()=>e[26]||(e[26]=[u("Basic Information")])),_:1,__:[26]}),l(g,{value:"contact"},{default:s(()=>e[27]||(e[27]=[u("Contact Details")])),_:1,__:[27]}),l(g,{value:"financial"},{default:s(()=>e[28]||(e[28]=[u("Financial")])),_:1,__:[28]})]),_:1},8,["modelValue"]),l(F,{modelValue:r.activeTab,"onUpdate:modelValue":e[24]||(e[24]=d=>r.activeTab=d)},{default:s(()=>[l(C,{value:"basic"},{default:s(()=>[t("div",R,[l(v,{modelValue:r.form.name,"onUpdate:modelValue":[e[1]||(e[1]=d=>r.form.name=d),e[2]||(e[2]=d=>n.clearFieldError("name"))],variant:"outlined",rules:[n.rules.required],required:"",hint:"Enter the customer's full name","error-messages":n.getFieldError("name"),"persistent-hint":"",onInput:n.handleNameInput,class:"mb-4"},{label:s(()=>e[29]||(e[29]=[u(" Name "),t("span",{class:"text-error"},"*",-1)])),_:1},8,["modelValue","rules","error-messages","onInput"]),l(v,{modelValue:r.form.code,"onUpdate:modelValue":[e[3]||(e[3]=d=>r.form.code=d),e[4]||(e[4]=d=>n.clearFieldError("code"))],label:"Code",variant:"outlined",rules:[n.rules.maxLength(255)],"error-messages":n.getFieldError("code"),hint:"Auto-generated from name, but can be edited. Unique identifier for the customer","persistent-hint":"",class:"mb-4"},{"append-inner":s(()=>[l(h,{icon:"mdi-refresh",size:"small",variant:"text",onClick:n.manualGenerateCode,title:"Generate code from name",disabled:!r.form.name||r.form.name.trim().length<=3},null,8,["onClick","disabled"])]),_:1},8,["modelValue","rules","error-messages"]),l(v,{modelValue:r.form.company_name,"onUpdate:modelValue":[e[5]||(e[5]=d=>r.form.company_name=d),e[6]||(e[6]=d=>n.clearFieldError("company_name"))],label:"Company Name",variant:"outlined",rules:[n.rules.maxLength(255)],"error-messages":n.getFieldError("company_name"),hint:"Optional: Enter the company or business name if applicable","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),l(v,{modelValue:r.form.tax_id,"onUpdate:modelValue":[e[7]||(e[7]=d=>r.form.tax_id=d),e[8]||(e[8]=d=>n.clearFieldError("tax_id"))],label:"Tax ID",variant:"outlined",rules:[n.rules.maxLength(255)],"error-messages":n.getFieldError("tax_id"),hint:"Optional: Enter the tax identification number (TIN/VAT ID)","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),l(x,{modelValue:r.form.is_active,"onUpdate:modelValue":e[9]||(e[9]=d=>r.form.is_active=d),label:"Active",color:"success",hint:"Enable to make this customer active. Inactive customers won't appear in some lists","persistent-hint":"",class:"mb-4"},null,8,["modelValue"])])]),_:1}),l(C,{value:"contact"},{default:s(()=>[t("div",H,[l(v,{modelValue:r.form.email,"onUpdate:modelValue":[e[10]||(e[10]=d=>r.form.email=d),e[11]||(e[11]=d=>n.clearFieldError("email"))],label:"Email",type:"email",variant:"outlined",rules:[n.rules.email,n.rules.maxLength(255)],"error-messages":n.getFieldError("email"),hint:"Optional: Enter the customer's email address for communication","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),l(v,{modelValue:r.form.phone,"onUpdate:modelValue":[e[12]||(e[12]=d=>r.form.phone=d),e[13]||(e[13]=d=>n.clearFieldError("phone"))],label:"Phone",variant:"outlined",rules:[n.rules.phone,n.rules.maxLength(255)],"error-messages":n.getFieldError("phone"),hint:"Optional: Enter the landline or office phone number (e.g., 02-1234567)","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),l(v,{modelValue:r.form.mobile,"onUpdate:modelValue":[e[14]||(e[14]=d=>r.form.mobile=d),e[15]||(e[15]=d=>n.clearFieldError("mobile"))],label:"Mobile",variant:"outlined",rules:[n.rules.mobile,n.rules.maxLength(255)],"error-messages":n.getFieldError("mobile"),hint:"Optional: Enter the mobile or cell phone number (e.g., 01712345678)","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),l(S,{modelValue:r.form.address,"onUpdate:modelValue":e[16]||(e[16]=d=>r.form.address=d),label:"Address",variant:"outlined",rows:"2",hint:"Optional: Enter the complete street address","persistent-hint":"",class:"mb-4"},null,8,["modelValue"]),l(y,null,{default:s(()=>[l(_,{cols:"12",md:"6"},{default:s(()=>[l(v,{modelValue:r.form.city,"onUpdate:modelValue":e[17]||(e[17]=d=>r.form.city=d),label:"City",variant:"outlined",rules:[n.rules.maxLength(255)],hint:"Optional: Enter the city name","persistent-hint":""},null,8,["modelValue","rules"])]),_:1}),l(_,{cols:"12",md:"6"},{default:s(()=>[l(v,{modelValue:r.form.state,"onUpdate:modelValue":e[18]||(e[18]=d=>r.form.state=d),label:"State",variant:"outlined",rules:[n.rules.maxLength(255)],hint:"Optional: Enter the state or province name","persistent-hint":""},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(y,null,{default:s(()=>[l(_,{cols:"12",md:"6"},{default:s(()=>[l(v,{modelValue:r.form.country,"onUpdate:modelValue":e[19]||(e[19]=d=>r.form.country=d),label:"Country",variant:"outlined",rules:[n.rules.maxLength(255)],hint:"Optional: Enter the country name","persistent-hint":""},null,8,["modelValue","rules"])]),_:1}),l(_,{cols:"12",md:"6"},{default:s(()=>[l(v,{modelValue:r.form.postal_code,"onUpdate:modelValue":e[20]||(e[20]=d=>r.form.postal_code=d),label:"Postal Code",variant:"outlined",rules:[n.rules.maxLength(255)],hint:"Optional: Enter the postal code or zip code","persistent-hint":""},null,8,["modelValue","rules"])]),_:1})]),_:1})])]),_:1}),l(C,{value:"financial"},{default:s(()=>[t("div",Z,[l(v,{modelValue:r.form.opening_balance,"onUpdate:modelValue":[e[21]||(e[21]=d=>r.form.opening_balance=d),e[22]||(e[22]=d=>n.clearFieldError("opening_balance"))],modelModifiers:{number:!0},label:"Opening Balance",type:"number",step:"0.01",prefix:"৳",variant:"outlined",rules:[n.rules.numeric,n.rules.minValue(0)],"error-messages":n.getFieldError("opening_balance"),hint:"Enter the initial balance when creating this customer. Must be 0 or greater","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),l(S,{modelValue:r.form.notes,"onUpdate:modelValue":e[23]||(e[23]=d=>r.form.notes=d),label:"Notes",variant:"outlined",rows:"4",hint:"Optional: Add any additional notes or comments about this customer","persistent-hint":"",class:"mb-4"},null,8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["onSubmit"])]),_:1}),l(b,null,{default:s(()=>[l(z),l(h,{onClick:n.onCancel,variant:"text"},{default:s(()=>e[30]||(e[30]=[u("Cancel")])),_:1,__:[30]},8,["onClick"]),l(h,{onClick:n.onSave,color:"primary",loading:r.saving},{default:s(()=>[u(m(n.editingCustomer?"Update":"Create"),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const K=B(G,[["render",J],["__scopeId","data-v-42b500ac"]]),Q={name:"CustomerViewDialog",mixins:[T],props:{modelValue:{type:Boolean,default:!1},customer:{type:Object,default:null}},emits:["update:modelValue"],data(){return{activeTab:"basic"}},computed:{dialogModel:{get(){return this.modelValue},set(o){this.$emit("update:modelValue",o)}}},watch:{modelValue(o){o&&(this.activeTab="basic")}},methods:{formatCurrency:q,formatDateShort:X}},W={class:"pa-4"},Y={class:"mb-4"},$={class:"mt-1"},ee={class:"mb-4"},te={class:"mt-1"},oe={class:"mb-4"},le={class:"mt-1"},se={class:"mb-4"},ne={class:"mt-1"},re={class:"mb-4"},ae={class:"mt-1"},ie={class:"pa-4"},de={class:"mb-4"},me={class:"mt-1"},ue={class:"mb-4"},ce={class:"mt-1"},ve={class:"mb-4"},fe={class:"mt-1"},_e={class:"mb-4"},ge={class:"mt-1"},pe={class:"mb-4"},be={class:"mt-1"},he={class:"mb-4"},ye={class:"mt-1"},Ve={class:"mb-4"},Ce={class:"mt-1"},ke={class:"mb-4"},we={class:"mt-1"},Ee={class:"pa-4"},xe={class:"mb-4"},Se={class:"mt-1"},Fe={class:"mb-4"},De={class:"mt-1"},Ue={class:"mb-4"},ze={class:"mt-1"},Pe={class:"pa-4"},Ae={class:"mb-4"},Be={class:"mt-1"},Ie={class:"mb-4"},Te={class:"mt-1"},Ne={class:"mb-4"},Oe={class:"mt-1"},Me={class:"mb-4"},Le={class:"mt-1"};function je(o,e,c,w,r,n){const V=a("v-card-title"),g=a("v-tab"),E=a("v-tabs"),v=a("v-col"),h=a("v-row"),x=a("v-chip"),C=a("v-window-item"),S=a("v-window"),_=a("v-card-text"),y=a("v-spacer"),F=a("v-btn"),D=a("v-card-actions"),U=a("v-card"),z=a("v-dialog");return f(),p(z,{modelValue:n.dialogModel,"onUpdate:modelValue":e[3]||(e[3]=b=>n.dialogModel=b),"max-width":"800",scrollable:""},{default:s(()=>[c.customer?(f(),p(U,{key:0},{default:s(()=>[l(V,null,{default:s(()=>e[4]||(e[4]=[u(" Customer Details ")])),_:1,__:[4]}),l(_,null,{default:s(()=>[l(E,{modelValue:r.activeTab,"onUpdate:modelValue":e[0]||(e[0]=b=>r.activeTab=b),"bg-color":"grey-lighten-4"},{default:s(()=>[l(g,{value:"basic"},{default:s(()=>e[5]||(e[5]=[u("Basic Information")])),_:1,__:[5]}),l(g,{value:"contact"},{default:s(()=>e[6]||(e[6]=[u("Contact Details")])),_:1,__:[6]}),l(g,{value:"financial"},{default:s(()=>e[7]||(e[7]=[u("Financial")])),_:1,__:[7]}),l(g,{value:"audit"},{default:s(()=>e[8]||(e[8]=[u("System Information")])),_:1,__:[8]})]),_:1},8,["modelValue"]),l(S,{modelValue:r.activeTab,"onUpdate:modelValue":e[1]||(e[1]=b=>r.activeTab=b)},{default:s(()=>[l(C,{value:"basic"},{default:s(()=>[t("div",W,[l(h,null,{default:s(()=>[l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",Y,[e[9]||(e[9]=t("strong",{class:"text-grey-darken-1"},"Name:",-1)),t("div",$,m(c.customer.name||"-"),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",ee,[e[10]||(e[10]=t("strong",{class:"text-grey-darken-1"},"Code:",-1)),t("div",te,m(c.customer.code||"-"),1)])]),_:1})]),_:1}),l(h,null,{default:s(()=>[l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",oe,[e[11]||(e[11]=t("strong",{class:"text-grey-darken-1"},"Company Name:",-1)),t("div",le,m(c.customer.company_name||"-"),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",se,[e[12]||(e[12]=t("strong",{class:"text-grey-darken-1"},"Tax ID:",-1)),t("div",ne,m(c.customer.tax_id||"-"),1)])]),_:1})]),_:1}),t("div",re,[e[13]||(e[13]=t("strong",{class:"text-grey-darken-1"},"Status:",-1)),t("div",ae,[l(x,{color:c.customer.is_active?"success":"error",size:"small"},{default:s(()=>[u(m(c.customer.is_active?"Active":"Inactive"),1)]),_:1},8,["color"])])])])]),_:1}),l(C,{value:"contact"},{default:s(()=>[t("div",ie,[l(h,null,{default:s(()=>[l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",de,[e[14]||(e[14]=t("strong",{class:"text-grey-darken-1"},"Email:",-1)),t("div",me,m(c.customer.email||"-"),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",ue,[e[15]||(e[15]=t("strong",{class:"text-grey-darken-1"},"Phone:",-1)),t("div",ce,m(c.customer.phone||"-"),1)])]),_:1})]),_:1}),l(h,null,{default:s(()=>[l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",ve,[e[16]||(e[16]=t("strong",{class:"text-grey-darken-1"},"Mobile:",-1)),t("div",fe,m(c.customer.mobile||"-"),1)])]),_:1})]),_:1}),t("div",_e,[e[17]||(e[17]=t("strong",{class:"text-grey-darken-1"},"Address:",-1)),t("div",ge,m(c.customer.address||"-"),1)]),l(h,null,{default:s(()=>[l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",pe,[e[18]||(e[18]=t("strong",{class:"text-grey-darken-1"},"City:",-1)),t("div",be,m(c.customer.city||"-"),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",he,[e[19]||(e[19]=t("strong",{class:"text-grey-darken-1"},"State:",-1)),t("div",ye,m(c.customer.state||"-"),1)])]),_:1})]),_:1}),l(h,null,{default:s(()=>[l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",Ve,[e[20]||(e[20]=t("strong",{class:"text-grey-darken-1"},"Country:",-1)),t("div",Ce,m(c.customer.country||"-"),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",ke,[e[21]||(e[21]=t("strong",{class:"text-grey-darken-1"},"Postal Code:",-1)),t("div",we,m(c.customer.postal_code||"-"),1)])]),_:1})]),_:1})])]),_:1}),l(C,{value:"financial"},{default:s(()=>[t("div",Ee,[l(h,null,{default:s(()=>[l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",xe,[e[22]||(e[22]=t("strong",{class:"text-grey-darken-1"},"Opening Balance:",-1)),t("div",Se,m(n.formatCurrency(c.customer.opening_balance)),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",Fe,[e[23]||(e[23]=t("strong",{class:"text-grey-darken-1"},"Current Balance:",-1)),t("div",De,[l(x,{color:c.customer.current_balance>=0?"success":"error",size:"small"},{default:s(()=>[u(m(n.formatCurrency(c.customer.current_balance)),1)]),_:1},8,["color"])])])]),_:1})]),_:1}),t("div",Ue,[e[24]||(e[24]=t("strong",{class:"text-grey-darken-1"},"Notes:",-1)),t("div",ze,m(c.customer.notes||"-"),1)])])]),_:1}),l(C,{value:"audit"},{default:s(()=>[t("div",Pe,[l(h,null,{default:s(()=>[l(v,{cols:"12",md:"6"},{default:s(()=>{var b,i;return[t("div",Ae,[e[25]||(e[25]=t("strong",{class:"text-grey-darken-1"},"Created By:",-1)),t("div",Be,m(((b=c.customer.created_by)==null?void 0:b.name)||((i=c.customer.created_by)==null?void 0:i.email)||"-"),1)])]}),_:1}),l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",Ie,[e[26]||(e[26]=t("strong",{class:"text-grey-darken-1"},"Created At:",-1)),t("div",Te,m(n.formatDateShort(c.customer.created_at)),1)])]),_:1})]),_:1}),l(h,null,{default:s(()=>[l(v,{cols:"12",md:"6"},{default:s(()=>{var b,i;return[t("div",Ne,[e[27]||(e[27]=t("strong",{class:"text-grey-darken-1"},"Updated By:",-1)),t("div",Oe,m(((b=c.customer.updated_by)==null?void 0:b.name)||((i=c.customer.updated_by)==null?void 0:i.email)||"-"),1)])]}),_:1}),l(v,{cols:"12",md:"6"},{default:s(()=>[t("div",Me,[e[28]||(e[28]=t("strong",{class:"text-grey-darken-1"},"Updated At:",-1)),t("div",Le,m(n.formatDateShort(c.customer.updated_at)),1)])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(D,null,{default:s(()=>[l(y),l(F,{onClick:e[2]||(e[2]=b=>n.dialogModel=!1),variant:"text"},{default:s(()=>e[29]||(e[29]=[u("Close")])),_:1,__:[29]})]),_:1})]),_:1})):N("",!0)]),_:1},8,["modelValue"])}const Xe=B(Q,[["render",je],["__scopeId","data-v-989cdf17"]]),qe={components:{PaginationControls:M,CustomerDialog:K,CustomerViewDialog:Xe},mixins:[T,O],data(){return{customers:[],activeFilter:null,activeOptions:[{title:"Active",value:!0},{title:"Inactive",value:!1}],dialog:!1,viewDialog:!1,selectedCustomer:null,editingCustomer:null}},async mounted(){await this.loadCustomers()},methods:{async loadCustomers(){try{this.loading=!0;const o=this.buildPaginationParams();this.perPage==="all"&&(o.per_page=999999),this.search&&(o.search=this.search),this.activeFilter!==null&&(o.is_active=this.activeFilter);const e=await this.$axios.get("/api/v1/customers",{params:o,headers:this.getAuthHeaders()});this.customers=e.data.data||[],this.updatePagination(e.data)}catch(o){this.handleApiError(o,"Failed to load customers")}finally{this.loading=!1}},openDialog(o){this.editingCustomer=o,this.dialog=!0},closeDialog(){this.dialog=!1,this.editingCustomer=null},handleSaveSuccess({data:o,isEditing:e}){this.showSuccess(e?"Customer updated successfully":"Customer created successfully"),this.closeDialog(),this.loadCustomers()},handleSaveError(o){this.handleApiError(o,"Error saving customer")},async deleteCustomer(o){if(confirm(`Delete customer "${o.name}"?`))try{const e=localStorage.getItem("admin_token");await this.$axios.delete(`/api/v1/customers/${o.id}`,{headers:{Authorization:`Bearer ${e}`}}),this.showSuccess("Customer deleted successfully"),await this.loadCustomers()}catch(e){this.handleApiError(e,"Error deleting customer")}},viewCustomer(o){this.selectedCustomer=o,this.viewDialog=!0},formatCurrency(o){return o==null?"৳0.00":"৳"+new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(o)},isSortingBy(o){return this.sortBy===o},getSortDirection(o){return this.sortBy===o?this.sortDirection:null}}},Ge={class:"page-header"},Re={class:"text-caption text-grey"},He={class:"sortable-header"},Ze={class:"sortable-header"},Je={class:"sortable-header"},Ke={class:"sortable-header"},Qe={class:"sortable-header"},We={class:"sortable-header"},Ye={class:"sortable-header"},$e={key:0},et={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},tt={class:"text-caption text-grey"},ot={key:0},lt={key:0},st={key:1},nt={key:1};function rt(o,e,c,w,r,n){const V=a("v-btn"),g=a("v-select"),E=a("v-col"),v=a("v-text-field"),h=a("v-row"),x=a("v-card-text"),C=a("v-card"),S=a("v-card-title"),_=a("v-icon"),y=a("v-skeleton-loader"),F=a("v-chip"),D=a("v-table"),U=a("PaginationControls"),z=a("CustomerViewDialog"),b=a("CustomerDialog");return f(),k("div",null,[t("div",Ge,[e[14]||(e[14]=t("h1",{class:"text-h4 page-title"},"Customer Management",-1)),l(V,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=i=>n.openDialog(null)),class:"add-button"},{default:s(()=>e[13]||(e[13]=[u(" Add New Customer ")])),_:1,__:[13]})]),l(C,{class:"mb-4"},{default:s(()=>[l(x,null,{default:s(()=>[l(h,null,{default:s(()=>[l(E,{cols:"12",md:"4"},{default:s(()=>[l(g,{modelValue:r.activeFilter,"onUpdate:modelValue":[e[1]||(e[1]=i=>r.activeFilter=i),n.loadCustomers],items:r.activeOptions,label:"Filter by Status",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(E,{cols:"12",md:"8"},{default:s(()=>[l(v,{modelValue:o.search,"onUpdate:modelValue":e[2]||(e[2]=i=>o.search=i),label:"Search by name, code, company, email, phone","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:n.loadCustomers},null,8,["modelValue","onInput"])]),_:1})]),_:1})]),_:1})]),_:1}),l(C,null,{default:s(()=>[l(S,{class:"d-flex justify-space-between align-center"},{default:s(()=>[e[16]||(e[16]=t("span",null,"Customers",-1)),t("span",Re,[e[15]||(e[15]=u(" Total Records: ")),t("strong",null,m((o.pagination.total||0).toLocaleString()),1)])]),_:1,__:[16]}),l(x,null,{default:s(()=>[l(D,null,{default:s(()=>[t("thead",null,[t("tr",null,[t("th",{class:"sortable",onClick:e[3]||(e[3]=i=>o.onSort("code"))},[t("div",He,[e[18]||(e[18]=t("span",null,"Code",-1)),o.sortBy==="code"?(f(),p(_,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[u(m(o.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),p(_,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[17]||(e[17]=[u(" mdi-unfold-more-horizontal ")])),_:1,__:[17]}))])]),t("th",{class:"sortable",onClick:e[4]||(e[4]=i=>o.onSort("name"))},[t("div",Ze,[e[20]||(e[20]=t("span",null,"Name",-1)),o.sortBy==="name"?(f(),p(_,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[u(m(o.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),p(_,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[19]||(e[19]=[u(" mdi-unfold-more-horizontal ")])),_:1,__:[19]}))])]),t("th",{class:"sortable",onClick:e[5]||(e[5]=i=>o.onSort("company_name"))},[t("div",Je,[e[22]||(e[22]=t("span",null,"Company",-1)),o.sortBy==="company_name"?(f(),p(_,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[u(m(o.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),p(_,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[21]||(e[21]=[u(" mdi-unfold-more-horizontal ")])),_:1,__:[21]}))])]),t("th",{class:"sortable",onClick:e[6]||(e[6]=i=>o.onSort("email"))},[t("div",Ke,[e[24]||(e[24]=t("span",null,"Email",-1)),o.sortBy==="email"?(f(),p(_,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[u(m(o.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),p(_,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[23]||(e[23]=[u(" mdi-unfold-more-horizontal ")])),_:1,__:[23]}))])]),t("th",{class:"sortable",onClick:e[7]||(e[7]=i=>o.onSort("phone"))},[t("div",Qe,[e[26]||(e[26]=t("span",null,"Phone",-1)),o.sortBy==="phone"?(f(),p(_,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[u(m(o.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),p(_,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[25]||(e[25]=[u(" mdi-unfold-more-horizontal ")])),_:1,__:[25]}))])]),t("th",{class:"sortable",onClick:e[8]||(e[8]=i=>o.onSort("city"))},[t("div",We,[e[28]||(e[28]=t("span",null,"City",-1)),o.sortBy==="city"?(f(),p(_,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[u(m(o.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),p(_,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[27]||(e[27]=[u(" mdi-unfold-more-horizontal ")])),_:1,__:[27]}))])]),t("th",{class:"sortable",onClick:e[9]||(e[9]=i=>o.onSort("current_balance"))},[t("div",Ye,[e[30]||(e[30]=t("span",null,"Balance",-1)),o.sortBy==="current_balance"?(f(),p(_,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[u(m(o.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),p(_,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[29]||(e[29]=[u(" mdi-unfold-more-horizontal ")])),_:1,__:[29]}))])]),e[31]||(e[31]=t("th",null,"Status",-1)),e[32]||(e[32]=t("th",null,"Actions",-1))])]),t("tbody",null,[o.loading?(f(),k(A,{key:0},I(5,i=>t("tr",{key:`skeleton-${i}`},[t("td",null,[l(y,{type:"text",width:"100"})]),t("td",null,[l(y,{type:"text",width:"150"})]),t("td",null,[l(y,{type:"text",width:"150"})]),t("td",null,[l(y,{type:"text",width:"150"})]),t("td",null,[l(y,{type:"text",width:"120"})]),t("td",null,[l(y,{type:"text",width:"100"})]),t("td",null,[l(y,{type:"text",width:"100"})]),t("td",null,[l(y,{type:"chip",width:"80",height:"24"})]),t("td",null,[l(y,{type:"button",width:"32",height:"32"})])])),64)):(f(),k(A,{key:1},[(f(!0),k(A,null,I(r.customers,i=>(f(),k("tr",{key:i.id},[t("td",null,m(i.code||"-"),1),t("td",null,m(i.name),1),t("td",null,m(i.company_name||"-"),1),t("td",null,m(i.email||"-"),1),t("td",null,m(i.phone||i.mobile||"-"),1),t("td",null,m(i.city||"-"),1),t("td",null,[l(F,{color:i.current_balance>=0?"success":"error",size:"small"},{default:s(()=>[u(m(n.formatCurrency(i.current_balance)),1)]),_:2},1032,["color"])]),t("td",null,[l(F,{color:i.is_active?"success":"error",size:"small"},{default:s(()=>[u(m(i.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),t("td",null,[l(V,{size:"small",icon:"mdi-eye",onClick:P=>n.viewCustomer(i),variant:"text",title:"View"},null,8,["onClick"]),l(V,{size:"small",icon:"mdi-pencil",onClick:P=>n.openDialog(i),variant:"text",title:"Edit"},null,8,["onClick"]),l(V,{size:"small",icon:"mdi-delete",onClick:P=>n.deleteCustomer(i),variant:"text",color:"error",title:"Delete"},null,8,["onClick"])])]))),128)),r.customers.length===0?(f(),k("tr",$e,e[33]||(e[33]=[t("td",{colspan:"9",class:"text-center py-4"},"No customers found",-1)]))):N("",!0)],64))])]),_:1}),t("div",et,[t("div",tt,[r.customers.length>0&&o.pagination.total>0?(f(),k("span",ot,[o.perPage==="all"?(f(),k("span",lt,[e[34]||(e[34]=u(" Showing ")),t("strong",null,"all "+m(o.pagination.total.toLocaleString()),1),e[35]||(e[35]=u(" records "))])):(f(),k("span",st,[e[36]||(e[36]=u(" Showing ")),t("strong",null,m((o.currentPage-1)*o.perPage+1),1),e[37]||(e[37]=u(" to ")),t("strong",null,m(Math.min(o.currentPage*o.perPage,o.pagination.total).toLocaleString()),1),e[38]||(e[38]=u(" of ")),t("strong",null,m(o.pagination.total.toLocaleString()),1),e[39]||(e[39]=u(" records "))]))])):(f(),k("span",nt,"No records found"))]),l(U,{modelValue:o.currentPage,"onUpdate:modelValue":e[10]||(e[10]=i=>o.currentPage=i),pagination:o.pagination,"per-page-value":o.perPage,"per-page-options":o.perPageOptions,"onUpdate:perPage":o.onPerPageUpdate,onPageChange:o.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1}),l(z,{modelValue:r.viewDialog,"onUpdate:modelValue":e[11]||(e[11]=i=>r.viewDialog=i),customer:r.selectedCustomer},null,8,["modelValue","customer"]),l(b,{modelValue:r.dialog,"onUpdate:modelValue":e[12]||(e[12]=i=>r.dialog=i),customer:r.editingCustomer,onSave:n.handleSaveSuccess,onError:n.handleSaveError,onCancel:n.closeDialog},null,8,["modelValue","customer","onSave","onError","onCancel"])])}const ct=B(qe,[["render",rt],["__scopeId","data-v-ee5a7bbc"]]);export{ct as default};
