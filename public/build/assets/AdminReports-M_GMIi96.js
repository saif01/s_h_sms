import{c as j}from"./commonMixin-BwIVv23E.js";import{P as N,p as z,d as E}from"./PaginationControls-6l2F_IVt.js";import{D as I}from"./DatePicker-D0g-fZ2A.js";import{_ as T,c as C,a as t,d as k,e as S,w as o,r as i,b as a,t as u,f as n,F as O,h as L,o as f,p as A,i as w}from"./app-CHfYI-xI.js";const H={name:"SalesReports",components:{PaginationControls:N,DatePicker:I},mixins:[j],data(){return{loading:!1,exporting:!1,filters:{date_from:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0],customer_id:null,status:null},reportData:[],topProducts:[],summary:null,customers:[],statusOptions:[{title:"Draft",value:"draft"},{title:"Pending",value:"pending"},{title:"Partial",value:"partial"},{title:"Paid",value:"paid"},{title:"Cancelled",value:"cancelled"}],currentPage:E.currentPage,perPage:E.perPage,perPageOptions:E.perPageOptions,pagination:{...E.pagination}}},mounted(){this.fetchCustomers(),this.generateReport()},methods:{async fetchCustomers(){try{const r=await this.$axios.get("/api/v1/customers",{headers:this.getAuthHeaders()});this.customers=r.data.data||r.data.customers||[]}catch(r){console.error("Failed to fetch customers",r)}},async generateReport(){try{this.loading=!0;const r=this.buildPaginationParams();this.perPage==="all"&&(r.per_page=999999),this.filters.date_from&&(r.date_from=this.filters.date_from),this.filters.date_to&&(r.date_to=this.filters.date_to),this.filters.customer_id&&(r.customer_id=this.filters.customer_id),this.filters.status&&(r.status=this.filters.status);const e=await this.$axios.get("/api/v1/reports/sales",{params:r,headers:this.getAuthHeaders()});this.reportData=e.data.data||e.data.sales||[],this.topProducts=e.data.top_products||[],this.summary=e.data.summary||null,this.updatePagination(e.data)}catch(r){this.handleApiError(r,"Failed to generate sales report")}finally{this.loading=!1}},async exportExcel(){var r,e;try{this.exporting=!0;const v=await this.$axios.get("/api/v1/reports/sales/export/excel",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),d=window.URL.createObjectURL(new Blob([v.data])),l=document.createElement("a");l.href=d,l.setAttribute("download",`sales_report_${Date.now()}.xlsx`),document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(d),(r=this.$toast)==null||r.success("Report exported successfully")}catch(v){console.error("Failed to export Excel",v),(e=this.$toast)==null||e.error("Failed to export report")}finally{this.exporting=!1}},async exportPDF(){var r,e;try{this.exporting=!0;const v=await this.$axios.get("/api/v1/reports/sales/export/pdf",{params:this.filters,responseType:"blob",headers:this.getAuthHeaders()}),d=window.URL.createObjectURL(new Blob([v.data])),l=document.createElement("a");l.href=d,l.setAttribute("download",`sales_report_${Date.now()}.pdf`),document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(d),(r=this.$toast)==null||r.success("Report exported successfully")}catch(v){console.error("Failed to export PDF",v),(e=this.$toast)==null||e.error("Failed to export report")}finally{this.exporting=!1}},formatCurrency(r){return r==null?"৳0.00":"৳"+new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(r)},getStatusColor(r){return{draft:"grey",pending:"warning",partial:"info",paid:"success",cancelled:"error"}[r]||"grey"},onDateFromChange(r){this.filters.date_from=r||"",this.resetPagination(),this.generateReport()},onDateToChange(r){this.filters.date_to=r||"",this.resetPagination(),this.generateReport()},buildPaginationParams(r={}){return z.buildPaginationParams(this.currentPage,this.perPage,r,this.sortBy,this.sortDirection)},updatePagination(r){z.updatePagination(this,r)},resetPagination(){z.resetPagination(this)},onPerPageUpdate(r){this.perPage=r,this.onPerPageChange()},onPageChange(r){this.currentPage=r,this.generateReport()},onPerPageChange(){this.resetPagination(),this.generateReport()},onSort(r){this.handleSort(r),this.currentPage=1,this.generateReport()},onFilterChange(){this.resetPagination(),this.generateReport()}}},Y={class:"text-h6 font-weight-bold"},G={class:"text-h6 font-weight-bold"},Q={class:"text-h6 font-weight-bold"},W={class:"text-h6 font-weight-bold"},K={class:"d-flex align-center gap-2"},J={class:"text-caption text-grey"},X={key:0},Z={class:"sortable-header"},$={class:"sortable-header"},ee={class:"sortable-header"},te={class:"sortable-header justify-end"},oe={class:"sortable-header justify-end"},le={class:"sortable-header justify-end"},re={class:"sortable-header"},ae={class:"text-end"},se={class:"text-end"},ne={class:"text-end"},ie={key:0},de={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},ue={class:"text-caption text-grey"},pe={key:0},me={key:0},ce={key:1},_e={key:1},fe={class:"text-end"},ye={class:"text-end font-weight-medium"};function ve(r,e,v,d,l,p){const D=i("DatePicker"),b=i("v-col"),c=i("v-select"),V=i("v-row"),g=i("v-card-text"),h=i("v-card"),F=i("v-btn"),x=i("v-card-title"),m=i("v-icon"),P=i("v-skeleton-loader"),R=i("v-chip"),s=i("v-table"),U=i("PaginationControls");return f(),C("div",null,[t(h,{class:"mb-4"},{default:o(()=>[t(g,null,{default:o(()=>[t(V,null,{default:o(()=>[t(b,{cols:"12",md:"3"},{default:o(()=>[t(D,{modelValue:l.filters.date_from,"onUpdate:modelValue":[e[0]||(e[0]=y=>l.filters.date_from=y),p.onDateFromChange],label:"From Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(b,{cols:"12",md:"3"},{default:o(()=>[t(D,{modelValue:l.filters.date_to,"onUpdate:modelValue":[e[1]||(e[1]=y=>l.filters.date_to=y),p.onDateToChange],label:"To Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(b,{cols:"12",md:"3"},{default:o(()=>[t(c,{modelValue:l.filters.customer_id,"onUpdate:modelValue":[e[2]||(e[2]=y=>l.filters.customer_id=y),p.onFilterChange],items:l.customers,"item-value":"id","item-title":"name",label:"Customer",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),t(b,{cols:"12",md:"3"},{default:o(()=>[t(c,{modelValue:l.filters.status,"onUpdate:modelValue":[e[3]||(e[3]=y=>l.filters.status=y),p.onFilterChange],items:l.statusOptions,label:"Status",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l.summary?(f(),k(V,{key:0,class:"mb-4",dense:""},{default:o(()=>[t(b,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(h,{color:"primary",variant:"tonal",class:"summary-card"},{default:o(()=>[t(g,{class:"py-3"},{default:o(()=>[e[12]||(e[12]=a("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Sales",-1)),a("div",Y,u(p.formatCurrency(l.summary.total_sales)),1)]),_:1,__:[12]})]),_:1})]),_:1}),t(b,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(h,{color:"success",variant:"tonal",class:"summary-card"},{default:o(()=>[t(g,{class:"py-3"},{default:o(()=>[e[13]||(e[13]=a("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Paid",-1)),a("div",G,u(p.formatCurrency(l.summary.total_paid)),1)]),_:1,__:[13]})]),_:1})]),_:1}),t(b,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(h,{color:"warning",variant:"tonal",class:"summary-card"},{default:o(()=>[t(g,{class:"py-3"},{default:o(()=>[e[14]||(e[14]=a("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Due",-1)),a("div",Q,u(p.formatCurrency(l.summary.total_due)),1)]),_:1,__:[14]})]),_:1})]),_:1}),t(b,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(h,{color:"info",variant:"tonal",class:"summary-card"},{default:o(()=>[t(g,{class:"py-3"},{default:o(()=>[e[15]||(e[15]=a("div",{class:"text-caption text-grey-darken-1 mb-1"},"Total Invoices",-1)),a("div",W,u(l.summary.total_count||0),1)]),_:1,__:[15]})]),_:1})]),_:1})]),_:1})):S("",!0),t(h,null,{default:o(()=>[t(x,{class:"d-flex justify-space-between align-center"},{default:o(()=>[e[19]||(e[19]=a("span",null,"Sales Report",-1)),a("div",K,[t(F,{color:"success",size:"small","prepend-icon":"mdi-file-excel",onClick:p.exportExcel,disabled:l.loading||!l.reportData.length,loading:l.exporting},{default:o(()=>e[16]||(e[16]=[n(" Export Excel ")])),_:1,__:[16]},8,["onClick","disabled","loading"]),t(F,{color:"error",size:"small","prepend-icon":"mdi-file-pdf-box",onClick:p.exportPDF,disabled:l.loading||!l.reportData.length,loading:l.exporting},{default:o(()=>e[17]||(e[17]=[n(" Export PDF ")])),_:1,__:[17]},8,["onClick","disabled","loading"]),a("span",J,[e[18]||(e[18]=n(" Total Records: ")),a("strong",null,u(l.pagination.total||0),1),l.reportData.length>0?(f(),C("span",X," | Showing "+u((l.currentPage-1)*l.perPage+1)+" to "+u(Math.min(l.currentPage*l.perPage,l.pagination.total))+" of "+u(l.pagination.total),1)):S("",!0)])])]),_:1,__:[19]}),t(g,null,{default:o(()=>[t(s,null,{default:o(()=>[a("thead",null,[a("tr",null,[a("th",{class:"sortable",onClick:e[4]||(e[4]=y=>p.onSort("invoice_number"))},[a("div",Z,[e[21]||(e[21]=a("span",null,"Invoice #",-1)),r.sortBy==="invoice_number"?(f(),k(m,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[n(u(r.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),k(m,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>e[20]||(e[20]=[n(" mdi-unfold-more-horizontal ")])),_:1,__:[20]}))])]),a("th",{class:"sortable",onClick:e[5]||(e[5]=y=>p.onSort("invoice_date"))},[a("div",$,[e[23]||(e[23]=a("span",null,"Date",-1)),r.sortBy==="invoice_date"?(f(),k(m,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[n(u(r.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),k(m,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>e[22]||(e[22]=[n(" mdi-unfold-more-horizontal ")])),_:1,__:[22]}))])]),a("th",{class:"sortable",onClick:e[6]||(e[6]=y=>p.onSort("customer_name"))},[a("div",ee,[e[25]||(e[25]=a("span",null,"Customer",-1)),r.sortBy==="customer_name"?(f(),k(m,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[n(u(r.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),k(m,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>e[24]||(e[24]=[n(" mdi-unfold-more-horizontal ")])),_:1,__:[24]}))])]),a("th",{class:"text-end sortable",onClick:e[7]||(e[7]=y=>p.onSort("total_amount"))},[a("div",te,[e[27]||(e[27]=a("span",null,"Total",-1)),r.sortBy==="total_amount"?(f(),k(m,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[n(u(r.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),k(m,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>e[26]||(e[26]=[n(" mdi-unfold-more-horizontal ")])),_:1,__:[26]}))])]),a("th",{class:"text-end sortable",onClick:e[8]||(e[8]=y=>p.onSort("paid_amount"))},[a("div",oe,[e[29]||(e[29]=a("span",null,"Paid",-1)),r.sortBy==="paid_amount"?(f(),k(m,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[n(u(r.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),k(m,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>e[28]||(e[28]=[n(" mdi-unfold-more-horizontal ")])),_:1,__:[28]}))])]),a("th",{class:"text-end sortable",onClick:e[9]||(e[9]=y=>p.onSort("balance_amount"))},[a("div",le,[e[31]||(e[31]=a("span",null,"Due",-1)),r.sortBy==="balance_amount"?(f(),k(m,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[n(u(r.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),k(m,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>e[30]||(e[30]=[n(" mdi-unfold-more-horizontal ")])),_:1,__:[30]}))])]),a("th",{class:"sortable",onClick:e[10]||(e[10]=y=>p.onSort("status"))},[a("div",re,[e[33]||(e[33]=a("span",null,"Status",-1)),r.sortBy==="status"?(f(),k(m,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[n(u(r.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),k(m,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>e[32]||(e[32]=[n(" mdi-unfold-more-horizontal ")])),_:1,__:[32]}))])])])]),a("tbody",null,[l.loading?(f(),C(O,{key:0},L(5,y=>a("tr",{key:`skeleton-${y}`},[a("td",null,[t(P,{type:"text",width:"120"})]),a("td",null,[t(P,{type:"text",width:"100"})]),a("td",null,[t(P,{type:"text",width:"150"})]),a("td",null,[t(P,{type:"text",width:"80"})]),a("td",null,[t(P,{type:"text",width:"80"})]),a("td",null,[t(P,{type:"text",width:"80"})]),a("td",null,[t(P,{type:"chip",width:"80",height:"24"})])])),64)):(f(),C(O,{key:1},[(f(!0),C(O,null,L(l.reportData,y=>(f(),C("tr",{key:y.id||y.invoice_number},[a("td",null,u(y.invoice_number),1),a("td",null,u(r.formatDateDDMMYYYY(y.invoice_date)),1),a("td",null,u(y.customer_name),1),a("td",ae,u(p.formatCurrency(y.total_amount)),1),a("td",se,u(p.formatCurrency(y.paid_amount)),1),a("td",ne,[a("span",{class:A(y.balance_amount>0?"text-error font-weight-medium":"text-success")},u(p.formatCurrency(y.balance_amount)),3)]),a("td",null,[t(R,{color:p.getStatusColor(y.status),size:"small",variant:"flat"},{default:o(()=>[n(u(y.status),1)]),_:2},1032,["color"])])]))),128)),l.reportData.length===0?(f(),C("tr",ie,e[34]||(e[34]=[a("td",{colspan:"7",class:"text-center py-4"},"No sales data found",-1)]))):S("",!0)],64))])]),_:1}),a("div",de,[a("div",ue,[l.reportData.length>0&&l.pagination.total>0?(f(),C("span",pe,[l.perPage==="all"?(f(),C("span",me,[e[35]||(e[35]=n(" Showing ")),a("strong",null,"all "+u(l.pagination.total.toLocaleString()),1),e[36]||(e[36]=n(" records "))])):(f(),C("span",ce,[e[37]||(e[37]=n(" Showing ")),a("strong",null,u((l.currentPage-1)*l.perPage+1),1),e[38]||(e[38]=n(" to ")),a("strong",null,u(Math.min(l.currentPage*l.perPage,l.pagination.total)),1),e[39]||(e[39]=n(" of ")),a("strong",null,u(l.pagination.total.toLocaleString()),1),e[40]||(e[40]=n(" records "))]))])):(f(),C("span",_e,"No records found"))]),t(U,{modelValue:l.currentPage,"onUpdate:modelValue":e[11]||(e[11]=y=>l.currentPage=y),pagination:l.pagination,"per-page-value":l.perPage,"per-page-options":l.perPageOptions,"onUpdate:perPage":p.onPerPageUpdate,onPageChange:p.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1}),l.topProducts.length?(f(),k(h,{key:1,class:"mt-4"},{default:o(()=>[t(x,null,{default:o(()=>e[41]||(e[41]=[n("Top Selling Products")])),_:1,__:[41]}),t(g,null,{default:o(()=>[t(s,{density:"compact"},{default:o(()=>[e[42]||(e[42]=a("thead",null,[a("tr",null,[a("th",null,"Product"),a("th",{class:"text-end"},"Quantity Sold"),a("th",{class:"text-end"},"Total Revenue")])],-1)),a("tbody",null,[(f(!0),C(O,null,L(l.topProducts,y=>(f(),C("tr",{key:y.product_id},[a("td",null,u(y.product_name),1),a("td",fe,u(y.total_quantity),1),a("td",ye,u(p.formatCurrency(y.total_revenue)),1)]))),128))])]),_:1,__:[42]})]),_:1})]),_:1})):S("",!0)])}const ge=T(H,[["render",ve],["__scopeId","data-v-cff2710c"]]),xe={name:"PurchaseReports",components:{DatePicker:I},data(){return{loading:!1,filters:{date_from:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0],supplier_id:null,status:null},reportData:[],summary:null,suppliers:[],headers:[{title:"Invoice #",key:"invoice_number"},{title:"Date",key:"invoice_date"},{title:"Supplier",key:"supplier_name"},{title:"Total",key:"total_amount",align:"end"},{title:"Paid",key:"paid_amount",align:"end"},{title:"Due",key:"balance_amount",align:"end"},{title:"Status",key:"status"}],statusOptions:[{title:"Draft",value:"draft"},{title:"Pending",value:"pending"},{title:"Partial",value:"partial"},{title:"Paid",value:"paid"},{title:"Cancelled",value:"cancelled"}]}},mounted(){this.fetchSuppliers(),this.generateReport()},methods:{async fetchSuppliers(){try{const{data:r}=await w.get("/api/v1/suppliers");this.suppliers=r.data||r.suppliers||[]}catch(r){console.error("Failed to fetch suppliers",r)}},async generateReport(){var r;this.loading=!0;try{const{data:e}=await w.get("/api/v1/reports/purchases",{params:this.filters});this.reportData=e.purchases||[],this.summary=e.summary||null}catch(e){console.error("Failed to generate report",e),(r=this.$toast)==null||r.error("Failed to generate purchase report")}finally{this.loading=!1}},async exportExcel(){var r;try{const e=await w.get("/api/v1/reports/purchases/export/excel",{params:this.filters,responseType:"blob"}),v=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=v,d.setAttribute("download",`purchase_report_${Date.now()}.xlsx`),document.body.appendChild(d),d.click(),d.remove()}catch(e){console.error("Failed to export Excel",e),(r=this.$toast)==null||r.error("Failed to export report")}},async exportPDF(){var r;try{const e=await w.get("/api/v1/reports/purchases/export/pdf",{params:this.filters,responseType:"blob"}),v=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=v,d.setAttribute("download",`purchase_report_${Date.now()}.pdf`),document.body.appendChild(d),d.click(),d.remove()}catch(e){console.error("Failed to export PDF",e),(r=this.$toast)==null||r.error("Failed to export report")}},formatDate(r){return r?new Date(r).toLocaleDateString():""},getStatusColor(r){return{draft:"grey",pending:"warning",partial:"info",paid:"success",cancelled:"error"}[r]||"grey"},onDateFromChange(r){this.filters.date_from=r||"",this.generateReport()},onDateToChange(r){this.filters.date_to=r||"",this.generateReport()}}},be={class:"text-h5"},he={class:"text-h5"},ke={class:"text-h5"},we={class:"text-h5"};function De(r,e,v,d,l,p){const D=i("v-card-title"),b=i("DatePicker"),c=i("v-col"),V=i("v-select"),g=i("v-icon"),h=i("v-btn"),F=i("v-row"),x=i("v-card-text"),m=i("v-card"),P=i("v-chip"),R=i("v-data-table");return f(),C("div",null,[t(m,{variant:"outlined",class:"mb-4"},{default:o(()=>[t(D,null,{default:o(()=>e[4]||(e[4]=[n("Purchase Report Filters")])),_:1,__:[4]}),t(x,null,{default:o(()=>[t(F,{dense:""},{default:o(()=>[t(c,{cols:"12",md:"3"},{default:o(()=>[t(b,{modelValue:l.filters.date_from,"onUpdate:modelValue":[e[0]||(e[0]=s=>l.filters.date_from=s),p.onDateFromChange],label:"From Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(c,{cols:"12",md:"3"},{default:o(()=>[t(b,{modelValue:l.filters.date_to,"onUpdate:modelValue":[e[1]||(e[1]=s=>l.filters.date_to=s),p.onDateToChange],label:"To Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(c,{cols:"12",md:"3"},{default:o(()=>[t(V,{modelValue:l.filters.supplier_id,"onUpdate:modelValue":e[2]||(e[2]=s=>l.filters.supplier_id=s),items:l.suppliers,"item-value":"id","item-title":"name",label:"Supplier",clearable:""},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",md:"3"},{default:o(()=>[t(V,{modelValue:l.filters.status,"onUpdate:modelValue":e[3]||(e[3]=s=>l.filters.status=s),items:l.statusOptions,label:"Status",clearable:""},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",class:"d-flex gap-2"},{default:o(()=>[t(h,{color:"primary",onClick:p.generateReport,loading:l.loading},{default:o(()=>[t(g,null,{default:o(()=>e[5]||(e[5]=[n("mdi-chart-line")])),_:1,__:[5]}),e[6]||(e[6]=n(" Generate Report "))]),_:1,__:[6]},8,["onClick","loading"]),t(h,{color:"success",onClick:p.exportExcel,disabled:!l.reportData.length},{default:o(()=>[t(g,null,{default:o(()=>e[7]||(e[7]=[n("mdi-file-excel")])),_:1,__:[7]}),e[8]||(e[8]=n(" Export Excel "))]),_:1,__:[8]},8,["onClick","disabled"]),t(h,{color:"error",onClick:p.exportPDF,disabled:!l.reportData.length},{default:o(()=>[t(g,null,{default:o(()=>e[9]||(e[9]=[n("mdi-file-pdf-box")])),_:1,__:[9]}),e[10]||(e[10]=n(" Export PDF "))]),_:1,__:[10]},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),l.summary?(f(),k(F,{key:0,class:"mb-4"},{default:o(()=>[t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"primary",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>{var s;return[e[11]||(e[11]=a("div",{class:"text-caption"},"Total Purchases",-1)),a("div",be,"$"+u(((s=l.summary.total_purchases)==null?void 0:s.toFixed(2))||0),1)]}),_:1,__:[11]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"success",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>{var s;return[e[12]||(e[12]=a("div",{class:"text-caption"},"Total Paid",-1)),a("div",he,"$"+u(((s=l.summary.total_paid)==null?void 0:s.toFixed(2))||0),1)]}),_:1,__:[12]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"warning",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>{var s;return[e[13]||(e[13]=a("div",{class:"text-caption"},"Total Due",-1)),a("div",ke,"$"+u(((s=l.summary.total_due)==null?void 0:s.toFixed(2))||0),1)]}),_:1,__:[13]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"info",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>[e[14]||(e[14]=a("div",{class:"text-caption"},"Total Orders",-1)),a("div",we,u(l.summary.total_count||0),1)]),_:1,__:[14]})]),_:1})]),_:1})]),_:1})):S("",!0),t(m,{variant:"outlined"},{default:o(()=>[t(R,{headers:l.headers,items:l.reportData,loading:l.loading,"items-per-page":25},{"item.invoice_date":o(({item:s})=>[n(u(p.formatDate(s.invoice_date)),1)]),"item.total_amount":o(({item:s})=>[n(" $"+u(parseFloat(s.total_amount).toFixed(2)),1)]),"item.paid_amount":o(({item:s})=>[n(" $"+u(parseFloat(s.paid_amount).toFixed(2)),1)]),"item.balance_amount":o(({item:s})=>[a("span",{class:A(s.balance_amount>0?"text-error":"text-success")}," $"+u(parseFloat(s.balance_amount).toFixed(2)),3)]),"item.status":o(({item:s})=>[t(P,{color:p.getStatusColor(s.status),size:"small"},{default:o(()=>[n(u(s.status),1)]),_:2},1032,["color"])]),_:1},8,["headers","items","loading"])]),_:1})])}const Pe=T(xe,[["render",De]]),Ce={name:"StockReports",data(){return{loading:!1,filters:{warehouse_id:null,category_id:null,report_type:"current",low_stock_only:!1},reportData:[],summary:null,warehouses:[],categories:[],headers:[{title:"Product",key:"product_name"},{title:"SKU",key:"sku"},{title:"Category",key:"category_name"},{title:"Warehouse",key:"warehouse_name"},{title:"Quantity",key:"quantity",align:"center"},{title:"Min Level",key:"minimum_stock_level",align:"center"},{title:"Stock Value",key:"stock_value",align:"end"},{title:"Status",key:"status"}],reportTypes:[{title:"Current Stock",value:"current"},{title:"Stock Ledger",value:"ledger"},{title:"Low Stock",value:"low_stock"}]}},mounted(){this.fetchOptions(),this.generateReport()},methods:{async fetchOptions(){try{const[r,e]=await Promise.all([w.get("/api/v1/warehouses"),w.get("/api/v1/categories")]);this.warehouses=r.data.data||r.data.warehouses||[],this.categories=e.data.data||e.data.categories||[]}catch(r){console.error("Failed to fetch options",r)}},async generateReport(){var r;this.loading=!0;try{const{data:e}=await w.get("/api/v1/reports/stock",{params:this.filters});this.reportData=e.stock||[],this.summary=e.summary||null}catch(e){console.error("Failed to generate report",e),(r=this.$toast)==null||r.error("Failed to generate stock report")}finally{this.loading=!1}},async exportExcel(){var r;try{const e=await w.get("/api/v1/reports/stock/export/excel",{params:this.filters,responseType:"blob"}),v=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=v,d.setAttribute("download",`stock_report_${Date.now()}.xlsx`),document.body.appendChild(d),d.click(),d.remove()}catch(e){console.error("Failed to export Excel",e),(r=this.$toast)==null||r.error("Failed to export report")}},async exportPDF(){var r;try{const e=await w.get("/api/v1/reports/stock/export/pdf",{params:this.filters,responseType:"blob"}),v=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=v,d.setAttribute("download",`stock_report_${Date.now()}.pdf`),document.body.appendChild(d),d.click(),d.remove()}catch(e){console.error("Failed to export PDF",e),(r=this.$toast)==null||r.error("Failed to export report")}},getStockColor(r){return!r.quantity||r.quantity===0?"error":r.quantity<=r.minimum_stock_level?"warning":"success"},getStockStatus(r){return!r.quantity||r.quantity===0?"Out of Stock":r.quantity<=r.minimum_stock_level?"Low Stock":"In Stock"}}},Fe={class:"text-h5"},Ve={class:"text-h5"},Re={class:"text-h5"},Se={class:"text-h5"};function Ue(r,e,v,d,l,p){const D=i("v-card-title"),b=i("v-select"),c=i("v-col"),V=i("v-switch"),g=i("v-icon"),h=i("v-btn"),F=i("v-row"),x=i("v-card-text"),m=i("v-card"),P=i("v-chip"),R=i("v-data-table");return f(),C("div",null,[t(m,{variant:"outlined",class:"mb-4"},{default:o(()=>[t(D,null,{default:o(()=>e[4]||(e[4]=[n("Stock Report Filters")])),_:1,__:[4]}),t(x,null,{default:o(()=>[t(F,{dense:""},{default:o(()=>[t(c,{cols:"12",md:"3"},{default:o(()=>[t(b,{modelValue:l.filters.warehouse_id,"onUpdate:modelValue":e[0]||(e[0]=s=>l.filters.warehouse_id=s),items:l.warehouses,"item-value":"id","item-title":"name",label:"Warehouse",clearable:""},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",md:"3"},{default:o(()=>[t(b,{modelValue:l.filters.category_id,"onUpdate:modelValue":e[1]||(e[1]=s=>l.filters.category_id=s),items:l.categories,"item-value":"id","item-title":"name",label:"Category",clearable:""},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",md:"3"},{default:o(()=>[t(b,{modelValue:l.filters.report_type,"onUpdate:modelValue":e[2]||(e[2]=s=>l.filters.report_type=s),items:l.reportTypes,label:"Report Type"},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",md:"3"},{default:o(()=>[t(V,{modelValue:l.filters.low_stock_only,"onUpdate:modelValue":e[3]||(e[3]=s=>l.filters.low_stock_only=s),label:"Low Stock Only"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12",class:"d-flex gap-2"},{default:o(()=>[t(h,{color:"primary",onClick:p.generateReport,loading:l.loading},{default:o(()=>[t(g,null,{default:o(()=>e[5]||(e[5]=[n("mdi-chart-line")])),_:1,__:[5]}),e[6]||(e[6]=n(" Generate Report "))]),_:1,__:[6]},8,["onClick","loading"]),t(h,{color:"success",onClick:p.exportExcel,disabled:!l.reportData.length},{default:o(()=>[t(g,null,{default:o(()=>e[7]||(e[7]=[n("mdi-file-excel")])),_:1,__:[7]}),e[8]||(e[8]=n(" Export Excel "))]),_:1,__:[8]},8,["onClick","disabled"]),t(h,{color:"error",onClick:p.exportPDF,disabled:!l.reportData.length},{default:o(()=>[t(g,null,{default:o(()=>e[9]||(e[9]=[n("mdi-file-pdf-box")])),_:1,__:[9]}),e[10]||(e[10]=n(" Export PDF "))]),_:1,__:[10]},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),l.summary?(f(),k(F,{key:0,class:"mb-4"},{default:o(()=>[t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"primary",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>[e[11]||(e[11]=a("div",{class:"text-caption"},"Total Products",-1)),a("div",Fe,u(l.summary.total_products||0),1)]),_:1,__:[11]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"success",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>{var s;return[e[12]||(e[12]=a("div",{class:"text-caption"},"Total Stock Value",-1)),a("div",Ve,"$"+u(((s=l.summary.total_stock_value)==null?void 0:s.toFixed(2))||0),1)]}),_:1,__:[12]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"warning",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>[e[13]||(e[13]=a("div",{class:"text-caption"},"Low Stock Items",-1)),a("div",Re,u(l.summary.low_stock_count||0),1)]),_:1,__:[13]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"error",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>[e[14]||(e[14]=a("div",{class:"text-caption"},"Out of Stock",-1)),a("div",Se,u(l.summary.out_of_stock_count||0),1)]),_:1,__:[14]})]),_:1})]),_:1})]),_:1})):S("",!0),t(m,{variant:"outlined"},{default:o(()=>[t(R,{headers:l.headers,items:l.reportData,loading:l.loading,"items-per-page":25},{"item.quantity":o(({item:s})=>[t(P,{color:p.getStockColor(s),size:"small"},{default:o(()=>[n(u(s.quantity||0),1)]),_:2},1032,["color"])]),"item.minimum_stock_level":o(({item:s})=>[n(u(s.minimum_stock_level||0),1)]),"item.stock_value":o(({item:s})=>[n(" $"+u((s.quantity*s.purchase_price).toFixed(2)),1)]),"item.status":o(({item:s})=>[t(P,{color:p.getStockColor(s),size:"small"},{default:o(()=>[n(u(p.getStockStatus(s)),1)]),_:2},1032,["color"])]),_:1},8,["headers","items","loading"])]),_:1})])}const Te=T(Ce,[["render",Ue]]),Ee={name:"DueReports",data(){return{loading:!1,saving:!1,filters:{party_type:"customer",party_id:null,overdue_only:!1},reportData:[],summary:null,customers:[],suppliers:[],paymentDialog:!1,selectedItem:null,paymentAmount:0,paymentMethod:"cash",paymentDate:new Date().toISOString().split("T")[0],paymentNotes:"",partyTypes:[{title:"Customer Due",value:"customer"},{title:"Supplier Due",value:"supplier"}],customerHeaders:[{title:"Customer",key:"party_name"},{title:"Invoice #",key:"invoice_number"},{title:"Date",key:"invoice_date"},{title:"Due Date",key:"due_date"},{title:"Total",key:"total_amount",align:"end"},{title:"Paid",key:"paid_amount",align:"end"},{title:"Due",key:"due_amount",align:"end"},{title:"Actions",key:"actions",sortable:!1}],supplierHeaders:[{title:"Supplier",key:"party_name"},{title:"Invoice #",key:"invoice_number"},{title:"Date",key:"invoice_date"},{title:"Due Date",key:"due_date"},{title:"Total",key:"total_amount",align:"end"},{title:"Paid",key:"paid_amount",align:"end"},{title:"Due",key:"due_amount",align:"end"},{title:"Actions",key:"actions",sortable:!1}],paymentMethods:[{title:"Cash",value:"cash"},{title:"Card",value:"card"},{title:"Mobile Banking",value:"mobile_banking"},{title:"Bank Transfer",value:"bank_transfer"},{title:"Cheque",value:"cheque"}],rules:{required:r=>!!r||"Required",maxDue:r=>{var v,d;const e=parseFloat(((v=this.selectedItem)==null?void 0:v.due_amount)||((d=this.selectedItem)==null?void 0:d.balance_amount)||0);return r<=e||`Cannot exceed due amount ($${e.toFixed(2)})`}}}},computed:{partyOptions(){return this.filters.party_type==="customer"?this.customers:this.suppliers},currentHeaders(){return this.filters.party_type==="customer"?this.customerHeaders:this.supplierHeaders}},watch:{"filters.party_type"(){this.filters.party_id=null,this.generateReport()}},mounted(){this.fetchParties(),this.generateReport()},methods:{async fetchParties(){try{const[r,e]=await Promise.all([w.get("/api/v1/customers"),w.get("/api/v1/suppliers")]);this.customers=r.data.data||r.data.customers||[],this.suppliers=e.data.data||e.data.suppliers||[]}catch(r){console.error("Failed to fetch parties",r)}},async generateReport(){var r;this.loading=!0;try{const{data:e}=await w.get("/api/v1/reports/due",{params:this.filters});this.reportData=e.due||[],this.summary=e.summary||null}catch(e){console.error("Failed to generate report",e),(r=this.$toast)==null||r.error("Failed to generate due report")}finally{this.loading=!1}},async exportExcel(){var r;try{const e=await w.get("/api/v1/reports/due/export/excel",{params:this.filters,responseType:"blob"}),v=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=v,d.setAttribute("download",`due_report_${Date.now()}.xlsx`),document.body.appendChild(d),d.click(),d.remove()}catch(e){console.error("Failed to export Excel",e),(r=this.$toast)==null||r.error("Failed to export report")}},async exportPDF(){var r;try{const e=await w.get("/api/v1/reports/due/export/pdf",{params:this.filters,responseType:"blob"}),v=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=v,d.setAttribute("download",`due_report_${Date.now()}.pdf`),document.body.appendChild(d),d.click(),d.remove()}catch(e){console.error("Failed to export PDF",e),(r=this.$toast)==null||r.error("Failed to export report")}},collectPayment(r){this.selectedItem=r,this.paymentAmount=parseFloat(r.due_amount||r.balance_amount),this.paymentDialog=!0},async savePayment(){var e,v;if((await this.$refs.paymentForm.validate()).valid){this.saving=!0;try{await w.post("/api/v1/payments",{payment_type:this.filters.party_type==="customer"?"sale":"purchase",party_type:this.filters.party_type,party_id:this.selectedItem.party_id||this.selectedItem.customer_id||this.selectedItem.supplier_id,reference_type:this.filters.party_type==="customer"?"sale":"purchase",reference_id:this.selectedItem.id,reference_number:this.selectedItem.invoice_number,payment_date:this.paymentDate,amount:this.paymentAmount,payment_method:this.paymentMethod,notes:this.paymentNotes}),(e=this.$toast)==null||e.success("Payment recorded successfully"),this.paymentDialog=!1,this.generateReport()}catch(d){console.error("Failed to save payment",d),(v=this.$toast)==null||v.error("Failed to record payment")}finally{this.saving=!1}}},formatDate(r){return r?new Date(r).toLocaleDateString():""},isOverdue(r){return r?new Date(r)<new Date:!1}}},Oe={class:"text-h5"},ze={class:"text-h5"},Le={class:"text-h5"};function Ie(r,e,v,d,l,p){const D=i("v-card-title"),b=i("v-select"),c=i("v-col"),V=i("v-switch"),g=i("v-icon"),h=i("v-btn"),F=i("v-row"),x=i("v-card-text"),m=i("v-card"),P=i("v-chip"),R=i("v-data-table"),s=i("v-text-field"),U=i("v-textarea"),y=i("v-form"),B=i("v-spacer"),M=i("v-card-actions"),q=i("v-dialog");return f(),C("div",null,[t(m,{variant:"outlined",class:"mb-4"},{default:o(()=>[t(D,null,{default:o(()=>e[11]||(e[11]=[n("Due Report Filters")])),_:1,__:[11]}),t(x,null,{default:o(()=>[t(F,{dense:""},{default:o(()=>[t(c,{cols:"12",md:"4"},{default:o(()=>[t(b,{modelValue:l.filters.party_type,"onUpdate:modelValue":e[0]||(e[0]=_=>l.filters.party_type=_),items:l.partyTypes,label:"Party Type"},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",md:"4"},{default:o(()=>[t(b,{modelValue:l.filters.party_id,"onUpdate:modelValue":e[1]||(e[1]=_=>l.filters.party_id=_),items:p.partyOptions,"item-value":"id","item-title":"name",label:"Select Party",clearable:""},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",md:"4"},{default:o(()=>[t(V,{modelValue:l.filters.overdue_only,"onUpdate:modelValue":e[2]||(e[2]=_=>l.filters.overdue_only=_),label:"Overdue Only"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12",class:"d-flex gap-2"},{default:o(()=>[t(h,{color:"primary",onClick:p.generateReport,loading:l.loading},{default:o(()=>[t(g,null,{default:o(()=>e[12]||(e[12]=[n("mdi-chart-line")])),_:1,__:[12]}),e[13]||(e[13]=n(" Generate Report "))]),_:1,__:[13]},8,["onClick","loading"]),t(h,{color:"success",onClick:p.exportExcel,disabled:!l.reportData.length},{default:o(()=>[t(g,null,{default:o(()=>e[14]||(e[14]=[n("mdi-file-excel")])),_:1,__:[14]}),e[15]||(e[15]=n(" Export Excel "))]),_:1,__:[15]},8,["onClick","disabled"]),t(h,{color:"error",onClick:p.exportPDF,disabled:!l.reportData.length},{default:o(()=>[t(g,null,{default:o(()=>e[16]||(e[16]=[n("mdi-file-pdf-box")])),_:1,__:[16]}),e[17]||(e[17]=n(" Export PDF "))]),_:1,__:[17]},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),l.summary?(f(),k(F,{key:0,class:"mb-4"},{default:o(()=>[t(c,{cols:"12",sm:"4"},{default:o(()=>[t(m,{color:"error",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>{var _;return[e[18]||(e[18]=a("div",{class:"text-caption"},"Total Due Amount",-1)),a("div",Oe,"$"+u(((_=l.summary.total_due)==null?void 0:_.toFixed(2))||0),1)]}),_:1,__:[18]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"4"},{default:o(()=>[t(m,{color:"warning",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>{var _;return[e[19]||(e[19]=a("div",{class:"text-caption"},"Overdue Amount",-1)),a("div",ze,"$"+u(((_=l.summary.overdue_amount)==null?void 0:_.toFixed(2))||0),1)]}),_:1,__:[19]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"4"},{default:o(()=>[t(m,{color:"info",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>[e[20]||(e[20]=a("div",{class:"text-caption"},"Total Parties",-1)),a("div",Le,u(l.summary.total_parties||0),1)]),_:1,__:[20]})]),_:1})]),_:1})]),_:1})):S("",!0),t(m,{variant:"outlined"},{default:o(()=>[t(R,{headers:p.currentHeaders,items:l.reportData,loading:l.loading,"items-per-page":25},{"item.total_amount":o(({item:_})=>[n(" $"+u(parseFloat(_.total_amount||0).toFixed(2)),1)]),"item.paid_amount":o(({item:_})=>[n(" $"+u(parseFloat(_.paid_amount||0).toFixed(2)),1)]),"item.due_amount":o(({item:_})=>[t(P,{color:"error",size:"small"},{default:o(()=>[n(" $"+u(parseFloat(_.due_amount||_.balance_amount||0).toFixed(2)),1)]),_:2},1024)]),"item.due_date":o(({item:_})=>[a("span",{class:A(p.isOverdue(_.due_date)?"text-error font-weight-bold":"")},u(p.formatDate(_.due_date)),3)]),"item.invoice_date":o(({item:_})=>[n(u(p.formatDate(_.invoice_date)),1)]),"item.actions":o(({item:_})=>[t(h,{size:"small",color:"success",onClick:$e=>p.collectPayment(_)},{default:o(()=>[t(g,null,{default:o(()=>e[21]||(e[21]=[n("mdi-cash")])),_:1,__:[21]}),e[22]||(e[22]=n(" Collect "))]),_:2,__:[22]},1032,["onClick"])]),_:1},8,["headers","items","loading"])]),_:1}),t(q,{modelValue:l.paymentDialog,"onUpdate:modelValue":e[10]||(e[10]=_=>l.paymentDialog=_),"max-width":"500px"},{default:o(()=>[l.selectedItem?(f(),k(m,{key:0},{default:o(()=>[t(D,null,{default:o(()=>e[23]||(e[23]=[n("Collect Payment")])),_:1,__:[23]}),t(x,null,{default:o(()=>[t(y,{ref:"paymentForm"},{default:o(()=>[t(s,{modelValue:l.selectedItem.party_name,"onUpdate:modelValue":e[3]||(e[3]=_=>l.selectedItem.party_name=_),label:"Party",readonly:""},null,8,["modelValue"]),t(s,{modelValue:l.selectedItem.invoice_number,"onUpdate:modelValue":e[4]||(e[4]=_=>l.selectedItem.invoice_number=_),label:"Invoice",readonly:""},null,8,["modelValue"]),t(s,{"model-value":parseFloat(l.selectedItem.due_amount||l.selectedItem.balance_amount).toFixed(2),label:"Due Amount",readonly:""},null,8,["model-value"]),t(s,{modelValue:l.paymentAmount,"onUpdate:modelValue":e[5]||(e[5]=_=>l.paymentAmount=_),modelModifiers:{number:!0},type:"number",label:"Payment Amount *",rules:[l.rules.required,l.rules.maxDue]},null,8,["modelValue","rules"]),t(b,{modelValue:l.paymentMethod,"onUpdate:modelValue":e[6]||(e[6]=_=>l.paymentMethod=_),items:l.paymentMethods,label:"Payment Method *",rules:[l.rules.required]},null,8,["modelValue","items","rules"]),t(s,{modelValue:l.paymentDate,"onUpdate:modelValue":e[7]||(e[7]=_=>l.paymentDate=_),type:"date",label:"Payment Date *",rules:[l.rules.required]},null,8,["modelValue","rules"]),t(U,{modelValue:l.paymentNotes,"onUpdate:modelValue":e[8]||(e[8]=_=>l.paymentNotes=_),label:"Notes",rows:"2"},null,8,["modelValue"])]),_:1},512)]),_:1}),t(M,null,{default:o(()=>[t(B),t(h,{onClick:e[9]||(e[9]=_=>l.paymentDialog=!1)},{default:o(()=>e[24]||(e[24]=[n("Cancel")])),_:1,__:[24]}),t(h,{color:"success",loading:l.saving,onClick:p.savePayment},{default:o(()=>e[25]||(e[25]=[n("Save Payment")])),_:1,__:[25]},8,["loading","onClick"])]),_:1})]),_:1})):S("",!0)]),_:1},8,["modelValue"])])}const Ae=T(Ee,[["render",Ie]]),Be={name:"ProfitReports",components:{DatePicker:I},data(){return{loading:!1,filters:{date_from:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0],category_id:null,group_by:"daily"},reportData:[],chartData:[],summary:null,categories:[],headers:[{title:"Period",key:"period"},{title:"Product/Category",key:"name"},{title:"Qty Sold",key:"quantity_sold",align:"center"},{title:"Revenue",key:"revenue",align:"end"},{title:"Cost",key:"cost",align:"end"},{title:"Discount",key:"discount",align:"end"},{title:"Profit",key:"profit",align:"end"},{title:"Margin %",key:"profit_margin",align:"end"}],groupByOptions:[{title:"Daily",value:"daily"},{title:"Weekly",value:"weekly"},{title:"Monthly",value:"monthly"},{title:"By Product",value:"product"},{title:"By Category",value:"category"}]}},mounted(){this.fetchCategories(),this.generateReport()},methods:{async fetchCategories(){try{const{data:r}=await w.get("/api/v1/categories");this.categories=r.data||r.categories||[]}catch(r){console.error("Failed to fetch categories",r)}},async generateReport(){var r;this.loading=!0;try{const{data:e}=await w.get("/api/v1/reports/profit",{params:this.filters});this.reportData=e.profit||[],this.chartData=e.chart||[],this.summary=e.summary||null}catch(e){console.error("Failed to generate report",e),(r=this.$toast)==null||r.error("Failed to generate profit report")}finally{this.loading=!1}},async exportExcel(){var r;try{const e=await w.get("/api/v1/reports/profit/export/excel",{params:this.filters,responseType:"blob"}),v=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=v,d.setAttribute("download",`profit_report_${Date.now()}.xlsx`),document.body.appendChild(d),d.click(),d.remove()}catch(e){console.error("Failed to export Excel",e),(r=this.$toast)==null||r.error("Failed to export report")}},async exportPDF(){var r;try{const e=await w.get("/api/v1/reports/profit/export/pdf",{params:this.filters,responseType:"blob"}),v=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=v,d.setAttribute("download",`profit_report_${Date.now()}.pdf`),document.body.appendChild(d),d.click(),d.remove()}catch(e){console.error("Failed to export PDF",e),(r=this.$toast)==null||r.error("Failed to export report")}},onDateFromChange(r){this.filters.date_from=r||"",this.generateReport()},onDateToChange(r){this.filters.date_to=r||"",this.generateReport()}}},Me={class:"text-h5"},qe={class:"text-h5"},je={class:"text-h5"},Ne={class:"text-h5"};function He(r,e,v,d,l,p){const D=i("v-card-title"),b=i("DatePicker"),c=i("v-col"),V=i("v-select"),g=i("v-icon"),h=i("v-btn"),F=i("v-row"),x=i("v-card-text"),m=i("v-card"),P=i("v-chip"),R=i("v-data-table");return f(),C("div",null,[t(m,{variant:"outlined",class:"mb-4"},{default:o(()=>[t(D,null,{default:o(()=>e[4]||(e[4]=[n("Profit Report Filters")])),_:1,__:[4]}),t(x,null,{default:o(()=>[t(F,{dense:""},{default:o(()=>[t(c,{cols:"12",md:"3"},{default:o(()=>[t(b,{modelValue:l.filters.date_from,"onUpdate:modelValue":[e[0]||(e[0]=s=>l.filters.date_from=s),p.onDateFromChange],label:"From Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(c,{cols:"12",md:"3"},{default:o(()=>[t(b,{modelValue:l.filters.date_to,"onUpdate:modelValue":[e[1]||(e[1]=s=>l.filters.date_to=s),p.onDateToChange],label:"To Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(c,{cols:"12",md:"3"},{default:o(()=>[t(V,{modelValue:l.filters.category_id,"onUpdate:modelValue":e[2]||(e[2]=s=>l.filters.category_id=s),items:l.categories,"item-value":"id","item-title":"name",label:"Category",clearable:""},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",md:"3"},{default:o(()=>[t(V,{modelValue:l.filters.group_by,"onUpdate:modelValue":e[3]||(e[3]=s=>l.filters.group_by=s),items:l.groupByOptions,label:"Group By"},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",class:"d-flex gap-2"},{default:o(()=>[t(h,{color:"primary",onClick:p.generateReport,loading:l.loading},{default:o(()=>[t(g,null,{default:o(()=>e[5]||(e[5]=[n("mdi-chart-line")])),_:1,__:[5]}),e[6]||(e[6]=n(" Generate Report "))]),_:1,__:[6]},8,["onClick","loading"]),t(h,{color:"success",onClick:p.exportExcel,disabled:!l.reportData.length},{default:o(()=>[t(g,null,{default:o(()=>e[7]||(e[7]=[n("mdi-file-excel")])),_:1,__:[7]}),e[8]||(e[8]=n(" Export Excel "))]),_:1,__:[8]},8,["onClick","disabled"]),t(h,{color:"error",onClick:p.exportPDF,disabled:!l.reportData.length},{default:o(()=>[t(g,null,{default:o(()=>e[9]||(e[9]=[n("mdi-file-pdf-box")])),_:1,__:[9]}),e[10]||(e[10]=n(" Export PDF "))]),_:1,__:[10]},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),l.summary?(f(),k(F,{key:0,class:"mb-4"},{default:o(()=>[t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"primary",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>{var s;return[e[11]||(e[11]=a("div",{class:"text-caption"},"Total Revenue",-1)),a("div",Me,"$"+u(((s=l.summary.total_revenue)==null?void 0:s.toFixed(2))||0),1)]}),_:1,__:[11]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"warning",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>{var s;return[e[12]||(e[12]=a("div",{class:"text-caption"},"Total Cost",-1)),a("div",qe,"$"+u(((s=l.summary.total_cost)==null?void 0:s.toFixed(2))||0),1)]}),_:1,__:[12]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"success",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>{var s;return[e[13]||(e[13]=a("div",{class:"text-caption"},"Gross Profit",-1)),a("div",je,"$"+u(((s=l.summary.gross_profit)==null?void 0:s.toFixed(2))||0),1)]}),_:1,__:[13]})]),_:1})]),_:1}),t(c,{cols:"12",sm:"3"},{default:o(()=>[t(m,{color:"info",variant:"tonal"},{default:o(()=>[t(x,null,{default:o(()=>{var s;return[e[14]||(e[14]=a("div",{class:"text-caption"},"Profit Margin",-1)),a("div",Ne,u(((s=l.summary.profit_margin)==null?void 0:s.toFixed(2))||0)+"%",1)]}),_:1,__:[14]})]),_:1})]),_:1})]),_:1})):S("",!0),t(m,{variant:"outlined"},{default:o(()=>[t(R,{headers:l.headers,items:l.reportData,loading:l.loading,"items-per-page":25},{"item.revenue":o(({item:s})=>[n(" $"+u(parseFloat(s.revenue||0).toFixed(2)),1)]),"item.cost":o(({item:s})=>[n(" $"+u(parseFloat(s.cost||0).toFixed(2)),1)]),"item.discount":o(({item:s})=>[n(" $"+u(parseFloat(s.discount||0).toFixed(2)),1)]),"item.profit":o(({item:s})=>[t(P,{color:s.profit>=0?"success":"error",size:"small"},{default:o(()=>[n(" $"+u(parseFloat(s.profit||0).toFixed(2)),1)]),_:2},1032,["color"])]),"item.profit_margin":o(({item:s})=>[n(u(parseFloat(s.profit_margin||0).toFixed(2))+"% ",1)]),_:1},8,["headers","items","loading"])]),_:1}),l.chartData.length?(f(),k(m,{key:1,variant:"outlined",class:"mt-4"},{default:o(()=>[t(D,null,{default:o(()=>e[15]||(e[15]=[n("Profit Trend")])),_:1,__:[15]}),t(x,null,{default:o(()=>e[16]||(e[16]=[a("div",{class:"text-center text-caption"}," Chart visualization would go here (integrate with Chart.js or similar) ",-1)])),_:1,__:[16]})]),_:1})):S("",!0)])}const Ye=T(Be,[["render",He]]),Ge={name:"AdminReports",components:{SalesReports:ge,PurchaseReports:Pe,StockReports:Te,DueReports:Ae,ProfitReports:Ye},data(){return{activeTab:"sales"}}},Qe={class:"pa-4"},We={class:"pa-4"},Ke={class:"pa-4"},Je={class:"pa-4"},Xe={class:"pa-4"};function Ze(r,e,v,d,l,p){const D=i("v-icon"),b=i("v-tab"),c=i("v-tabs"),V=i("SalesReports"),g=i("v-window-item"),h=i("PurchaseReports"),F=i("StockReports"),x=i("DueReports"),m=i("ProfitReports"),P=i("v-window"),R=i("v-card-text"),s=i("v-card");return f(),C("div",null,[e[12]||(e[12]=a("div",{class:"page-header"},[a("h1",{class:"text-h4 page-title"},"Reports & Analytics")],-1)),t(s,null,{default:o(()=>[t(R,{class:"pa-0"},{default:o(()=>[t(c,{modelValue:l.activeTab,"onUpdate:modelValue":e[0]||(e[0]=U=>l.activeTab=U),"bg-color":"grey-lighten-5",color:"primary","slider-color":"primary",class:"reports-tabs"},{default:o(()=>[t(b,{value:"sales"},{default:o(()=>[t(D,{start:"",size:"small"},{default:o(()=>e[2]||(e[2]=[n("mdi-cash-register")])),_:1,__:[2]}),e[3]||(e[3]=a("span",null,"Sales Reports",-1))]),_:1,__:[3]}),t(b,{value:"purchase"},{default:o(()=>[t(D,{start:"",size:"small"},{default:o(()=>e[4]||(e[4]=[n("mdi-cart-arrow-down")])),_:1,__:[4]}),e[5]||(e[5]=a("span",null,"Purchase Reports",-1))]),_:1,__:[5]}),t(b,{value:"stock"},{default:o(()=>[t(D,{start:"",size:"small"},{default:o(()=>e[6]||(e[6]=[n("mdi-package-variant")])),_:1,__:[6]}),e[7]||(e[7]=a("span",null,"Stock Reports",-1))]),_:1,__:[7]}),t(b,{value:"due"},{default:o(()=>[t(D,{start:"",size:"small"},{default:o(()=>e[8]||(e[8]=[n("mdi-account-alert")])),_:1,__:[8]}),e[9]||(e[9]=a("span",null,"Due Reports",-1))]),_:1,__:[9]}),t(b,{value:"profit"},{default:o(()=>[t(D,{start:"",size:"small"},{default:o(()=>e[10]||(e[10]=[n("mdi-chart-line")])),_:1,__:[10]}),e[11]||(e[11]=a("span",null,"Profit Reports",-1))]),_:1,__:[11]})]),_:1},8,["modelValue"]),t(P,{modelValue:l.activeTab,"onUpdate:modelValue":e[1]||(e[1]=U=>l.activeTab=U),class:"reports-window"},{default:o(()=>[t(g,{value:"sales"},{default:o(()=>[a("div",Qe,[t(V)])]),_:1}),t(g,{value:"purchase"},{default:o(()=>[a("div",We,[t(h)])]),_:1}),t(g,{value:"stock"},{default:o(()=>[a("div",Ke,[t(F)])]),_:1}),t(g,{value:"due"},{default:o(()=>[a("div",Je,[t(x)])]),_:1}),t(g,{value:"profit"},{default:o(()=>[a("div",Xe,[t(m)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])}const rt=T(Ge,[["render",Ze],["__scopeId","data-v-a9912c76"]]);export{rt as default};
