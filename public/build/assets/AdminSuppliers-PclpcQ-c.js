import{c as O}from"./commonMixin-BwIVv23E.js";import{P as L,p as A,d as B}from"./PaginationControls-DoA1lTDa.js";import{c as j}from"./validationRules-D8HGgtlI.js";import{_ as N,d as _,w as s,a as o,r as i,f as m,t as u,g as X,b as t,o as f,e as M,c as w,F as I,h as T}from"./app-BqLCFCMY.js";const q={name:"SupplierDialog",props:{modelValue:{type:Boolean,default:!1},supplier:{type:Object,default:null}},emits:["update:modelValue","save","cancel"],data(){return{activeTab:"basic",saving:!1,backendErrors:{},form:{name:"",code:"",company_name:"",email:"",phone:"",mobile:"",address:"",city:"",state:"",country:"",postal_code:"",tax_id:"",opening_balance:0,notes:"",is_active:!0}}},computed:{rules(){return j(this,"name")},dialogModel:{get(){return this.modelValue},set(l){this.$emit("update:modelValue",l)}},editingSupplier(){return this.supplier!==null}},watch:{supplier:{handler(l){this.activeTab="basic",l?this.form={name:l.name||"",code:l.code||"",company_name:l.company_name||"",email:l.email||"",phone:l.phone||"",mobile:l.mobile||"",address:l.address||"",city:l.city||"",state:l.state||"",country:l.country||"",postal_code:l.postal_code||"",tax_id:l.tax_id||"",opening_balance:l.opening_balance||0,notes:l.notes||"",is_active:l.is_active!==void 0?l.is_active:!0}:this.resetForm()},immediate:!0},dialogModel(l){l&&!this.editingSupplier&&this.$nextTick(()=>{!this.form.code&&this.form.name&&this.generateCodeFromName()})},"form.name"(l,e){l&&l.trim().length>3&&(!this.form.code||!this.form.code.trim())&&this.$nextTick(()=>{this.generateCodeFromName()})},"form.code"(l){!l&&this.form.name&&this.form.name.trim().length>3&&this.$nextTick(()=>{this.generateCodeFromName()})}},methods:{handleNameInput(){this.form.name&&this.form.name.trim().length>3&&(!this.form.code||!this.form.code.trim())&&this.$nextTick(()=>{this.generateCodeFromName()})},generateCodeFromName(l=!1){if(!this.form.name||!this.form.name.trim()||!l&&this.form.code&&this.form.code.trim())return;const e=this.form.name.replace(/[^A-Za-z]/g,"");if(!e||e.length===0){this.form.code="SUP-XXX";return}let p="";if(e.length>=3)p=e.substring(0,3).toUpperCase();else{p=e.toUpperCase();const x=p[0]||"X";for(;p.length<3;)p+=x}this.form.code=`SUP-${p}`},async generateCode(){this.generateCodeFromName()},manualGenerateCode(){this.form.name&&this.form.name.trim().length>3&&this.generateCodeFromName(!0)},resetForm(){this.form={name:"",code:"",company_name:"",email:"",phone:"",mobile:"",address:"",city:"",state:"",country:"",postal_code:"",tax_id:"",opening_balance:0,notes:"",is_active:!0},this.backendErrors={},this.$refs.form&&this.$refs.form.resetValidation()},async onSave(){var l,e,p,x;if(this.$refs.form.validate()){this.backendErrors={},this.saving=!0;try{const n=localStorage.getItem("admin_token"),r=(l=this.supplier)==null?void 0:l.id;if(this.editingSupplier&&!r)throw new Error("Supplier ID is missing. Cannot update supplier.");const V=r?`/api/v1/suppliers/${r}`:"/api/v1/suppliers",g=r?"put":"post";await this.$axios[g](V,this.form,{headers:{Authorization:`Bearer ${n}`}}),this.$emit("save",{data:this.form,isEditing:!!r})}catch(n){if(((e=n.response)==null?void 0:e.status)===422&&((x=(p=n.response)==null?void 0:p.data)!=null&&x.errors)){this.backendErrors=n.response.data.errors;const r=[];Object.keys(this.backendErrors).forEach(g=>{(Array.isArray(this.backendErrors[g])?this.backendErrors[g]:[this.backendErrors[g]]).forEach(c=>{r.push(`${this.formatFieldName(g)}: ${c}`)})});const V=r.length>0?r.join("<br>"):"Please fix the validation errors in the form";this.showError(V),this.$nextTick(()=>{this.$refs.form&&this.$refs.form.validate()})}else this.$emit("error",n)}finally{this.saving=!1}}},formatFieldName(l){return l.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},showError(l){window.Toast?window.Toast.fire({icon:"error",title:"Validation Error",html:l}):window.Swal?window.Swal.fire({icon:"error",title:"Validation Error",html:l}):alert(l)},getFieldError(l){return this.backendErrors[l]?Array.isArray(this.backendErrors[l])?this.backendErrors[l][0]:this.backendErrors[l]:null},clearFieldError(l){this.backendErrors[l]&&(delete this.backendErrors[l],this.$forceUpdate())},onCancel(){this.resetForm(),this.$emit("cancel")}}},G={class:"pa-4"},R={class:"pa-4"},H={class:"pa-4"};function Z(l,e,p,x,n,r){const V=i("v-card-title"),g=i("v-tab"),C=i("v-tabs"),c=i("v-text-field"),h=i("v-btn"),S=i("v-switch"),k=i("v-window-item"),E=i("v-textarea"),v=i("v-col"),y=i("v-row"),P=i("v-window"),F=i("v-form"),D=i("v-card-text"),U=i("v-spacer"),b=i("v-card-actions"),a=i("v-card"),z=i("v-dialog");return f(),_(z,{modelValue:r.dialogModel,"onUpdate:modelValue":e[25]||(e[25]=d=>r.dialogModel=d),"max-width":"800",scrollable:"",persistent:""},{default:s(()=>[o(a,null,{default:s(()=>[o(V,null,{default:s(()=>[m(u(r.editingSupplier?"Edit Supplier":"New Supplier"),1)]),_:1}),o(D,null,{default:s(()=>[o(F,{ref:"form",onSubmit:X(r.onSave,["prevent"])},{default:s(()=>[o(C,{modelValue:n.activeTab,"onUpdate:modelValue":e[0]||(e[0]=d=>n.activeTab=d),"bg-color":"grey-lighten-4"},{default:s(()=>[o(g,{value:"basic"},{default:s(()=>e[26]||(e[26]=[m("Basic Information")])),_:1,__:[26]}),o(g,{value:"contact"},{default:s(()=>e[27]||(e[27]=[m("Contact Details")])),_:1,__:[27]}),o(g,{value:"financial"},{default:s(()=>e[28]||(e[28]=[m("Financial")])),_:1,__:[28]})]),_:1},8,["modelValue"]),o(P,{modelValue:n.activeTab,"onUpdate:modelValue":e[24]||(e[24]=d=>n.activeTab=d)},{default:s(()=>[o(k,{value:"basic"},{default:s(()=>[t("div",G,[o(c,{modelValue:n.form.name,"onUpdate:modelValue":[e[1]||(e[1]=d=>n.form.name=d),e[2]||(e[2]=d=>r.clearFieldError("name"))],variant:"outlined",rules:[r.rules.required],required:"",hint:"Enter the supplier's full name","error-messages":r.getFieldError("name"),"persistent-hint":"",onInput:r.handleNameInput,class:"mb-4"},{label:s(()=>e[29]||(e[29]=[m(" Name "),t("span",{class:"text-error"},"*",-1)])),_:1},8,["modelValue","rules","error-messages","onInput"]),o(c,{modelValue:n.form.code,"onUpdate:modelValue":[e[3]||(e[3]=d=>n.form.code=d),e[4]||(e[4]=d=>r.clearFieldError("code"))],label:"Code",variant:"outlined",rules:[r.rules.maxLength(255)],"error-messages":r.getFieldError("code"),hint:"Auto-generated from name, but can be edited. Unique identifier for the supplier","persistent-hint":"",class:"mb-4"},{"append-inner":s(()=>[o(h,{icon:"mdi-refresh",size:"small",variant:"text",onClick:r.manualGenerateCode,title:"Generate code from name",disabled:!n.form.name||n.form.name.trim().length<=3},null,8,["onClick","disabled"])]),_:1},8,["modelValue","rules","error-messages"]),o(c,{modelValue:n.form.company_name,"onUpdate:modelValue":[e[5]||(e[5]=d=>n.form.company_name=d),e[6]||(e[6]=d=>r.clearFieldError("company_name"))],label:"Company Name",variant:"outlined",rules:[r.rules.maxLength(255)],"error-messages":r.getFieldError("company_name"),hint:"Optional: Enter the company or business name if applicable","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),o(c,{modelValue:n.form.tax_id,"onUpdate:modelValue":[e[7]||(e[7]=d=>n.form.tax_id=d),e[8]||(e[8]=d=>r.clearFieldError("tax_id"))],label:"Tax ID",variant:"outlined",rules:[r.rules.maxLength(255)],"error-messages":r.getFieldError("tax_id"),hint:"Optional: Enter the tax identification number (TIN/VAT ID)","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),o(S,{modelValue:n.form.is_active,"onUpdate:modelValue":e[9]||(e[9]=d=>n.form.is_active=d),label:"Active",color:"success",hint:"Enable to make this supplier active. Inactive suppliers won't appear in some lists","persistent-hint":"",class:"mb-4"},null,8,["modelValue"])])]),_:1}),o(k,{value:"contact"},{default:s(()=>[t("div",R,[o(c,{modelValue:n.form.email,"onUpdate:modelValue":[e[10]||(e[10]=d=>n.form.email=d),e[11]||(e[11]=d=>r.clearFieldError("email"))],label:"Email",type:"email",variant:"outlined",rules:[r.rules.email,r.rules.maxLength(255)],"error-messages":r.getFieldError("email"),hint:"Optional: Enter the supplier's email address for communication","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),o(c,{modelValue:n.form.phone,"onUpdate:modelValue":[e[12]||(e[12]=d=>n.form.phone=d),e[13]||(e[13]=d=>r.clearFieldError("phone"))],label:"Phone",variant:"outlined",rules:[r.rules.phone,r.rules.maxLength(255)],"error-messages":r.getFieldError("phone"),hint:"Optional: Enter the landline or office phone number (e.g., 02-1234567)","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),o(c,{modelValue:n.form.mobile,"onUpdate:modelValue":[e[14]||(e[14]=d=>n.form.mobile=d),e[15]||(e[15]=d=>r.clearFieldError("mobile"))],label:"Mobile",variant:"outlined",rules:[r.rules.mobile,r.rules.maxLength(255)],"error-messages":r.getFieldError("mobile"),hint:"Optional: Enter the mobile or cell phone number (e.g., 01712345678)","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),o(E,{modelValue:n.form.address,"onUpdate:modelValue":e[16]||(e[16]=d=>n.form.address=d),label:"Address",variant:"outlined",rows:"2",hint:"Optional: Enter the complete street address","persistent-hint":"",class:"mb-4"},null,8,["modelValue"]),o(y,null,{default:s(()=>[o(v,{cols:"12",md:"6"},{default:s(()=>[o(c,{modelValue:n.form.city,"onUpdate:modelValue":e[17]||(e[17]=d=>n.form.city=d),label:"City",variant:"outlined",rules:[r.rules.maxLength(255)],hint:"Optional: Enter the city name","persistent-hint":""},null,8,["modelValue","rules"])]),_:1}),o(v,{cols:"12",md:"6"},{default:s(()=>[o(c,{modelValue:n.form.state,"onUpdate:modelValue":e[18]||(e[18]=d=>n.form.state=d),label:"State",variant:"outlined",rules:[r.rules.maxLength(255)],hint:"Optional: Enter the state or province name","persistent-hint":""},null,8,["modelValue","rules"])]),_:1})]),_:1}),o(y,null,{default:s(()=>[o(v,{cols:"12",md:"6"},{default:s(()=>[o(c,{modelValue:n.form.country,"onUpdate:modelValue":e[19]||(e[19]=d=>n.form.country=d),label:"Country",variant:"outlined",rules:[r.rules.maxLength(255)],hint:"Optional: Enter the country name","persistent-hint":""},null,8,["modelValue","rules"])]),_:1}),o(v,{cols:"12",md:"6"},{default:s(()=>[o(c,{modelValue:n.form.postal_code,"onUpdate:modelValue":e[20]||(e[20]=d=>n.form.postal_code=d),label:"Postal Code",variant:"outlined",rules:[r.rules.maxLength(255)],hint:"Optional: Enter the postal code or zip code","persistent-hint":""},null,8,["modelValue","rules"])]),_:1})]),_:1})])]),_:1}),o(k,{value:"financial"},{default:s(()=>[t("div",H,[o(c,{modelValue:n.form.opening_balance,"onUpdate:modelValue":[e[21]||(e[21]=d=>n.form.opening_balance=d),e[22]||(e[22]=d=>r.clearFieldError("opening_balance"))],modelModifiers:{number:!0},label:"Opening Balance",type:"number",step:"0.01",prefix:"৳",variant:"outlined",rules:[r.rules.numeric,r.rules.minValue(0)],"error-messages":r.getFieldError("opening_balance"),hint:"Enter the initial balance when creating this supplier. Must be 0 or greater","persistent-hint":"",class:"mb-4"},null,8,["modelValue","rules","error-messages"]),o(E,{modelValue:n.form.notes,"onUpdate:modelValue":e[23]||(e[23]=d=>n.form.notes=d),label:"Notes",variant:"outlined",rows:"4",hint:"Optional: Add any additional notes or comments about this supplier","persistent-hint":"",class:"mb-4"},null,8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["onSubmit"])]),_:1}),o(b,null,{default:s(()=>[o(U),o(h,{onClick:r.onCancel,variant:"text"},{default:s(()=>e[30]||(e[30]=[m("Cancel")])),_:1,__:[30]},8,["onClick"]),o(h,{onClick:r.onSave,color:"primary",loading:n.saving},{default:s(()=>[m(u(r.editingSupplier?"Update":"Create"),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const J=N(q,[["render",Z],["__scopeId","data-v-bee783a7"]]),K={name:"SupplierViewDialog",mixins:[O],props:{modelValue:{type:Boolean,default:!1},supplier:{type:Object,default:null}},emits:["update:modelValue"],data(){return{activeTab:"basic"}},computed:{dialogModel:{get(){return this.modelValue},set(l){this.$emit("update:modelValue",l)}}},watch:{modelValue(l){l&&(this.activeTab="basic")}},methods:{formatCurrency(l){return l==null?"৳0.00":"৳"+new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l)}}},Q={class:"pa-4"},W={class:"mb-4"},Y={class:"mt-1"},$={class:"mb-4"},ee={class:"mt-1"},te={class:"mb-4"},le={class:"mt-1"},oe={class:"mb-4"},se={class:"mt-1"},ne={class:"mb-4"},re={class:"mt-1"},ie={class:"pa-4"},ae={class:"mb-4"},de={class:"mt-1"},ue={class:"mb-4"},me={class:"mt-1"},pe={class:"mb-4"},ce={class:"mt-1"},fe={class:"mb-4"},ve={class:"mt-1"},ge={class:"mb-4"},_e={class:"mt-1"},be={class:"mb-4"},he={class:"mt-1"},ye={class:"mb-4"},Ve={class:"mt-1"},ke={class:"mb-4"},we={class:"mt-1"},xe={class:"pa-4"},Ce={class:"mb-4"},Se={class:"mt-1"},Ee={class:"mb-4"},Pe={class:"mt-1"},Fe={class:"mb-4"},De={class:"mt-1"},Ue={class:"pa-4"},ze={class:"mb-4"},Be={class:"mt-1"},Ae={class:"mb-4"},Ie={class:"mt-1"},Ne={class:"mb-4"},Te={class:"mt-1"},Oe={class:"mb-4"},Me={class:"mt-1"};function Le(l,e,p,x,n,r){const V=i("v-card-title"),g=i("v-tab"),C=i("v-tabs"),c=i("v-col"),h=i("v-row"),S=i("v-chip"),k=i("v-window-item"),E=i("v-window"),v=i("v-card-text"),y=i("v-spacer"),P=i("v-btn"),F=i("v-card-actions"),D=i("v-card"),U=i("v-dialog");return f(),_(U,{modelValue:r.dialogModel,"onUpdate:modelValue":e[3]||(e[3]=b=>r.dialogModel=b),"max-width":"800",scrollable:""},{default:s(()=>[p.supplier?(f(),_(D,{key:0},{default:s(()=>[o(V,null,{default:s(()=>e[4]||(e[4]=[m(" Supplier Details ")])),_:1,__:[4]}),o(v,null,{default:s(()=>[o(C,{modelValue:n.activeTab,"onUpdate:modelValue":e[0]||(e[0]=b=>n.activeTab=b),"bg-color":"grey-lighten-4"},{default:s(()=>[o(g,{value:"basic"},{default:s(()=>e[5]||(e[5]=[m("Basic Information")])),_:1,__:[5]}),o(g,{value:"contact"},{default:s(()=>e[6]||(e[6]=[m("Contact Details")])),_:1,__:[6]}),o(g,{value:"financial"},{default:s(()=>e[7]||(e[7]=[m("Financial")])),_:1,__:[7]}),o(g,{value:"audit"},{default:s(()=>e[8]||(e[8]=[m("System Information")])),_:1,__:[8]})]),_:1},8,["modelValue"]),o(E,{modelValue:n.activeTab,"onUpdate:modelValue":e[1]||(e[1]=b=>n.activeTab=b)},{default:s(()=>[o(k,{value:"basic"},{default:s(()=>[t("div",Q,[o(h,null,{default:s(()=>[o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",W,[e[9]||(e[9]=t("strong",{class:"text-grey-darken-1"},"Name:",-1)),t("div",Y,u(p.supplier.name||"-"),1)])]),_:1}),o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",$,[e[10]||(e[10]=t("strong",{class:"text-grey-darken-1"},"Code:",-1)),t("div",ee,u(p.supplier.code||"-"),1)])]),_:1})]),_:1}),o(h,null,{default:s(()=>[o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",te,[e[11]||(e[11]=t("strong",{class:"text-grey-darken-1"},"Company Name:",-1)),t("div",le,u(p.supplier.company_name||"-"),1)])]),_:1}),o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",oe,[e[12]||(e[12]=t("strong",{class:"text-grey-darken-1"},"Tax ID:",-1)),t("div",se,u(p.supplier.tax_id||"-"),1)])]),_:1})]),_:1}),t("div",ne,[e[13]||(e[13]=t("strong",{class:"text-grey-darken-1"},"Status:",-1)),t("div",re,[o(S,{color:p.supplier.is_active?"success":"error",size:"small"},{default:s(()=>[m(u(p.supplier.is_active?"Active":"Inactive"),1)]),_:1},8,["color"])])])])]),_:1}),o(k,{value:"contact"},{default:s(()=>[t("div",ie,[o(h,null,{default:s(()=>[o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",ae,[e[14]||(e[14]=t("strong",{class:"text-grey-darken-1"},"Email:",-1)),t("div",de,u(p.supplier.email||"-"),1)])]),_:1}),o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",ue,[e[15]||(e[15]=t("strong",{class:"text-grey-darken-1"},"Phone:",-1)),t("div",me,u(p.supplier.phone||"-"),1)])]),_:1})]),_:1}),o(h,null,{default:s(()=>[o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",pe,[e[16]||(e[16]=t("strong",{class:"text-grey-darken-1"},"Mobile:",-1)),t("div",ce,u(p.supplier.mobile||"-"),1)])]),_:1})]),_:1}),t("div",fe,[e[17]||(e[17]=t("strong",{class:"text-grey-darken-1"},"Address:",-1)),t("div",ve,u(p.supplier.address||"-"),1)]),o(h,null,{default:s(()=>[o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",ge,[e[18]||(e[18]=t("strong",{class:"text-grey-darken-1"},"City:",-1)),t("div",_e,u(p.supplier.city||"-"),1)])]),_:1}),o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",be,[e[19]||(e[19]=t("strong",{class:"text-grey-darken-1"},"State:",-1)),t("div",he,u(p.supplier.state||"-"),1)])]),_:1})]),_:1}),o(h,null,{default:s(()=>[o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",ye,[e[20]||(e[20]=t("strong",{class:"text-grey-darken-1"},"Country:",-1)),t("div",Ve,u(p.supplier.country||"-"),1)])]),_:1}),o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",ke,[e[21]||(e[21]=t("strong",{class:"text-grey-darken-1"},"Postal Code:",-1)),t("div",we,u(p.supplier.postal_code||"-"),1)])]),_:1})]),_:1})])]),_:1}),o(k,{value:"financial"},{default:s(()=>[t("div",xe,[o(h,null,{default:s(()=>[o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",Ce,[e[22]||(e[22]=t("strong",{class:"text-grey-darken-1"},"Opening Balance:",-1)),t("div",Se,u(r.formatCurrency(p.supplier.opening_balance)),1)])]),_:1}),o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",Ee,[e[23]||(e[23]=t("strong",{class:"text-grey-darken-1"},"Current Balance:",-1)),t("div",Pe,[o(S,{color:p.supplier.current_balance>=0?"success":"error",size:"small"},{default:s(()=>[m(u(r.formatCurrency(p.supplier.current_balance)),1)]),_:1},8,["color"])])])]),_:1})]),_:1}),t("div",Fe,[e[24]||(e[24]=t("strong",{class:"text-grey-darken-1"},"Notes:",-1)),t("div",De,u(p.supplier.notes||"-"),1)])])]),_:1}),o(k,{value:"audit"},{default:s(()=>[t("div",Ue,[o(h,null,{default:s(()=>[o(c,{cols:"12",md:"6"},{default:s(()=>{var b,a;return[t("div",ze,[e[25]||(e[25]=t("strong",{class:"text-grey-darken-1"},"Created By:",-1)),t("div",Be,u(((b=p.supplier.created_by)==null?void 0:b.name)||((a=p.supplier.created_by)==null?void 0:a.email)||"-"),1)])]}),_:1}),o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",Ae,[e[26]||(e[26]=t("strong",{class:"text-grey-darken-1"},"Created At:",-1)),t("div",Ie,u(l.formatDateShort(p.supplier.created_at)),1)])]),_:1})]),_:1}),o(h,null,{default:s(()=>[o(c,{cols:"12",md:"6"},{default:s(()=>{var b,a;return[t("div",Ne,[e[27]||(e[27]=t("strong",{class:"text-grey-darken-1"},"Updated By:",-1)),t("div",Te,u(((b=p.supplier.updated_by)==null?void 0:b.name)||((a=p.supplier.updated_by)==null?void 0:a.email)||"-"),1)])]}),_:1}),o(c,{cols:"12",md:"6"},{default:s(()=>[t("div",Oe,[e[28]||(e[28]=t("strong",{class:"text-grey-darken-1"},"Updated At:",-1)),t("div",Me,u(l.formatDateShort(p.supplier.updated_at)),1)])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(F,null,{default:s(()=>[o(y),o(P,{onClick:e[2]||(e[2]=b=>r.dialogModel=!1),variant:"text"},{default:s(()=>e[29]||(e[29]=[m("Close")])),_:1,__:[29]})]),_:1})]),_:1})):M("",!0)]),_:1},8,["modelValue"])}const je=N(K,[["render",Le],["__scopeId","data-v-7a377be7"]]),Xe={components:{PaginationControls:L,SupplierDialog:J,SupplierViewDialog:je},mixins:[O],data(){return{suppliers:[],activeFilter:null,activeOptions:[{title:"Active",value:!0},{title:"Inactive",value:!1}],dialog:!1,viewDialog:!1,selectedSupplier:null,editingSupplier:null,currentPage:B.currentPage,perPage:B.perPage,perPageOptions:B.perPageOptions,pagination:{...B.pagination}}},async mounted(){await this.loadSuppliers()},methods:{async loadSuppliers(){try{this.loading=!0;const l=this.buildPaginationParams();this.perPage==="all"&&(l.per_page=999999),this.search&&(l.search=this.search),this.activeFilter!==null&&(l.is_active=this.activeFilter);const e=await this.$axios.get("/api/v1/suppliers",{params:l,headers:this.getAuthHeaders()});this.suppliers=e.data.data||[],this.updatePagination(e.data)}catch(l){this.handleApiError(l,"Failed to load suppliers")}finally{this.loading=!1}},openDialog(l){this.editingSupplier=l,this.dialog=!0},closeDialog(){this.dialog=!1,this.editingSupplier=null},handleSaveSuccess({data:l,isEditing:e}){this.showSuccess(e?"Supplier updated successfully":"Supplier created successfully"),this.closeDialog(),this.loadSuppliers()},handleSaveError(l){this.handleApiError(l,"Error saving supplier")},async deleteSupplier(l){if(confirm(`Delete supplier "${l.name}"?`))try{const e=localStorage.getItem("admin_token");await this.$axios.delete(`/api/v1/suppliers/${l.id}`,{headers:{Authorization:`Bearer ${e}`}}),this.showSuccess("Supplier deleted successfully"),await this.loadSuppliers()}catch(e){this.handleApiError(e,"Error deleting supplier")}},viewSupplier(l){this.selectedSupplier=l,this.viewDialog=!0},formatCurrency(l){return l==null?"৳0.00":"৳"+new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l)},buildPaginationParams(l={}){return A.buildPaginationParams(this.currentPage,this.perPage,l,this.sortBy,this.sortDirection)},updatePagination(l){A.updatePagination(this,l)},resetPagination(){A.resetPagination(this)},onPerPageChange(){this.resetPagination(),this.loadSuppliers()},onPerPageUpdate(l){this.perPage=l,this.onPerPageChange()},onPageChange(l){this.currentPage=l,this.loadSuppliers()},onSort(l){this.handleSort(l),this.currentPage=1,this.loadSuppliers()},isSortingBy(l){return this.sortBy===l},getSortDirection(l){return this.sortBy===l?this.sortDirection:null}}},qe={class:"page-header"},Ge={class:"text-caption text-grey"},Re={class:"sortable-header"},He={class:"sortable-header"},Ze={class:"sortable-header"},Je={class:"sortable-header"},Ke={class:"sortable-header"},Qe={class:"sortable-header"},We={class:"sortable-header"},Ye={key:0},$e={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},et={class:"text-caption text-grey"},tt={key:0},lt={key:0},ot={key:1},st={key:1};function nt(l,e,p,x,n,r){const V=i("v-btn"),g=i("v-select"),C=i("v-col"),c=i("v-text-field"),h=i("v-row"),S=i("v-card-text"),k=i("v-card"),E=i("v-card-title"),v=i("v-icon"),y=i("v-skeleton-loader"),P=i("v-chip"),F=i("v-table"),D=i("PaginationControls"),U=i("SupplierViewDialog"),b=i("SupplierDialog");return f(),w("div",null,[t("div",qe,[e[14]||(e[14]=t("h1",{class:"text-h4 page-title"},"Supplier Management",-1)),o(V,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=a=>r.openDialog(null)),class:"add-button"},{default:s(()=>e[13]||(e[13]=[m(" Add New Supplier ")])),_:1,__:[13]})]),o(k,{class:"mb-4"},{default:s(()=>[o(S,null,{default:s(()=>[o(h,null,{default:s(()=>[o(C,{cols:"12",md:"4"},{default:s(()=>[o(g,{modelValue:n.activeFilter,"onUpdate:modelValue":[e[1]||(e[1]=a=>n.activeFilter=a),r.loadSuppliers],items:n.activeOptions,label:"Filter by Status",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),o(C,{cols:"12",md:"8"},{default:s(()=>[o(c,{modelValue:l.search,"onUpdate:modelValue":e[2]||(e[2]=a=>l.search=a),label:"Search by name, code, company, email, phone","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:r.loadSuppliers},null,8,["modelValue","onInput"])]),_:1})]),_:1})]),_:1})]),_:1}),o(k,null,{default:s(()=>[o(E,{class:"d-flex justify-space-between align-center"},{default:s(()=>[e[16]||(e[16]=t("span",null,"Suppliers",-1)),t("span",Ge,[e[15]||(e[15]=m(" Total Records: ")),t("strong",null,u(n.pagination.total||0),1)])]),_:1,__:[16]}),o(S,null,{default:s(()=>[o(F,null,{default:s(()=>[t("thead",null,[t("tr",null,[t("th",{class:"sortable",onClick:e[3]||(e[3]=a=>r.onSort("code"))},[t("div",Re,[e[18]||(e[18]=t("span",null,"Code",-1)),l.sortBy==="code"?(f(),_(v,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[m(u(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),_(v,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[17]||(e[17]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[17]}))])]),t("th",{class:"sortable",onClick:e[4]||(e[4]=a=>r.onSort("name"))},[t("div",He,[e[20]||(e[20]=t("span",null,"Name",-1)),l.sortBy==="name"?(f(),_(v,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[m(u(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),_(v,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[19]||(e[19]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[19]}))])]),t("th",{class:"sortable",onClick:e[5]||(e[5]=a=>r.onSort("company_name"))},[t("div",Ze,[e[22]||(e[22]=t("span",null,"Company",-1)),l.sortBy==="company_name"?(f(),_(v,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[m(u(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),_(v,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[21]||(e[21]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[21]}))])]),t("th",{class:"sortable",onClick:e[6]||(e[6]=a=>r.onSort("email"))},[t("div",Je,[e[24]||(e[24]=t("span",null,"Email",-1)),l.sortBy==="email"?(f(),_(v,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[m(u(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),_(v,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[23]||(e[23]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[23]}))])]),t("th",{class:"sortable",onClick:e[7]||(e[7]=a=>r.onSort("phone"))},[t("div",Ke,[e[26]||(e[26]=t("span",null,"Phone",-1)),l.sortBy==="phone"?(f(),_(v,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[m(u(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),_(v,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[25]||(e[25]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[25]}))])]),t("th",{class:"sortable",onClick:e[8]||(e[8]=a=>r.onSort("city"))},[t("div",Qe,[e[28]||(e[28]=t("span",null,"City",-1)),l.sortBy==="city"?(f(),_(v,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[m(u(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),_(v,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[27]||(e[27]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[27]}))])]),t("th",{class:"sortable",onClick:e[9]||(e[9]=a=>r.onSort("current_balance"))},[t("div",We,[e[30]||(e[30]=t("span",null,"Balance",-1)),l.sortBy==="current_balance"?(f(),_(v,{key:0,size:"18",class:"sort-icon active"},{default:s(()=>[m(u(l.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(f(),_(v,{key:1,size:"18",class:"sort-icon inactive"},{default:s(()=>e[29]||(e[29]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[29]}))])]),e[31]||(e[31]=t("th",null,"Status",-1)),e[32]||(e[32]=t("th",null,"Actions",-1))])]),t("tbody",null,[l.loading?(f(),w(I,{key:0},T(5,a=>t("tr",{key:`skeleton-${a}`},[t("td",null,[o(y,{type:"text",width:"100"})]),t("td",null,[o(y,{type:"text",width:"150"})]),t("td",null,[o(y,{type:"text",width:"150"})]),t("td",null,[o(y,{type:"text",width:"150"})]),t("td",null,[o(y,{type:"text",width:"120"})]),t("td",null,[o(y,{type:"text",width:"100"})]),t("td",null,[o(y,{type:"text",width:"100"})]),t("td",null,[o(y,{type:"chip",width:"80",height:"24"})]),t("td",null,[o(y,{type:"button",width:"32",height:"32"})])])),64)):(f(),w(I,{key:1},[(f(!0),w(I,null,T(n.suppliers,a=>(f(),w("tr",{key:a.id},[t("td",null,u(a.code||"-"),1),t("td",null,u(a.name),1),t("td",null,u(a.company_name||"-"),1),t("td",null,u(a.email||"-"),1),t("td",null,u(a.phone||a.mobile||"-"),1),t("td",null,u(a.city||"-"),1),t("td",null,[o(P,{color:a.current_balance>=0?"success":"error",size:"small"},{default:s(()=>[m(u(r.formatCurrency(a.current_balance)),1)]),_:2},1032,["color"])]),t("td",null,[o(P,{color:a.is_active?"success":"error",size:"small"},{default:s(()=>[m(u(a.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),t("td",null,[o(V,{size:"small",icon:"mdi-eye",onClick:z=>r.viewSupplier(a),variant:"text",title:"View"},null,8,["onClick"]),o(V,{size:"small",icon:"mdi-pencil",onClick:z=>r.openDialog(a),variant:"text",title:"Edit"},null,8,["onClick"]),o(V,{size:"small",icon:"mdi-delete",onClick:z=>r.deleteSupplier(a),variant:"text",color:"error",title:"Delete"},null,8,["onClick"])])]))),128)),n.suppliers.length===0?(f(),w("tr",Ye,e[33]||(e[33]=[t("td",{colspan:"9",class:"text-center py-4"},"No suppliers found",-1)]))):M("",!0)],64))])]),_:1}),t("div",$e,[t("div",et,[n.suppliers.length>0&&n.pagination.total>0?(f(),w("span",tt,[n.perPage==="all"?(f(),w("span",lt,[e[34]||(e[34]=m(" Showing ")),t("strong",null,"all "+u(n.pagination.total.toLocaleString()),1),e[35]||(e[35]=m(" records "))])):(f(),w("span",ot,[e[36]||(e[36]=m(" Showing ")),t("strong",null,u((n.currentPage-1)*n.perPage+1),1),e[37]||(e[37]=m(" to ")),t("strong",null,u(Math.min(n.currentPage*n.perPage,n.pagination.total)),1),e[38]||(e[38]=m(" of ")),t("strong",null,u(n.pagination.total.toLocaleString()),1),e[39]||(e[39]=m(" records "))]))])):(f(),w("span",st,"No records found"))]),o(D,{modelValue:n.currentPage,"onUpdate:modelValue":e[10]||(e[10]=a=>n.currentPage=a),pagination:n.pagination,"per-page-value":n.perPage,"per-page-options":n.perPageOptions,"onUpdate:perPage":r.onPerPageUpdate,onPageChange:r.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1}),o(U,{modelValue:n.viewDialog,"onUpdate:modelValue":e[11]||(e[11]=a=>n.viewDialog=a),supplier:n.selectedSupplier},null,8,["modelValue","supplier"]),o(b,{modelValue:n.dialog,"onUpdate:modelValue":e[12]||(e[12]=a=>n.dialog=a),supplier:n.editingSupplier,onSave:r.handleSaveSuccess,onError:r.handleSaveError,onCancel:r.closeDialog},null,8,["modelValue","supplier","onSave","onError","onCancel"])])}const ut=N(Xe,[["render",nt],["__scopeId","data-v-2aaed649"]]);export{ut as default};
