import{c as B}from"./commonMixin-BwIVv23E.js";import{P as M,p as N,d as I}from"./PaginationControls-DoA1lTDa.js";import{_ as L,d as h,w as r,a as i,r as n,f as m,t as c,e as O,b as o,g as T,c as p,F as V,h as U,o as a}from"./app-BqLCFCMY.js";const H={name:"RoleDialog",mixins:[B],props:{modelValue:{type:Boolean,required:!0},role:{type:Object,default:null},groupedPermissions:{type:Object,default:()=>({})}},emits:["update:modelValue","save","error"],data(){return{form:{name:"",slug:"",description:"",is_active:!0,order:0,permissions:[]},permissionSearch:"",saving:!1,rules:{required:s=>!!s||"This field is required"}}},computed:{editingRole(){return!!this.role},safeGroupedPermissions(){if(!this.groupedPermissions||typeof this.groupedPermissions!="object")return{};const s={};return Object.keys(this.groupedPermissions).forEach(e=>{Array.isArray(this.groupedPermissions[e])&&(s[e]=this.groupedPermissions[e])}),s},filteredGroupedPermissions(){if(!this.permissionSearch)return this.safeGroupedPermissions;const s=this.permissionSearch.toLowerCase(),e={};return Object.keys(this.safeGroupedPermissions).forEach(d=>{const g=this.safeGroupedPermissions[d];if(Array.isArray(g)){const l=g.filter(t=>{const P=(t.name||"").toLowerCase(),R=(t.description||"").toLowerCase(),b=(t.slug||"").toLowerCase();return P.includes(s)||R.includes(s)||b.includes(s)});l.length>0&&(e[d]=l)}}),e},allPermissions(){const s=[];return Object.values(this.safeGroupedPermissions).forEach(e=>{Array.isArray(e)&&s.push(...e)}),s}},watch:{role:{handler(s){if(s){let e=[];s.permissions&&(e=s.permissions.map(d=>typeof d=="object"&&d.id?d.id:d)),this.form={name:s.name||"",slug:s.slug||"",description:s.description||"",is_active:s.is_active!==void 0?s.is_active:!0,order:s.order||0,permissions:e}}else this.resetForm()},immediate:!0},modelValue(s){s||this.resetForm()}},methods:{resetForm(){this.form={name:"",slug:"",description:"",is_active:!0,order:0,permissions:[]},this.permissionSearch="",this.$refs.roleForm&&this.$refs.roleForm.resetValidation()},autoGenerateSlugFromName(){!this.form.slug&&this.form.name&&!this.editingRole&&this.generateSlugFromName()},generateSlugFromName(){this.form.name&&(this.form.slug=this.form.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))},isFormPermissionSelected(s){return this.form.permissions.includes(s)},toggleFormPermission(s){const e=this.form.permissions.indexOf(s);e>-1?this.form.permissions.splice(e,1):this.form.permissions.push(s)},getSelectedCountInGroup(s){const e=this.filteredGroupedPermissions[s]||this.safeGroupedPermissions[s];return!e||!Array.isArray(e)?0:e.filter(d=>this.form.permissions.includes(d.id)).length},selectAllPermissions(){this.allPermissions.forEach(s=>{this.form.permissions.includes(s.id)||this.form.permissions.push(s.id)})},deselectAllPermissions(){this.form.permissions=[]},selectAllInGroup(s){const e=this.filteredGroupedPermissions[s]||this.safeGroupedPermissions[s];e&&Array.isArray(e)&&e.forEach(d=>{this.form.permissions.includes(d.id)||this.form.permissions.push(d.id)})},deselectAllInGroup(s){const e=this.filteredGroupedPermissions[s]||this.safeGroupedPermissions[s];if(e&&Array.isArray(e)){const d=e.map(g=>g.id);this.form.permissions=this.form.permissions.filter(g=>!d.includes(g))}},close(){this.$emit("update:modelValue",!1)},async onSave(){if(!this.$refs.roleForm){this.showError("Form reference not found");return}if(this.$refs.roleForm.validate()){!this.form.slug&&this.form.name&&(this.form.slug=this.form.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")),this.saving=!0;try{const s=this.editingRole?`/api/v1/roles/${this.role.id}`:"/api/v1/roles",e=this.editingRole?"put":"post",d={name:this.form.name.trim(),description:this.form.description?this.form.description.trim():null,is_active:this.form.is_active===!0||this.form.is_active==="true"||this.form.is_active===1,order:parseInt(this.form.order)||0};this.editingRole?this.form.slug!==this.role.slug&&(this.form.slug&&this.form.slug.trim()?d.slug=this.form.slug.trim():d.slug=""):this.form.slug&&this.form.slug.trim()&&(d.slug=this.form.slug.trim()),this.form.permissions&&Array.isArray(this.form.permissions)&&(d.permissions=this.form.permissions),await this.$axios[e](s,d,{headers:this.getAuthHeaders()}),this.showSuccess(this.editingRole?"Role updated successfully":"Role created successfully"),this.$emit("save",d),this.close()}catch(s){console.error("Error saving role:",s),this.handleApiError(s,"Error saving role"),this.$emit("error",s)}finally{this.saving=!1}}}}},J={class:"mb-2"},K={class:"d-flex justify-space-between align-center mb-2"},Q={class:"d-flex gap-2"},W={key:0,class:"permissions-container mb-4"},X={class:"d-flex align-center gap-2"},Y={class:"text-h6"},Z={class:"d-flex gap-1"},$={class:"font-weight-medium"},ee={key:0,class:"text-caption text-grey"},se={key:0},ie={key:1};function te(s,e,d,g,l,t){const P=n("v-card-title"),R=n("v-alert"),b=n("v-text-field"),z=n("v-icon"),v=n("v-btn"),A=n("v-textarea"),E=n("v-switch"),D=n("v-divider"),k=n("v-chip"),_=n("v-checkbox"),C=n("v-col"),G=n("v-row"),y=n("v-card-text"),x=n("v-card"),S=n("v-form"),u=n("v-spacer"),j=n("v-card-actions"),q=n("v-dialog");return a(),h(q,{"model-value":d.modelValue,"onUpdate:modelValue":e[6]||(e[6]=f=>s.$emit("update:modelValue",f)),"max-width":"900",persistent:""},{default:r(()=>[i(x,null,{default:r(()=>[i(P,null,{default:r(()=>[m(c(t.editingRole?"Edit Role":"Add New Role"),1)]),_:1}),i(y,null,{default:r(()=>[t.editingRole&&t.editingRole.is_system?(a(),h(R,{key:0,type:"info",variant:"tonal",class:"mb-4"},{default:r(()=>e[7]||(e[7]=[o("strong",null,"System Role:",-1),m(" This is a system role. Core properties (name, slug, description, status, order) cannot be modified. Only permissions can be updated using the permissions button. ")])),_:1,__:[7]})):O("",!0),i(S,{ref:"roleForm",onSubmit:T(t.onSave,["prevent"])},{default:r(()=>[i(b,{modelValue:l.form.name,"onUpdate:modelValue":e[0]||(e[0]=f=>l.form.name=f),placeholder:"Enter role name (e.g., Administrator, Editor)",rules:[l.rules.required],required:"",hint:"Display name for the role","persistent-hint":"",variant:"outlined",density:"comfortable","hide-details":"auto",class:"mb-4",disabled:t.editingRole&&t.editingRole.is_system,onBlur:t.autoGenerateSlugFromName},{label:r(()=>e[8]||(e[8]=[m(" Role Name "),o("span",{class:"text-error",style:{"font-size":"1.2em","font-weight":"bold"}},"*",-1)])),_:1},8,["modelValue","rules","disabled","onBlur"]),i(b,{modelValue:l.form.slug,"onUpdate:modelValue":e[1]||(e[1]=f=>l.form.slug=f),label:"Slug",placeholder:"Enter slug (e.g., administrator, editor) or click generate to auto-generate",hint:"URL-friendly identifier (auto-generated from name if empty)","persistent-hint":"",variant:"outlined",density:"comfortable","hide-details":"auto","prepend-inner-icon":"mdi-link-variant",class:"mb-4",disabled:t.editingRole&&t.editingRole.is_system},{"append-inner":r(()=>[i(v,{icon:"",variant:"text",size:"small",color:"primary",disabled:!l.form.name||t.editingRole&&t.editingRole.is_system,onClick:t.generateSlugFromName,title:l.form.name?"Generate slug from role name":"Enter role name first"},{default:r(()=>[i(z,{size:"small"},{default:r(()=>e[9]||(e[9]=[m("mdi-refresh")])),_:1,__:[9]})]),_:1},8,["disabled","onClick","title"])]),_:1},8,["modelValue","disabled"]),i(A,{modelValue:l.form.description,"onUpdate:modelValue":e[2]||(e[2]=f=>l.form.description=f),label:"Description",placeholder:"Enter a brief description of the role and its purpose (optional)",hint:"Brief description of the role","persistent-hint":"",variant:"outlined",density:"comfortable",rows:"2","hide-details":"auto",class:"mb-4",disabled:t.editingRole&&t.editingRole.is_system},null,8,["modelValue","disabled"]),i(b,{modelValue:l.form.order,"onUpdate:modelValue":e[3]||(e[3]=f=>l.form.order=f),modelModifiers:{number:!0},label:"Order",type:"number",placeholder:"Enter display order (e.g., 0, 1, 2)",hint:"Display order (lower numbers first)","persistent-hint":"",variant:"outlined",density:"comfortable","hide-details":"auto",class:"mb-4",disabled:t.editingRole&&t.editingRole.is_system},null,8,["modelValue","disabled"]),i(E,{modelValue:l.form.is_active,"onUpdate:modelValue":e[4]||(e[4]=f=>l.form.is_active=f),label:"Active",hint:"Inactive roles cannot be assigned to users","persistent-hint":"",class:"mb-4",disabled:t.editingRole&&t.editingRole.is_system},null,8,["modelValue","disabled"]),i(D,{class:"my-4"}),o("div",J,[o("div",K,[e[12]||(e[12]=o("div",null,[o("h3",{class:"text-h6 mb-1"},"Permissions"),o("p",{class:"text-caption text-grey"},"Select permissions to assign to this role")],-1)),o("div",Q,[i(v,{size:"small",variant:"outlined",onClick:t.selectAllPermissions,color:"primary"},{default:r(()=>e[10]||(e[10]=[m(" Select All ")])),_:1,__:[10]},8,["onClick"]),i(v,{size:"small",variant:"outlined",onClick:t.deselectAllPermissions,color:"grey"},{default:r(()=>e[11]||(e[11]=[m(" Deselect All ")])),_:1,__:[11]},8,["onClick"])])])]),i(b,{modelValue:l.permissionSearch,"onUpdate:modelValue":e[5]||(e[5]=f=>l.permissionSearch=f),label:"Search permissions",placeholder:"Search by permission name, description, or slug","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",hint:"Type to filter permissions by name, description, or slug","persistent-hint":"","hide-details":"auto",class:"mb-4"},null,8,["modelValue"]),Object.keys(t.filteredGroupedPermissions).length>0?(a(),p("div",W,[(a(!0),p(V,null,U(t.filteredGroupedPermissions,(f,F)=>(a(),p("div",{key:F,class:"permission-group mb-4"},[i(x,{variant:"outlined"},{default:r(()=>[i(P,{class:"d-flex justify-space-between align-center py-2"},{default:r(()=>[o("div",X,[o("span",Y,c(F.charAt(0).toUpperCase()+F.slice(1)),1),i(k,{size:"small",color:"primary",variant:"flat"},{default:r(()=>[m(c(t.getSelectedCountInGroup(F))+" / "+c(f.length)+" selected ",1)]),_:2},1024)]),o("div",Z,[i(v,{size:"x-small",variant:"text",onClick:w=>t.selectAllInGroup(F),color:"primary"},{default:r(()=>e[13]||(e[13]=[m(" Select All ")])),_:2,__:[13]},1032,["onClick"]),i(v,{size:"x-small",variant:"text",onClick:w=>t.deselectAllInGroup(F),color:"grey"},{default:r(()=>e[14]||(e[14]=[m(" Clear ")])),_:2,__:[14]},1032,["onClick"])])]),_:2},1024),i(y,null,{default:r(()=>[Array.isArray(f)?(a(),h(G,{key:0},{default:r(()=>[(a(!0),p(V,null,U(f,w=>(a(),h(C,{key:w.id,cols:"12",md:"6",lg:"4"},{default:r(()=>[i(_,{"model-value":t.isFormPermissionSelected(w.id),"onUpdate:modelValue":Ae=>t.toggleFormPermission(w.id),label:w.name,hint:w.description,"persistent-hint":"",density:"comfortable",color:"primary"},{label:r(()=>[o("div",null,[o("div",$,c(w.name),1),w.description?(a(),p("div",ee,c(w.description),1)):O("",!0)])]),_:2},1032,["model-value","onUpdate:modelValue","label","hint"])]),_:2},1024))),128))]),_:2},1024)):O("",!0)]),_:2},1024)]),_:2},1024)]))),128))])):(a(),h(R,{key:1,type:"info",variant:"tonal",class:"mb-4"},{default:r(()=>[l.permissionSearch?(a(),p("div",se,' No permissions found matching "'+c(l.permissionSearch)+'" ',1)):(a(),p("div",ie," No permissions available. Please ensure permissions are loaded. "))]),_:1}))]),_:1},8,["onSubmit"])]),_:1}),i(j,null,{default:r(()=>[i(u),i(v,{onClick:t.close,variant:"text"},{default:r(()=>e[15]||(e[15]=[m("Cancel")])),_:1,__:[15]},8,["onClick"]),t.editingRole&&t.editingRole.is_system?(a(),h(v,{key:0,onClick:t.close,color:"primary"},{default:r(()=>e[16]||(e[16]=[m(" Close ")])),_:1,__:[16]},8,["onClick"])):(a(),h(v,{key:1,onClick:t.onSave,color:"primary",loading:l.saving},{default:r(()=>[m(c(t.editingRole?"Update":"Create"),1)]),_:1},8,["onClick","loading"]))]),_:1})]),_:1})]),_:1},8,["model-value"])}const oe=L(H,[["render",te],["__scopeId","data-v-cd1cd314"]]),re={name:"RolePermissionsDialog",mixins:[B],props:{modelValue:{type:Boolean,required:!0},role:{type:Object,default:null},groupedPermissions:{type:Object,default:()=>({})}},emits:["update:modelValue","save","error"],data(){return{selectedPermissions:[],saving:!1}},computed:{safeGroupedPermissions(){if(!this.groupedPermissions||typeof this.groupedPermissions!="object")return{};const s={};return Object.keys(this.groupedPermissions).forEach(e=>{Array.isArray(this.groupedPermissions[e])&&(s[e]=this.groupedPermissions[e])}),s}},watch:{role:{handler(s){s?this.selectedPermissions=s.permissions?s.permissions.map(e=>e.id||e):[]:this.selectedPermissions=[]},immediate:!0},modelValue(s){s||(this.selectedPermissions=[])}},methods:{isPermissionSelected(s){return this.selectedPermissions.includes(s)},togglePermission(s){const e=this.selectedPermissions.indexOf(s);e>-1?this.selectedPermissions.splice(e,1):this.selectedPermissions.push(s)},close(){this.$emit("update:modelValue",!1)},async onSave(){if(!this.role){this.showError("No role selected");return}this.saving=!0;try{await this.$axios.put(`/api/v1/roles/${this.role.id}/permissions`,{permissions:this.selectedPermissions},{headers:this.getAuthHeaders()}),this.showSuccess("Permissions updated successfully"),this.$emit("save",{roleId:this.role.id,permissions:this.selectedPermissions}),this.close()}catch(s){this.handleApiError(s,"Error saving permissions"),this.$emit("error",s)}finally{this.saving=!1}}}},le={key:0,class:"text-center py-4"},ne={key:1},ae={class:"text-h6 mb-3"};function de(s,e,d,g,l,t){const P=n("v-chip"),R=n("v-card-title"),b=n("v-checkbox"),z=n("v-col"),v=n("v-row"),A=n("v-alert"),E=n("v-card-text"),D=n("v-spacer"),k=n("v-btn"),_=n("v-card-actions"),C=n("v-card"),G=n("v-dialog");return a(),h(G,{"model-value":d.modelValue,"onUpdate:modelValue":e[0]||(e[0]=y=>s.$emit("update:modelValue",y)),"max-width":"800",persistent:""},{default:r(()=>[i(C,null,{default:r(()=>[i(R,null,{default:r(()=>{var y,x;return[m(" Manage Permissions - "+c((y=d.role)==null?void 0:y.name)+" ",1),(x=d.role)!=null&&x.is_system?(a(),h(P,{key:0,color:"warning",size:"small",class:"ml-2"},{default:r(()=>e[1]||(e[1]=[m(" System Role ")])),_:1,__:[1]})):O("",!0)]}),_:1}),i(E,null,{default:r(()=>[Object.keys(t.safeGroupedPermissions).length===0?(a(),p("div",le,e[2]||(e[2]=[o("p",{class:"text-grey"},"No permissions available",-1)]))):(a(),p("div",ne,[(a(!0),p(V,null,U(t.safeGroupedPermissions,(y,x)=>(a(),p("div",{key:x,class:"mb-6"},[o("h3",ae,c(x.charAt(0).toUpperCase()+x.slice(1)),1),Array.isArray(y)?(a(),h(v,{key:0},{default:r(()=>[(a(!0),p(V,null,U(y,S=>(a(),h(z,{key:S.id,cols:"12",md:"6"},{default:r(()=>[i(b,{"model-value":t.isPermissionSelected(S.id),"onUpdate:modelValue":u=>t.togglePermission(S.id),label:S.name,hint:S.description,"persistent-hint":"",density:"compact"},null,8,["model-value","onUpdate:modelValue","label","hint"])]),_:2},1024))),128))]),_:2},1024)):(a(),h(A,{key:1,type:"warning",variant:"tonal",class:"mt-2"},{default:r(()=>e[3]||(e[3]=[m(" Invalid permission group structure ")])),_:1,__:[3]}))]))),128))]))]),_:1}),i(_,null,{default:r(()=>[i(D),i(k,{onClick:t.close,variant:"text"},{default:r(()=>e[4]||(e[4]=[m("Cancel")])),_:1,__:[4]},8,["onClick"]),i(k,{onClick:t.onSave,color:"primary",loading:l.saving},{default:r(()=>e[5]||(e[5]=[m(" Save Permissions ")])),_:1,__:[5]},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["model-value"])}const me=L(re,[["render",de]]),ue={components:{PaginationControls:M,RoleDialog:oe,RolePermissionsDialog:me},mixins:[B],data(){return{roles:[],permissions:[],groupedPermissions:{},dialog:!1,permissionDialog:!1,editingRole:null,selectedRole:null,activeFilter:null,activeOptions:[{title:"Active",value:!0},{title:"Inactive",value:!1}],currentPage:I.currentPage,perPage:I.perPage,perPageOptions:I.perPageOptions,pagination:{...I.pagination}}},computed:{},async mounted(){await this.loadRoles(),await this.loadPermissions()},methods:{async loadRoles(){var s;try{this.loading=!0;const e=this.buildPaginationParams();this.perPage==="all"&&(e.per_page=999999),this.search&&(e.search=this.search),this.activeFilter!==null&&(e.active=this.activeFilter);const d=await this.$axios.get("/api/v1/roles",{params:e,headers:this.getAuthHeaders()});d.data.data?(this.roles=d.data.data||[],this.updatePagination(d.data)):(this.roles=d.data||[],N.updatePagination(this,{current_page:1,last_page:1,per_page:this.roles.length,total:this.roles.length})),this.roles.length===0&&console.warn("No roles found. Run the seeder to create default roles.")}catch(e){((s=e.response)==null?void 0:s.status)===404?this.handleApiError(e,"Roles endpoint not found. Please ensure migrations and seeders have run."):this.handleApiError(e,"Failed to load roles")}finally{this.loading=!1}},async loadPermissions(){try{const s=await this.$axios.get("/api/v1/permissions",{params:{grouped:!0},headers:this.getAuthHeaders()});let e=s.data;if(s.data&&s.data.data&&(e=s.data.data),!e||typeof e!="object"){console.warn("Invalid permissions response structure:",e),this.groupedPermissions={},this.permissions=[];return}Array.isArray(e)?(this.groupedPermissions={},e.forEach(d=>{const g=d.group||d.group_name||"general";this.groupedPermissions[g]||(this.groupedPermissions[g]=[]),this.groupedPermissions[g].push(d)})):this.groupedPermissions=e,this.permissions=[],Object.values(this.groupedPermissions).forEach(d=>{Array.isArray(d)?this.permissions.push(...d):console.warn("Invalid group structure:",d)})}catch(s){console.error("Error loading permissions:",s),this.groupedPermissions={},this.permissions=[],this.handleApiError(s,"Failed to load permissions")}},async openDialog(s){Object.keys(this.groupedPermissions).length===0&&await this.loadPermissions(),this.editingRole=s,this.dialog=!0},async onRoleSaved(){this.editingRole=null,await this.loadRoles()},async deleteRole(s){if(s.is_system){this.showError("System roles cannot be deleted");return}if(confirm(`Are you sure you want to delete the role "${s.name}"?`))try{await this.$axios.delete(`/api/v1/roles/${s.id}`,{headers:this.getAuthHeaders()}),this.showSuccess("Role deleted successfully"),await this.loadRoles()}catch(e){this.handleApiError(e,"Error deleting role")}},async openPermissionDialog(s){Object.keys(this.groupedPermissions).length===0&&await this.loadPermissions(),this.selectedRole=s,this.permissionDialog=!0},async onPermissionsSaved(){this.selectedRole=null,await this.loadRoles()},buildPaginationParams(s={}){return N.buildPaginationParams(this.currentPage,this.perPage,s,this.sortBy,this.sortDirection)},updatePagination(s){N.updatePagination(this,s)},resetPagination(){N.resetPagination(this)},onPerPageChange(){this.resetPagination(),this.loadRoles()},onPerPageUpdate(s){this.perPage=s,this.onPerPageChange()},onPageChange(s){this.currentPage=s,this.loadRoles()},onSort(s){this.handleSort(s),this.currentPage=1,this.loadRoles()}}},ce={class:"page-header"},pe={class:"text-caption text-grey"},he={class:"sortable-header"},fe={class:"sortable-header"},ge={class:"sortable-header"},ve={class:"d-flex"},_e={class:"font-weight-medium"},ye={class:"text-caption text-grey"},Pe={key:1,class:"text-caption"},be={key:0},ke={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},xe={class:"text-caption text-grey"},we={key:0},Se={key:0},Re={key:1},Ce={key:1};function Ve(s,e,d,g,l,t){const P=n("v-btn"),R=n("v-select"),b=n("v-col"),z=n("v-text-field"),v=n("v-row"),A=n("v-card-text"),E=n("v-card"),D=n("v-card-title"),k=n("v-icon"),_=n("v-skeleton-loader"),C=n("v-chip"),G=n("v-table"),y=n("PaginationControls"),x=n("RoleDialog"),S=n("RolePermissionsDialog");return a(),p("div",null,[o("div",ce,[e[10]||(e[10]=o("h1",{class:"text-h4 page-title"},"Role Management",-1)),i(P,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=u=>t.openDialog(null)),class:"add-button"},{default:r(()=>e[9]||(e[9]=[m(" Add New Role ")])),_:1,__:[9]})]),i(E,{class:"mb-4"},{default:r(()=>[i(A,null,{default:r(()=>[i(v,null,{default:r(()=>[i(b,{cols:"12",md:"4"},{default:r(()=>[i(R,{modelValue:l.activeFilter,"onUpdate:modelValue":[e[1]||(e[1]=u=>l.activeFilter=u),t.loadRoles],items:l.activeOptions,label:"Filter by Status","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),i(b,{cols:"12",md:"8"},{default:r(()=>[i(z,{modelValue:s.search,"onUpdate:modelValue":[e[2]||(e[2]=u=>s.search=u),t.loadRoles],label:"Search roles","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),i(E,null,{default:r(()=>[i(D,{class:"d-flex justify-space-between align-center"},{default:r(()=>[e[12]||(e[12]=o("span",null,"Roles",-1)),o("span",pe,[e[11]||(e[11]=m(" Total Records: ")),o("strong",null,c(l.pagination.total||0),1)])]),_:1,__:[12]}),i(A,null,{default:r(()=>[i(G,null,{default:r(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:e[3]||(e[3]=u=>t.onSort("name"))},[o("div",he,[e[14]||(e[14]=o("span",null,"Name",-1)),s.sortBy==="name"?(a(),h(k,{key:0,size:"18",class:"sort-icon active"},{default:r(()=>[m(c(s.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),h(k,{key:1,size:"18",class:"sort-icon inactive"},{default:r(()=>e[13]||(e[13]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[13]}))])]),o("th",{class:"sortable",onClick:e[4]||(e[4]=u=>t.onSort("slug"))},[o("div",fe,[e[16]||(e[16]=o("span",null,"Slug",-1)),s.sortBy==="slug"?(a(),h(k,{key:0,size:"18",class:"sort-icon active"},{default:r(()=>[m(c(s.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),h(k,{key:1,size:"18",class:"sort-icon inactive"},{default:r(()=>e[15]||(e[15]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[15]}))])]),e[19]||(e[19]=o("th",null,"Permissions",-1)),o("th",{class:"sortable",onClick:e[5]||(e[5]=u=>t.onSort("is_active"))},[o("div",ge,[e[18]||(e[18]=o("span",null,"Status",-1)),s.sortBy==="is_active"?(a(),h(k,{key:0,size:"18",class:"sort-icon active"},{default:r(()=>[m(c(s.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(a(),h(k,{key:1,size:"18",class:"sort-icon inactive"},{default:r(()=>e[17]||(e[17]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[17]}))])]),e[20]||(e[20]=o("th",null,"Type",-1)),e[21]||(e[21]=o("th",null,"Actions",-1))])]),o("tbody",null,[s.loading?(a(),p(V,{key:0},U(5,u=>o("tr",{key:`skeleton-${u}`},[o("td",null,[i(_,{type:"text",width:"150"})]),o("td",null,[i(_,{type:"text",width:"120"})]),o("td",null,[i(_,{type:"chip",width:"80",height:"24"})]),o("td",null,[i(_,{type:"chip",width:"80",height:"24"})]),o("td",null,[i(_,{type:"chip",width:"70",height:"24"})]),o("td",null,[o("div",ve,[i(_,{type:"button",width:"32",height:"32",class:"mr-1"}),i(_,{type:"button",width:"32",height:"32",class:"mr-1"}),i(_,{type:"button",width:"32",height:"32"})])])])),64)):(a(),p(V,{key:1},[(a(!0),p(V,null,U(l.roles,u=>(a(),p("tr",{key:u.id},[o("td",null,[o("div",_e,c(u.name),1),o("div",ye,c(u.description||"No description"),1)]),o("td",null,[i(C,{size:"small",variant:"outlined"},{default:r(()=>[m(c(u.slug),1)]),_:2},1024)]),o("td",null,[i(C,{size:"small",color:"primary",variant:"text"},{default:r(()=>[m(c(u.permissions?u.permissions.length:0)+" permissions ",1)]),_:2},1024)]),o("td",null,[i(C,{color:u.is_active?"success":"error",size:"small"},{default:r(()=>[m(c(u.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),o("td",null,[u.is_system?(a(),h(C,{key:0,color:"warning",size:"small"},{default:r(()=>e[22]||(e[22]=[m(" System ")])),_:1,__:[22]})):(a(),p("span",Pe,"Custom"))]),o("td",null,[i(P,{size:"small",icon:"mdi-pencil",onClick:j=>t.openDialog(u),variant:"text",disabled:u.is_system},null,8,["onClick","disabled"]),i(P,{size:"small",icon:"mdi-shield-key",onClick:j=>t.openPermissionDialog(u),variant:"text"},null,8,["onClick"]),i(P,{size:"small",icon:"mdi-delete",onClick:j=>t.deleteRole(u),variant:"text",color:"error",disabled:u.is_system},null,8,["onClick","disabled"])])]))),128)),l.roles.length===0?(a(),p("tr",be,e[23]||(e[23]=[o("td",{colspan:"6",class:"text-center py-4"},"No roles found",-1)]))):O("",!0)],64))])]),_:1}),o("div",ke,[o("div",xe,[l.roles.length>0&&l.pagination.total>0?(a(),p("span",we,[l.perPage==="all"?(a(),p("span",Se,[e[24]||(e[24]=m(" Showing ")),o("strong",null,"all "+c(l.pagination.total.toLocaleString()),1),e[25]||(e[25]=m(" records "))])):(a(),p("span",Re,[e[26]||(e[26]=m(" Showing ")),o("strong",null,c((l.currentPage-1)*l.perPage+1),1),e[27]||(e[27]=m(" to ")),o("strong",null,c(Math.min(l.currentPage*l.perPage,l.pagination.total)),1),e[28]||(e[28]=m(" of ")),o("strong",null,c(l.pagination.total.toLocaleString()),1),e[29]||(e[29]=m(" records "))]))])):(a(),p("span",Ce,"No records found"))]),i(y,{modelValue:l.currentPage,"onUpdate:modelValue":e[6]||(e[6]=u=>l.currentPage=u),pagination:l.pagination,"per-page-value":l.perPage,"per-page-options":l.perPageOptions,"onUpdate:perPage":t.onPerPageUpdate,onPageChange:t.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1}),i(x,{modelValue:l.dialog,"onUpdate:modelValue":e[7]||(e[7]=u=>l.dialog=u),role:l.editingRole,"grouped-permissions":l.groupedPermissions,onSave:t.onRoleSaved},null,8,["modelValue","role","grouped-permissions","onSave"]),i(S,{modelValue:l.permissionDialog,"onUpdate:modelValue":e[8]||(e[8]=u=>l.permissionDialog=u),role:l.selectedRole,"grouped-permissions":l.groupedPermissions,onSave:t.onPermissionsSaved},null,8,["modelValue","role","grouped-permissions","onSave"])])}const ze=L(ue,[["render",Ve]]);export{ze as default};
