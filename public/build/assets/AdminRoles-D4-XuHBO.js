import{c as O}from"./commonMixin-LD1l2-5e.js";import{p as L,P as M}from"./PaginationControls-CGFLaHsK.js";import{_ as I,d as f,w as o,a as i,r,f as m,t as c,e as j,b as t,g as q,c as p,F as C,y as z,o as n}from"./app-CYStQJ0f.js";const T={name:"RoleDialog",mixins:[O],props:{modelValue:{type:Boolean,required:!0},role:{type:Object,default:null},groupedPermissions:{type:Object,default:()=>({})}},emits:["update:modelValue","save","error"],data(){return{form:{name:"",slug:"",description:"",is_active:!0,order:0,permissions:[]},permissionSearch:"",saving:!1,rules:{required:s=>!!s||"This field is required"}}},computed:{editingRole(){return!!this.role},safeGroupedPermissions(){if(!this.groupedPermissions||typeof this.groupedPermissions!="object")return{};const s={};return Object.keys(this.groupedPermissions).forEach(e=>{Array.isArray(this.groupedPermissions[e])&&(s[e]=this.groupedPermissions[e])}),s},filteredGroupedPermissions(){if(!this.permissionSearch)return this.safeGroupedPermissions;const s=this.permissionSearch.toLowerCase(),e={};return Object.keys(this.safeGroupedPermissions).forEach(a=>{const g=this.safeGroupedPermissions[a];if(Array.isArray(g)){const d=g.filter(l=>{const b=(l.name||"").toLowerCase(),A=(l.description||"").toLowerCase(),P=(l.slug||"").toLowerCase();return b.includes(s)||A.includes(s)||P.includes(s)});d.length>0&&(e[a]=d)}}),e},allPermissions(){const s=[];return Object.values(this.safeGroupedPermissions).forEach(e=>{Array.isArray(e)&&s.push(...e)}),s}},watch:{role:{handler(s){if(s){let e=[];s.permissions&&(e=s.permissions.map(a=>typeof a=="object"&&a.id?a.id:a)),this.form={name:s.name||"",slug:s.slug||"",description:s.description||"",is_active:s.is_active!==void 0?s.is_active:!0,order:s.order||0,permissions:e}}else this.resetForm()},immediate:!0},modelValue(s){s||this.resetForm()}},methods:{resetForm(){this.form={name:"",slug:"",description:"",is_active:!0,order:0,permissions:[]},this.permissionSearch="",this.$refs.roleForm&&this.$refs.roleForm.resetValidation()},autoGenerateSlugFromName(){!this.form.slug&&this.form.name&&!this.editingRole&&this.generateSlugFromName()},generateSlugFromName(){this.form.name&&(this.form.slug=this.form.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))},isFormPermissionSelected(s){return this.form.permissions.includes(s)},toggleFormPermission(s){const e=this.form.permissions.indexOf(s);e>-1?this.form.permissions.splice(e,1):this.form.permissions.push(s)},getSelectedCountInGroup(s){const e=this.filteredGroupedPermissions[s]||this.safeGroupedPermissions[s];return!e||!Array.isArray(e)?0:e.filter(a=>this.form.permissions.includes(a.id)).length},selectAllPermissions(){this.allPermissions.forEach(s=>{this.form.permissions.includes(s.id)||this.form.permissions.push(s.id)})},deselectAllPermissions(){this.form.permissions=[]},selectAllInGroup(s){const e=this.filteredGroupedPermissions[s]||this.safeGroupedPermissions[s];e&&Array.isArray(e)&&e.forEach(a=>{this.form.permissions.includes(a.id)||this.form.permissions.push(a.id)})},deselectAllInGroup(s){const e=this.filteredGroupedPermissions[s]||this.safeGroupedPermissions[s];if(e&&Array.isArray(e)){const a=e.map(g=>g.id);this.form.permissions=this.form.permissions.filter(g=>!a.includes(g))}},close(){this.$emit("update:modelValue",!1)},async onSave(){if(!this.$refs.roleForm){this.showError("Form reference not found");return}if(this.$refs.roleForm.validate()){!this.form.slug&&this.form.name&&(this.form.slug=this.form.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")),this.saving=!0;try{const s=this.editingRole?`/api/v1/roles/${this.role.id}`:"/api/v1/roles",e=this.editingRole?"put":"post",a={name:this.form.name.trim(),description:this.form.description?this.form.description.trim():null,is_active:this.form.is_active===!0||this.form.is_active==="true"||this.form.is_active===1,order:parseInt(this.form.order)||0};this.editingRole?this.form.slug!==this.role.slug&&(this.form.slug&&this.form.slug.trim()?a.slug=this.form.slug.trim():a.slug=""):this.form.slug&&this.form.slug.trim()&&(a.slug=this.form.slug.trim()),this.form.permissions&&Array.isArray(this.form.permissions)&&(a.permissions=this.form.permissions),await this.$axios[e](s,a,{headers:this.getAuthHeaders()}),this.showSuccess(this.editingRole?"Role updated successfully":"Role created successfully"),this.$emit("save",a),this.close()}catch(s){console.error("Error saving role:",s),this.handleApiError(s,"Error saving role"),this.$emit("error",s)}finally{this.saving=!1}}}}},H={class:"mb-2"},J={class:"d-flex justify-space-between align-center mb-2"},K={class:"d-flex gap-2"},Q={key:0,class:"permissions-container mb-4"},W={class:"d-flex align-center gap-2"},X={class:"text-h6"},Y={class:"d-flex gap-1"},Z={class:"font-weight-medium"},$={key:0,class:"text-caption text-grey"},ee={key:0},se={key:1};function ie(s,e,a,g,d,l){const b=r("v-card-title"),A=r("v-alert"),P=r("v-text-field"),D=r("v-icon"),v=r("v-btn"),x=r("v-textarea"),E=r("v-switch"),G=r("v-divider"),k=r("v-chip"),_=r("v-checkbox"),R=r("v-col"),U=r("v-row"),y=r("v-card-text"),w=r("v-card"),V=r("v-form"),u=r("v-spacer"),N=r("v-card-actions"),B=r("v-dialog");return n(),f(B,{"model-value":a.modelValue,"onUpdate:modelValue":e[6]||(e[6]=h=>s.$emit("update:modelValue",h)),"max-width":"900",persistent:""},{default:o(()=>[i(w,null,{default:o(()=>[i(b,null,{default:o(()=>[m(c(l.editingRole?"Edit Role":"Add New Role"),1)]),_:1}),i(y,null,{default:o(()=>[l.editingRole&&l.editingRole.is_system?(n(),f(A,{key:0,type:"info",variant:"tonal",class:"mb-4"},{default:o(()=>e[7]||(e[7]=[t("strong",null,"System Role:",-1),m(" This is a system role. Core properties (name, slug, description, status, order) cannot be modified. Only permissions can be updated using the permissions button. ")])),_:1,__:[7]})):j("",!0),i(V,{ref:"roleForm",onSubmit:q(l.onSave,["prevent"])},{default:o(()=>[i(P,{modelValue:d.form.name,"onUpdate:modelValue":e[0]||(e[0]=h=>d.form.name=h),placeholder:"Enter role name (e.g., Administrator, Editor)",rules:[d.rules.required],required:"",hint:"Display name for the role","persistent-hint":"",variant:"outlined",density:"comfortable","hide-details":"auto",class:"mb-4",disabled:l.editingRole&&l.editingRole.is_system,onBlur:l.autoGenerateSlugFromName},{label:o(()=>e[8]||(e[8]=[m(" Role Name "),t("span",{class:"text-error",style:{"font-size":"1.2em","font-weight":"bold"}},"*",-1)])),_:1},8,["modelValue","rules","disabled","onBlur"]),i(P,{modelValue:d.form.slug,"onUpdate:modelValue":e[1]||(e[1]=h=>d.form.slug=h),label:"Slug",placeholder:"Enter slug (e.g., administrator, editor) or click generate to auto-generate",hint:"URL-friendly identifier (auto-generated from name if empty)","persistent-hint":"",variant:"outlined",density:"comfortable","hide-details":"auto","prepend-inner-icon":"mdi-link-variant",class:"mb-4",disabled:l.editingRole&&l.editingRole.is_system},{"append-inner":o(()=>[i(v,{icon:"",variant:"text",size:"small",color:"primary",disabled:!d.form.name||l.editingRole&&l.editingRole.is_system,onClick:l.generateSlugFromName,title:d.form.name?"Generate slug from role name":"Enter role name first"},{default:o(()=>[i(D,{size:"small"},{default:o(()=>e[9]||(e[9]=[m("mdi-refresh")])),_:1,__:[9]})]),_:1},8,["disabled","onClick","title"])]),_:1},8,["modelValue","disabled"]),i(x,{modelValue:d.form.description,"onUpdate:modelValue":e[2]||(e[2]=h=>d.form.description=h),label:"Description",placeholder:"Enter a brief description of the role and its purpose (optional)",hint:"Brief description of the role","persistent-hint":"",variant:"outlined",density:"comfortable",rows:"2","hide-details":"auto",class:"mb-4",disabled:l.editingRole&&l.editingRole.is_system},null,8,["modelValue","disabled"]),i(P,{modelValue:d.form.order,"onUpdate:modelValue":e[3]||(e[3]=h=>d.form.order=h),modelModifiers:{number:!0},label:"Order",type:"number",placeholder:"Enter display order (e.g., 0, 1, 2)",hint:"Display order (lower numbers first)","persistent-hint":"",variant:"outlined",density:"comfortable","hide-details":"auto",class:"mb-4",disabled:l.editingRole&&l.editingRole.is_system},null,8,["modelValue","disabled"]),i(E,{modelValue:d.form.is_active,"onUpdate:modelValue":e[4]||(e[4]=h=>d.form.is_active=h),label:"Active",hint:"Inactive roles cannot be assigned to users","persistent-hint":"",class:"mb-4",disabled:l.editingRole&&l.editingRole.is_system},null,8,["modelValue","disabled"]),i(G,{class:"my-4"}),t("div",H,[t("div",J,[e[12]||(e[12]=t("div",null,[t("h3",{class:"text-h6 mb-1"},"Permissions"),t("p",{class:"text-caption text-grey"},"Select permissions to assign to this role")],-1)),t("div",K,[i(v,{size:"small",variant:"outlined",onClick:l.selectAllPermissions,color:"primary"},{default:o(()=>e[10]||(e[10]=[m(" Select All ")])),_:1,__:[10]},8,["onClick"]),i(v,{size:"small",variant:"outlined",onClick:l.deselectAllPermissions,color:"grey"},{default:o(()=>e[11]||(e[11]=[m(" Deselect All ")])),_:1,__:[11]},8,["onClick"])])])]),i(P,{modelValue:d.permissionSearch,"onUpdate:modelValue":e[5]||(e[5]=h=>d.permissionSearch=h),label:"Search permissions",placeholder:"Search by permission name, description, or slug","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",hint:"Type to filter permissions by name, description, or slug","persistent-hint":"","hide-details":"auto",class:"mb-4"},null,8,["modelValue"]),Object.keys(l.filteredGroupedPermissions).length>0?(n(),p("div",Q,[(n(!0),p(C,null,z(l.filteredGroupedPermissions,(h,F)=>(n(),p("div",{key:F,class:"permission-group mb-4"},[i(w,{variant:"outlined"},{default:o(()=>[i(b,{class:"d-flex justify-space-between align-center py-2"},{default:o(()=>[t("div",W,[t("span",X,c(F.charAt(0).toUpperCase()+F.slice(1)),1),i(k,{size:"small",color:"primary",variant:"flat"},{default:o(()=>[m(c(l.getSelectedCountInGroup(F))+" / "+c(h.length)+" selected ",1)]),_:2},1024)]),t("div",Y,[i(v,{size:"x-small",variant:"text",onClick:S=>l.selectAllInGroup(F),color:"primary"},{default:o(()=>e[13]||(e[13]=[m(" Select All ")])),_:2,__:[13]},1032,["onClick"]),i(v,{size:"x-small",variant:"text",onClick:S=>l.deselectAllInGroup(F),color:"grey"},{default:o(()=>e[14]||(e[14]=[m(" Clear ")])),_:2,__:[14]},1032,["onClick"])])]),_:2},1024),i(y,null,{default:o(()=>[Array.isArray(h)?(n(),f(U,{key:0},{default:o(()=>[(n(!0),p(C,null,z(h,S=>(n(),f(R,{key:S.id,cols:"12",md:"6",lg:"4"},{default:o(()=>[i(_,{"model-value":l.isFormPermissionSelected(S.id),"onUpdate:modelValue":Ce=>l.toggleFormPermission(S.id),label:S.name,hint:S.description,"persistent-hint":"",density:"comfortable",color:"primary"},{label:o(()=>[t("div",null,[t("div",Z,c(S.name),1),S.description?(n(),p("div",$,c(S.description),1)):j("",!0)])]),_:2},1032,["model-value","onUpdate:modelValue","label","hint"])]),_:2},1024))),128))]),_:2},1024)):j("",!0)]),_:2},1024)]),_:2},1024)]))),128))])):(n(),f(A,{key:1,type:"info",variant:"tonal",class:"mb-4"},{default:o(()=>[d.permissionSearch?(n(),p("div",ee,' No permissions found matching "'+c(d.permissionSearch)+'" ',1)):(n(),p("div",se," No permissions available. Please ensure permissions are loaded. "))]),_:1}))]),_:1},8,["onSubmit"])]),_:1}),i(N,null,{default:o(()=>[i(u),i(v,{onClick:l.close,variant:"text"},{default:o(()=>e[15]||(e[15]=[m("Cancel")])),_:1,__:[15]},8,["onClick"]),l.editingRole&&l.editingRole.is_system?(n(),f(v,{key:0,onClick:l.close,color:"primary"},{default:o(()=>e[16]||(e[16]=[m(" Close ")])),_:1,__:[16]},8,["onClick"])):(n(),f(v,{key:1,onClick:l.onSave,color:"primary",loading:d.saving},{default:o(()=>[m(c(l.editingRole?"Update":"Create"),1)]),_:1},8,["onClick","loading"]))]),_:1})]),_:1})]),_:1},8,["model-value"])}const te=I(T,[["render",ie],["__scopeId","data-v-cd1cd314"]]),oe={name:"RolePermissionsDialog",mixins:[O],props:{modelValue:{type:Boolean,required:!0},role:{type:Object,default:null},groupedPermissions:{type:Object,default:()=>({})}},emits:["update:modelValue","save","error"],data(){return{selectedPermissions:[],saving:!1}},computed:{safeGroupedPermissions(){if(!this.groupedPermissions||typeof this.groupedPermissions!="object")return{};const s={};return Object.keys(this.groupedPermissions).forEach(e=>{Array.isArray(this.groupedPermissions[e])&&(s[e]=this.groupedPermissions[e])}),s}},watch:{role:{handler(s){s?this.selectedPermissions=s.permissions?s.permissions.map(e=>e.id||e):[]:this.selectedPermissions=[]},immediate:!0},modelValue(s){s||(this.selectedPermissions=[])}},methods:{isPermissionSelected(s){return this.selectedPermissions.includes(s)},togglePermission(s){const e=this.selectedPermissions.indexOf(s);e>-1?this.selectedPermissions.splice(e,1):this.selectedPermissions.push(s)},close(){this.$emit("update:modelValue",!1)},async onSave(){if(!this.role){this.showError("No role selected");return}this.saving=!0;try{await this.$axios.put(`/api/v1/roles/${this.role.id}/permissions`,{permissions:this.selectedPermissions},{headers:this.getAuthHeaders()}),this.showSuccess("Permissions updated successfully"),this.$emit("save",{roleId:this.role.id,permissions:this.selectedPermissions}),this.close()}catch(s){this.handleApiError(s,"Error saving permissions"),this.$emit("error",s)}finally{this.saving=!1}}}},le={key:0,class:"text-center py-4"},re={key:1},ne={class:"text-h6 mb-3"};function ae(s,e,a,g,d,l){const b=r("v-chip"),A=r("v-card-title"),P=r("v-checkbox"),D=r("v-col"),v=r("v-row"),x=r("v-alert"),E=r("v-card-text"),G=r("v-spacer"),k=r("v-btn"),_=r("v-card-actions"),R=r("v-card"),U=r("v-dialog");return n(),f(U,{"model-value":a.modelValue,"onUpdate:modelValue":e[0]||(e[0]=y=>s.$emit("update:modelValue",y)),"max-width":"800",persistent:""},{default:o(()=>[i(R,null,{default:o(()=>[i(A,null,{default:o(()=>{var y,w;return[m(" Manage Permissions - "+c((y=a.role)==null?void 0:y.name)+" ",1),(w=a.role)!=null&&w.is_system?(n(),f(b,{key:0,color:"warning",size:"small",class:"ml-2"},{default:o(()=>e[1]||(e[1]=[m(" System Role ")])),_:1,__:[1]})):j("",!0)]}),_:1}),i(E,null,{default:o(()=>[Object.keys(l.safeGroupedPermissions).length===0?(n(),p("div",le,e[2]||(e[2]=[t("p",{class:"text-grey"},"No permissions available",-1)]))):(n(),p("div",re,[(n(!0),p(C,null,z(l.safeGroupedPermissions,(y,w)=>(n(),p("div",{key:w,class:"mb-6"},[t("h3",ne,c(w.charAt(0).toUpperCase()+w.slice(1)),1),Array.isArray(y)?(n(),f(v,{key:0},{default:o(()=>[(n(!0),p(C,null,z(y,V=>(n(),f(D,{key:V.id,cols:"12",md:"6"},{default:o(()=>[i(P,{"model-value":l.isPermissionSelected(V.id),"onUpdate:modelValue":u=>l.togglePermission(V.id),label:V.name,hint:V.description,"persistent-hint":"",density:"compact"},null,8,["model-value","onUpdate:modelValue","label","hint"])]),_:2},1024))),128))]),_:2},1024)):(n(),f(x,{key:1,type:"warning",variant:"tonal",class:"mt-2"},{default:o(()=>e[3]||(e[3]=[m(" Invalid permission group structure ")])),_:1,__:[3]}))]))),128))]))]),_:1}),i(_,null,{default:o(()=>[i(G),i(k,{onClick:l.close,variant:"text"},{default:o(()=>e[4]||(e[4]=[m("Cancel")])),_:1,__:[4]},8,["onClick"]),i(k,{onClick:l.onSave,color:"primary",loading:d.saving},{default:o(()=>e[5]||(e[5]=[m(" Save Permissions ")])),_:1,__:[5]},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["model-value"])}const de=I(oe,[["render",ae]]),me={components:{PaginationControls:M,RoleDialog:te,RolePermissionsDialog:de},mixins:[O,L],data(){return{roles:[],permissions:[],groupedPermissions:{},dialog:!1,permissionDialog:!1,editingRole:null,selectedRole:null,activeFilter:null,activeOptions:[{title:"Active",value:!0},{title:"Inactive",value:!1}]}},computed:{},async mounted(){await this.loadRoles(),await this.loadPermissions()},methods:{async loadRoles(){var s;try{this.loading=!0;const e=this.buildPaginationParams();this.perPage==="all"&&(e.per_page=999999),this.search&&(e.search=this.search),this.activeFilter!==null&&(e.active=this.activeFilter);const a=await this.$axios.get("/api/v1/roles",{params:e,headers:this.getAuthHeaders()});a.data.data?(this.roles=a.data.data||[],this.updatePagination(a.data)):(this.roles=a.data||[],this.updatePagination({current_page:1,last_page:1,per_page:this.roles.length,total:this.roles.length})),this.roles.length===0&&console.warn("No roles found. Run the seeder to create default roles.")}catch(e){((s=e.response)==null?void 0:s.status)===404?this.handleApiError(e,"Roles endpoint not found. Please ensure migrations and seeders have run."):this.handleApiError(e,"Failed to load roles")}finally{this.loading=!1}},async loadPermissions(){try{const s=await this.$axios.get("/api/v1/permissions",{params:{grouped:!0},headers:this.getAuthHeaders()});let e=s.data;if(s.data&&s.data.data&&(e=s.data.data),!e||typeof e!="object"){console.warn("Invalid permissions response structure:",e),this.groupedPermissions={},this.permissions=[];return}Array.isArray(e)?(this.groupedPermissions={},e.forEach(a=>{const g=a.group||a.group_name||"general";this.groupedPermissions[g]||(this.groupedPermissions[g]=[]),this.groupedPermissions[g].push(a)})):this.groupedPermissions=e,this.permissions=[],Object.values(this.groupedPermissions).forEach(a=>{Array.isArray(a)?this.permissions.push(...a):console.warn("Invalid group structure:",a)})}catch(s){console.error("Error loading permissions:",s),this.groupedPermissions={},this.permissions=[],this.handleApiError(s,"Failed to load permissions")}},async openDialog(s){Object.keys(this.groupedPermissions).length===0&&await this.loadPermissions(),this.editingRole=s,this.dialog=!0},async onRoleSaved(){this.editingRole=null,await this.loadRoles()},async deleteRole(s){if(s.is_system){this.showError("System roles cannot be deleted");return}if(confirm(`Are you sure you want to delete the role "${s.name}"?`))try{await this.$axios.delete(`/api/v1/roles/${s.id}`,{headers:this.getAuthHeaders()}),this.showSuccess("Role deleted successfully"),await this.loadRoles()}catch(e){this.handleApiError(e,"Error deleting role")}},async openPermissionDialog(s){Object.keys(this.groupedPermissions).length===0&&await this.loadPermissions(),this.selectedRole=s,this.permissionDialog=!0},async onPermissionsSaved(){this.selectedRole=null,await this.loadRoles()}}},ue={class:"page-header"},ce={class:"text-caption text-grey"},pe={class:"sortable-header"},fe={class:"sortable-header"},he={class:"sortable-header"},ge={class:"d-flex"},ve={class:"font-weight-medium"},_e={class:"text-caption text-grey"},ye={key:1,class:"text-caption"},be={key:0},Pe={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},ke={class:"text-caption text-grey"},we={key:0},Se={key:0},Ve={key:1},Ae={key:1};function Re(s,e,a,g,d,l){const b=r("v-btn"),A=r("v-select"),P=r("v-col"),D=r("v-text-field"),v=r("v-row"),x=r("v-card-text"),E=r("v-card"),G=r("v-card-title"),k=r("v-icon"),_=r("v-skeleton-loader"),R=r("v-chip"),U=r("v-table"),y=r("PaginationControls"),w=r("RoleDialog"),V=r("RolePermissionsDialog");return n(),p("div",null,[t("div",ue,[e[10]||(e[10]=t("h1",{class:"text-h4 page-title"},"Role Management",-1)),i(b,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=u=>l.openDialog(null)),class:"add-button"},{default:o(()=>e[9]||(e[9]=[m(" Add New Role ")])),_:1,__:[9]})]),i(E,{class:"mb-4"},{default:o(()=>[i(x,null,{default:o(()=>[i(v,null,{default:o(()=>[i(P,{cols:"12",md:"4"},{default:o(()=>[i(A,{modelValue:d.activeFilter,"onUpdate:modelValue":[e[1]||(e[1]=u=>d.activeFilter=u),l.loadRoles],items:d.activeOptions,label:"Filter by Status","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),i(P,{cols:"12",md:"8"},{default:o(()=>[i(D,{modelValue:s.search,"onUpdate:modelValue":[e[2]||(e[2]=u=>s.search=u),l.loadRoles],label:"Search roles","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),i(E,null,{default:o(()=>[i(G,{class:"d-flex justify-space-between align-center"},{default:o(()=>[e[12]||(e[12]=t("span",null,"Roles",-1)),t("span",ce,[e[11]||(e[11]=m(" Total Records: ")),t("strong",null,c((s.pagination.total||0).toLocaleString()),1)])]),_:1,__:[12]}),i(x,null,{default:o(()=>[i(U,null,{default:o(()=>[t("thead",null,[t("tr",null,[t("th",{class:"sortable",onClick:e[3]||(e[3]=u=>s.onSort("name"))},[t("div",pe,[e[14]||(e[14]=t("span",null,"Name",-1)),s.sortBy==="name"?(n(),f(k,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[m(c(s.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(n(),f(k,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>e[13]||(e[13]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[13]}))])]),t("th",{class:"sortable",onClick:e[4]||(e[4]=u=>s.onSort("slug"))},[t("div",fe,[e[16]||(e[16]=t("span",null,"Slug",-1)),s.sortBy==="slug"?(n(),f(k,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[m(c(s.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(n(),f(k,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>e[15]||(e[15]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[15]}))])]),e[19]||(e[19]=t("th",null,"Permissions",-1)),t("th",{class:"sortable",onClick:e[5]||(e[5]=u=>s.onSort("is_active"))},[t("div",he,[e[18]||(e[18]=t("span",null,"Status",-1)),s.sortBy==="is_active"?(n(),f(k,{key:0,size:"18",class:"sort-icon active"},{default:o(()=>[m(c(s.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(n(),f(k,{key:1,size:"18",class:"sort-icon inactive"},{default:o(()=>e[17]||(e[17]=[m(" mdi-unfold-more-horizontal ")])),_:1,__:[17]}))])]),e[20]||(e[20]=t("th",null,"Type",-1)),e[21]||(e[21]=t("th",null,"Actions",-1))])]),t("tbody",null,[s.loading?(n(),p(C,{key:0},z(5,u=>t("tr",{key:`skeleton-${u}`},[t("td",null,[i(_,{type:"text",width:"150"})]),t("td",null,[i(_,{type:"text",width:"120"})]),t("td",null,[i(_,{type:"chip",width:"80",height:"24"})]),t("td",null,[i(_,{type:"chip",width:"80",height:"24"})]),t("td",null,[i(_,{type:"chip",width:"70",height:"24"})]),t("td",null,[t("div",ge,[i(_,{type:"button",width:"32",height:"32",class:"mr-1"}),i(_,{type:"button",width:"32",height:"32",class:"mr-1"}),i(_,{type:"button",width:"32",height:"32"})])])])),64)):(n(),p(C,{key:1},[(n(!0),p(C,null,z(d.roles,u=>(n(),p("tr",{key:u.id},[t("td",null,[t("div",ve,c(u.name),1),t("div",_e,c(u.description||"No description"),1)]),t("td",null,[i(R,{size:"small",variant:"outlined"},{default:o(()=>[m(c(u.slug),1)]),_:2},1024)]),t("td",null,[i(R,{size:"small",color:"primary",variant:"text"},{default:o(()=>[m(c(u.permissions?u.permissions.length:0)+" permissions ",1)]),_:2},1024)]),t("td",null,[i(R,{color:u.is_active?"success":"error",size:"small"},{default:o(()=>[m(c(u.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),t("td",null,[u.is_system?(n(),f(R,{key:0,color:"warning",size:"small"},{default:o(()=>e[22]||(e[22]=[m(" System ")])),_:1,__:[22]})):(n(),p("span",ye,"Custom"))]),t("td",null,[i(b,{size:"small",icon:"mdi-pencil",onClick:N=>l.openDialog(u),variant:"text",disabled:u.is_system},null,8,["onClick","disabled"]),i(b,{size:"small",icon:"mdi-shield-key",onClick:N=>l.openPermissionDialog(u),variant:"text"},null,8,["onClick"]),i(b,{size:"small",icon:"mdi-delete",onClick:N=>l.deleteRole(u),variant:"text",color:"error",disabled:u.is_system},null,8,["onClick","disabled"])])]))),128)),d.roles.length===0?(n(),p("tr",be,e[23]||(e[23]=[t("td",{colspan:"6",class:"text-center py-4"},"No roles found",-1)]))):j("",!0)],64))])]),_:1}),t("div",Pe,[t("div",ke,[d.roles.length>0&&s.pagination.total>0?(n(),p("span",we,[s.perPage==="all"?(n(),p("span",Se,[e[24]||(e[24]=m(" Showing ")),t("strong",null,"all "+c(s.pagination.total.toLocaleString()),1),e[25]||(e[25]=m(" records "))])):(n(),p("span",Ve,[e[26]||(e[26]=m(" Showing ")),t("strong",null,c((s.currentPage-1)*s.perPage+1),1),e[27]||(e[27]=m(" to ")),t("strong",null,c(Math.min(s.currentPage*s.perPage,s.pagination.total).toLocaleString()),1),e[28]||(e[28]=m(" of ")),t("strong",null,c(s.pagination.total.toLocaleString()),1),e[29]||(e[29]=m(" records "))]))])):(n(),p("span",Ae,"No records found"))]),i(y,{modelValue:s.currentPage,"onUpdate:modelValue":e[6]||(e[6]=u=>s.currentPage=u),pagination:s.pagination,"per-page-value":s.perPage,"per-page-options":s.perPageOptions,"onUpdate:perPage":s.onPerPageUpdate,onPageChange:s.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1}),i(w,{modelValue:d.dialog,"onUpdate:modelValue":e[7]||(e[7]=u=>d.dialog=u),role:d.editingRole,"grouped-permissions":d.groupedPermissions,onSave:l.onRoleSaved},null,8,["modelValue","role","grouped-permissions","onSave"]),i(V,{modelValue:d.permissionDialog,"onUpdate:modelValue":e[8]||(e[8]=u=>d.permissionDialog=u),role:d.selectedRole,"grouped-permissions":d.groupedPermissions,onSave:l.onPermissionsSaved},null,8,["modelValue","role","grouped-permissions","onSave"])])}const ze=I(me,[["render",Re]]);export{ze as default};
