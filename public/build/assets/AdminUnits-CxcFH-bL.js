import{_ as q,c,b as o,a as n,w as i,f as l,r as d,t as u,d as f,F as k,y as V,e as M,g as I,A as T,o as r}from"./app-CYStQJ0f.js";import{c as j}from"./commonMixin-LD1l2-5e.js";import{p as x,P as K}from"./PaginationControls-CGFLaHsK.js";const O={name:"AdminUnits",components:{PaginationControls:K},mixins:[j,x],data(){return{units:[],dialog:!1,editingUnit:null,saving:!1,form:this.getEmptyForm(),rules:{required:t=>!!t||"This field is required"}}},mounted(){this.loadUnits()},methods:{getEmptyForm(){return{id:null,name:"",code:"",description:"",is_active:!0}},async loadUnits(){try{this.loading=!0;const t=this.buildPaginationParams();this.perPage==="all"&&(t.per_page=999999),this.search&&(t.search=this.search);const e=await this.$axios.get("/api/v1/units",{params:t,headers:this.getAuthHeaders()});this.units=e.data.data||e.data.units||[],e.data.total!==void 0||e.data.last_page!==void 0?this.updatePagination(e.data):this.pagination={current_page:1,last_page:1,per_page:this.units.length,total:this.units.length}}catch(t){console.error("Failed to fetch units",t),this.handleApiError(t,"Failed to load units")}finally{this.loading=!1}},openDialog(t){t?(this.editingUnit=t,this.form={id:t.id,name:t.name||"",code:t.code||"",description:t.description||"",is_active:t.is_active!==void 0?t.is_active:!0}):(this.editingUnit=null,this.form=this.getEmptyForm()),this.dialog=!0},closeDialog(){this.dialog=!1,this.editingUnit=null,this.form=this.getEmptyForm(),this.$refs.formRef&&this.$refs.formRef.resetValidation()},async saveUnit(){var t,e,y,_;if(this.$refs.formRef.validate()){this.saving=!0;try{const a=localStorage.getItem("admin_token"),m=this.editingUnit?`/api/v1/units/${this.editingUnit.id}`:"/api/v1/units",g=this.editingUnit?"put":"post",v={...this.form};await T[g](m,v,{headers:{Authorization:`Bearer ${a}`}}),this.showSuccess(this.editingUnit?"Unit updated successfully":"Unit created successfully"),this.closeDialog(),await this.loadUnits()}catch(a){console.error("Error saving unit:",a);let m="Error saving unit";if((e=(t=a.response)==null?void 0:t.data)!=null&&e.errors){const g=a.response.data.errors,v=[];Object.keys(g).forEach(w=>{v.push(g[w][0])}),m=v.join(", ")}else(_=(y=a.response)==null?void 0:y.data)!=null&&_.message&&(m=a.response.data.message);this.showError(m)}finally{this.saving=!1}}},async deleteUnit(t){if(confirm(`Are you sure you want to delete ${t.name}?`))try{await this.$axios.delete(`/api/v1/units/${t.id}`,{headers:this.getAuthHeaders()}),this.showSuccess("Unit deleted successfully"),await this.loadUnits()}catch(e){this.handleApiError(e,"Error deleting unit")}}}},G={class:"page-header"},H={class:"text-caption text-grey"},J={class:"sortable-header"},Q={class:"sortable-header"},W={class:"sortable-header"},X={class:"sortable-header"},Y={class:"sortable-header"},Z={class:"d-flex"},$={class:"d-flex align-center"},ee={key:0},te={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},oe={class:"text-caption text-grey"},ne={key:0},ie={key:0},se={key:1},le={key:1},ae={class:"pa-6"};function re(t,e,y,_,a,m){const g=d("v-btn"),v=d("v-text-field"),w=d("v-col"),z=d("v-row"),b=d("v-card-text"),U=d("v-card"),C=d("v-card-title"),p=d("v-icon"),h=d("v-skeleton-loader"),P=d("v-chip"),S=d("v-table"),E=d("PaginationControls"),D=d("v-textarea"),A=d("v-switch"),B=d("v-form"),N=d("v-spacer"),F=d("v-card-actions"),L=d("v-dialog");return r(),c("div",null,[o("div",G,[e[14]||(e[14]=o("h1",{class:"text-h4 page-title"},"Unit Management",-1)),n(g,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=s=>m.openDialog(null)),class:"add-button"},{default:i(()=>e[13]||(e[13]=[l(" Add New Unit ")])),_:1,__:[13]})]),n(U,{class:"mb-4"},{default:i(()=>[n(b,null,{default:i(()=>[n(z,null,{default:i(()=>[n(w,{cols:"12",md:"8"},{default:i(()=>[n(v,{modelValue:t.search,"onUpdate:modelValue":e[1]||(e[1]=s=>t.search=s),label:"Search by name, code","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:m.loadUnits},null,8,["modelValue","onInput"])]),_:1})]),_:1})]),_:1})]),_:1}),n(U,null,{default:i(()=>[n(C,{class:"d-flex justify-space-between align-center"},{default:i(()=>[e[16]||(e[16]=o("span",null,"Units",-1)),o("span",H,[e[15]||(e[15]=l(" Total Records: ")),o("strong",null,u((t.pagination.total||0).toLocaleString()),1)])]),_:1,__:[16]}),n(b,null,{default:i(()=>[n(S,null,{default:i(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:e[2]||(e[2]=s=>t.onSort("name"))},[o("div",J,[e[18]||(e[18]=o("span",null,"Name",-1)),t.sortBy==="name"?(r(),f(p,{key:0,size:"18",class:"sort-icon active"},{default:i(()=>[l(u(t.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(r(),f(p,{key:1,size:"18",class:"sort-icon inactive"},{default:i(()=>e[17]||(e[17]=[l(" mdi-unfold-more-horizontal ")])),_:1,__:[17]}))])]),o("th",{class:"sortable",onClick:e[3]||(e[3]=s=>t.onSort("code"))},[o("div",Q,[e[20]||(e[20]=o("span",null,"Code",-1)),t.sortBy==="code"?(r(),f(p,{key:0,size:"18",class:"sort-icon active"},{default:i(()=>[l(u(t.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(r(),f(p,{key:1,size:"18",class:"sort-icon inactive"},{default:i(()=>e[19]||(e[19]=[l(" mdi-unfold-more-horizontal ")])),_:1,__:[19]}))])]),o("th",{class:"sortable",onClick:e[4]||(e[4]=s=>t.onSort("description"))},[o("div",W,[e[22]||(e[22]=o("span",null,"Description",-1)),t.sortBy==="description"?(r(),f(p,{key:0,size:"18",class:"sort-icon active"},{default:i(()=>[l(u(t.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(r(),f(p,{key:1,size:"18",class:"sort-icon inactive"},{default:i(()=>e[21]||(e[21]=[l(" mdi-unfold-more-horizontal ")])),_:1,__:[21]}))])]),o("th",{class:"sortable",onClick:e[5]||(e[5]=s=>t.onSort("is_active"))},[o("div",X,[e[24]||(e[24]=o("span",null,"Status",-1)),t.sortBy==="is_active"?(r(),f(p,{key:0,size:"18",class:"sort-icon active"},{default:i(()=>[l(u(t.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(r(),f(p,{key:1,size:"18",class:"sort-icon inactive"},{default:i(()=>e[23]||(e[23]=[l(" mdi-unfold-more-horizontal ")])),_:1,__:[23]}))])]),o("th",{class:"sortable",onClick:e[6]||(e[6]=s=>t.onSort("created_at"))},[o("div",Y,[e[26]||(e[26]=o("span",null,"Created",-1)),t.sortBy==="created_at"?(r(),f(p,{key:0,size:"18",class:"sort-icon active"},{default:i(()=>[l(u(t.sortDirection==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):(r(),f(p,{key:1,size:"18",class:"sort-icon inactive"},{default:i(()=>e[25]||(e[25]=[l(" mdi-unfold-more-horizontal ")])),_:1,__:[25]}))])]),e[27]||(e[27]=o("th",null,"Actions",-1))])]),o("tbody",null,[t.loading?(r(),c(k,{key:0},V(5,s=>o("tr",{key:`skeleton-${s}`},[o("td",null,[n(h,{type:"text",width:"150"})]),o("td",null,[n(h,{type:"text",width:"80"})]),o("td",null,[n(h,{type:"text",width:"200"})]),o("td",null,[n(h,{type:"chip",width:"80",height:"24"})]),o("td",null,[n(h,{type:"text",width:"100"})]),o("td",null,[o("div",Z,[n(h,{type:"button",width:"32",height:"32",class:"mr-1"}),n(h,{type:"button",width:"32",height:"32"})])])])),64)):(r(),c(k,{key:1},[(r(!0),c(k,null,V(a.units,s=>(r(),c("tr",{key:s.id},[o("td",null,[o("div",$,[n(p,{size:"small",color:"primary",class:"mr-2"},{default:i(()=>e[28]||(e[28]=[l(" mdi-weight-kilogram ")])),_:1,__:[28]}),l(" "+u(s.name),1)])]),o("td",null,[n(P,{size:"small",variant:"outlined"},{default:i(()=>[l(u(s.code),1)]),_:2},1024)]),o("td",null,u(s.description||"-"),1),o("td",null,[n(P,{color:s.is_active?"success":"error",size:"small"},{default:i(()=>[l(u(s.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),o("td",null,u(t.formatDate(s.created_at)),1),o("td",null,[n(g,{size:"small",icon:"mdi-pencil",onClick:R=>m.openDialog(s),variant:"text",title:"Edit Unit"},null,8,["onClick"]),n(g,{size:"small",icon:"mdi-delete",onClick:R=>m.deleteUnit(s),variant:"text",color:"error",title:"Delete Unit"},null,8,["onClick"])])]))),128)),a.units.length===0?(r(),c("tr",ee,e[29]||(e[29]=[o("td",{colspan:"6",class:"text-center py-4"},"No units found",-1)]))):M("",!0)],64))])]),_:1}),o("div",te,[o("div",oe,[a.units.length>0&&t.pagination.total>0?(r(),c("span",ne,[t.perPage==="all"?(r(),c("span",ie,[e[30]||(e[30]=l(" Showing ")),o("strong",null,"all "+u(t.pagination.total.toLocaleString()),1),e[31]||(e[31]=l(" records "))])):(r(),c("span",se,[e[32]||(e[32]=l(" Showing ")),o("strong",null,u((t.currentPage-1)*t.perPage+1),1),e[33]||(e[33]=l(" to ")),o("strong",null,u(Math.min(t.currentPage*t.perPage,t.pagination.total).toLocaleString()),1),e[34]||(e[34]=l(" of ")),o("strong",null,u(t.pagination.total.toLocaleString()),1),e[35]||(e[35]=l(" records "))]))])):(r(),c("span",le,"No records found"))]),n(E,{modelValue:t.currentPage,"onUpdate:modelValue":e[7]||(e[7]=s=>t.currentPage=s),pagination:t.pagination,"per-page-value":t.perPage,"per-page-options":t.perPageOptions,"onUpdate:perPage":t.onPerPageUpdate,onPageChange:t.onPageChange},null,8,["modelValue","pagination","per-page-value","per-page-options","onUpdate:perPage","onPageChange"])])]),_:1})]),_:1}),n(L,{modelValue:a.dialog,"onUpdate:modelValue":e[12]||(e[12]=s=>a.dialog=s),"max-width":"700",scrollable:"",persistent:""},{default:i(()=>[n(U,null,{default:i(()=>[n(C,null,{default:i(()=>[l(u(a.editingUnit?"Edit Unit":"Add New Unit"),1)]),_:1}),n(b,{class:"pa-0"},{default:i(()=>[n(B,{ref:"formRef",onSubmit:I(m.saveUnit,["prevent"])},{default:i(()=>[o("div",ae,[n(v,{modelValue:a.form.name,"onUpdate:modelValue":e[8]||(e[8]=s=>a.form.name=s),placeholder:"Enter unit name (e.g., Kilogram, Piece, Liter)",rules:[a.rules.required],required:"",variant:"outlined",density:"comfortable","hide-details":"auto",hint:"Enter the full name of the measurement unit","persistent-hint":"",class:"mb-4"},{label:i(()=>e[36]||(e[36]=[l(" Unit Name "),o("span",{class:"text-error",style:{"font-size":"1.2em","font-weight":"bold"}},"*",-1)])),_:1},8,["modelValue","rules"]),n(v,{modelValue:a.form.code,"onUpdate:modelValue":e[9]||(e[9]=s=>a.form.code=s),placeholder:"Enter unit code (e.g., KG, PCS, LTR)",hint:"Short code or abbreviation for the unit (e.g., KG, PCS, LTR)","persistent-hint":"",rules:[a.rules.required],required:"",variant:"outlined",density:"comfortable","hide-details":"auto",class:"mb-4"},{label:i(()=>e[37]||(e[37]=[l(" Code "),o("span",{class:"text-error",style:{"font-size":"1.2em","font-weight":"bold"}},"*",-1)])),_:1},8,["modelValue","rules"]),n(D,{modelValue:a.form.description,"onUpdate:modelValue":e[10]||(e[10]=s=>a.form.description=s),label:"Description",placeholder:"Enter a brief description about the unit (optional)",variant:"outlined",density:"comfortable",rows:"3",hint:"Optional: Brief description about the unit","persistent-hint":"","hide-details":"auto",class:"mb-4"},null,8,["modelValue"]),n(A,{modelValue:a.form.is_active,"onUpdate:modelValue":e[11]||(e[11]=s=>a.form.is_active=s),label:"Active Unit",color:"success",class:"mb-4"},null,8,["modelValue"])])]),_:1},8,["onSubmit"])]),_:1}),n(F,null,{default:i(()=>[n(N),n(g,{onClick:m.closeDialog,variant:"text"},{default:i(()=>e[38]||(e[38]=[l("Cancel")])),_:1,__:[38]},8,["onClick"]),n(g,{onClick:m.saveUnit,color:"primary",loading:a.saving},{default:i(()=>[l(u(a.editingUnit?"Update":"Create"),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const pe=q(O,[["render",re],["__scopeId","data-v-1795c8c9"]]);export{pe as default};
